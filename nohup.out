/data1/huangsuyuan/anaconda3/envs/ver39/lib/python3.9/site-packages/torch_geometric/data/in_memory_dataset.py:300: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
[I 2025-09-14 21:38:40,480] A new study created in memory with name: no-name-a28e6f44-f6a2-4099-85b9-bd5d5dc649bd
[I 2025-09-14 21:40:32,495] Trial 0 finished with value: 64.53634643554688 and parameters: {'num_recon_nodes': 3, 'beta': 0.02, 'decay': 1.0, 'num_epoch_g': 10}. Best is trial 0 with value: 64.53634643554688.
loading Cora dataset...
client 0 has 3 tasks.
client 1 has 3 tasks.
client 2 has 3 tasks.
ATTENTION!!! FCGL DROPS 1 CLASS(ES).
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788291835226119
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.730053653785205e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.152248710478148e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.219068510697866e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.0389150650880197e-09
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.810842528321871e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.17
tensor([[93.1677,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.17	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.786270682710096e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.8879373892287674e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.6167256422505716e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.693036125327012e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:6.564213061999169e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.3914402669820163e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.54
[Task 1 Finish] Global Accuracy on Task 1: 75.73
tensor([[93.1677,  0.0000,  0.0000],
        [83.5404, 75.7333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.64	Global AF: 9.63
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.162912402629672e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.0082451540327497e-09
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.351392662333865e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.856608059102598e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.188248412643873e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.039929750263241e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 78.88
[Task 2 Finish] Global Accuracy on Task 1: 75.73
[Task 2 Finish] Global Accuracy on Task 2: 38.99
tensor([[93.1677,  0.0000,  0.0000],
        [83.5404, 75.7333,  0.0000],
        [78.8820, 75.7333, 38.9937]], device='cuda:0')
[Task 2 Finish] Global AA: 64.54	Global AF: 7.14
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788217620458454
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:0.0011765260715037584
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.12331010948941e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.018637810356608e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.879264882071908e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.925878287018406e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.0289432633990856e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.7287128940022285e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.008351204402686e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:0.06120007857680321
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:6.814558917156432e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.1968736819164576e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.30
[Task 1 Finish] Global Accuracy on Task 1: 80.27
tensor([[95.3416,  0.0000,  0.0000],
        [82.2981, 80.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.28	Global AF: 13.04
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.3655757635788746e-09
[I 2025-09-14 21:42:23,361] Trial 1 finished with value: 66.66304016113281 and parameters: {'num_recon_nodes': 3, 'beta': 0.02, 'decay': 1.0, 'num_epoch_g': 5}. Best is trial 1 with value: 66.66304016113281.
[I 2025-09-14 21:44:00,908] Trial 2 finished with value: 65.53401184082031 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 5}. Best is trial 1 with value: 66.66304016113281.
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.610892778700304e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.190908258789761e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.454599549814532e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.465718628221538e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.793959366786396e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 75.47
[Task 2 Finish] Global Accuracy on Task 1: 75.47
[Task 2 Finish] Global Accuracy on Task 2: 49.06
tensor([[95.3416,  0.0000,  0.0000],
        [82.2981, 80.2667,  0.0000],
        [75.4658, 75.4667, 49.0566]], device='cuda:0')
[Task 2 Finish] Global AA: 66.66	Global AF: 12.34
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.17362380027771
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.711948774551502e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.316426826025179e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.3968947927019997e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:8.195014666867451e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.380679625131222e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:3.113716784408638e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.495186693518008e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.973707639661541e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:0.06120007857680321
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:6.404609620425106e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.4815572647062254e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 88.82
[Task 1 Finish] Global Accuracy on Task 1: 78.93
tensor([[95.6522,  0.0000,  0.0000],
        [88.8199, 78.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.88	Global AF: 6.83
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.643230717109702e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.620407945132854e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.883976556513403e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.212743404645835e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.011405262462688e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.695338645139714e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 71.74
[Task 2 Finish] Global Accuracy on Task 1: 64.80
[Task 2 Finish] Global Accuracy on Task 2: 60.06
tensor([[95.6522,  0.0000,  0.0000],
        [88.8199, 78.9333,  0.0000],
        [71.7391, 64.8000, 60.0629]], device='cuda:0')
[Task 2 Finish] Global AA: 65.53	Global AF: 19.02
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378825691062957
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.220539558310918e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.306697638980836e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:8.31956892266561e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:8.692035979862567e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.325259679774149e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.358753606467872e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.248411344942582e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.3342655869053033e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.783094558786672e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
[I 2025-09-14 21:45:50,902] Trial 3 finished with value: 66.14297485351562 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.4, 'num_epoch_g': 3}. Best is trial 1 with value: 66.66304016113281.
[I 2025-09-14 21:47:48,638] Trial 4 finished with value: 62.752532958984375 and parameters: {'num_recon_nodes': 1, 'beta': 0.09999999999999999, 'decay': 0.1, 'num_epoch_g': 10}. Best is trial 1 with value: 66.66304016113281.
current_loss:0.00037966438685543835
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.9527478512546566e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.68
[Task 1 Finish] Global Accuracy on Task 1: 78.13
tensor([[95.3416,  0.0000,  0.0000],
        [81.6770, 78.1333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.91	Global AF: 13.66
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.379034522829841e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.757825882746204e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.0159201258019834e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.9994673972068e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.289210901539889e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.0566632013819799e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 67.70
[Task 2 Finish] Global Accuracy on Task 1: 58.40
[Task 2 Finish] Global Accuracy on Task 2: 72.33
tensor([[95.3416,  0.0000,  0.0000],
        [81.6770, 78.1333,  0.0000],
        [67.7019, 58.4000, 72.3270]], device='cuda:0')
[Task 2 Finish] Global AA: 66.14	Global AF: 23.69
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788310752715915
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:8.912909299496619e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.4415796041086253e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.4935541398949397e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.079673100396917e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.905255091003369e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 92.55
tensor([[92.5466,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 92.55	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.827667710038952e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.6309126271707441e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.9436554588025956e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.022504162039866e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966438685543835
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.354746646091257e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 73.91
[Task 1 Finish] Global Accuracy on Task 1: 87.20
tensor([[92.5466,  0.0000,  0.0000],
        [73.9130, 87.2000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.56	Global AF: 18.63
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.429058426096532e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.115172287846633e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.807635011263358e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.616298147716805e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.4699483003896034e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:9.333582795534312e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 44.72
[Task 2 Finish] Global Accuracy on Task 1: 53.60
[Task 2 Finish] Global Accuracy on Task 2: 89.94
tensor([[92.5466,  0.0000,  0.0000],
        [73.9130, 87.2000,  0.0000],
        [44.7205, 53.6000, 89.9371]], device='cuda:0')
[Task 2 Finish] Global AA: 62.75	Global AF: 40.71
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788300566375256
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.668067988764733e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.2813041173085367e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.0672515355666405e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:8.102123416620088e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.3350830441183348e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
[I 2025-09-14 21:49:25,906] Trial 5 finished with value: 56.99148178100586 and parameters: {'num_recon_nodes': 1, 'beta': 0.09, 'decay': 0.1, 'num_epoch_g': 5}. Best is trial 1 with value: 66.66304016113281.
[I 2025-09-14 21:51:12,281] Trial 6 finished with value: 70.1480484008789 and parameters: {'num_recon_nodes': 3, 'beta': 0.04, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 6 with value: 70.1480484008789.
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.2075158650759477e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.3727563237005995e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:9.212910989653267e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:8.209675717019138e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.045525110932033e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.429774880243542e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.50
[Task 1 Finish] Global Accuracy on Task 1: 88.80
tensor([[94.4099,  0.0000,  0.0000],
        [79.5031, 88.8000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.15	Global AF: 14.91
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.526039625891599e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.4261616594098996e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.4260569381494577e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.160412097637845e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.668857133185213e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:0.033466536551713943
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 50.93
[Task 2 Finish] Global Accuracy on Task 1: 28.53
[Task 2 Finish] Global Accuracy on Task 2: 91.51
tensor([[94.4099,  0.0000,  0.0000],
        [79.5031, 88.8000,  0.0000],
        [50.9317, 28.5333, 91.5094]], device='cuda:0')
[Task 2 Finish] Global AA: 56.99	Global AF: 51.87
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378840097459033
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.513339731307184e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.281363596980725e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.718236357170724e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792017196305096
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.4734428394346253e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.7502997939899956e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.58579693715555e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.8679899849161075e-09
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:8.356829672706567e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796648234128952
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.278263464665201e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.30
[Task 1 Finish] Global Accuracy on Task 1: 86.67
tensor([[94.4099,  0.0000,  0.0000],
        [82.2981, 86.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.48	Global AF: 12.11
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.1540685074251655e-09
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:0.02285819873213768
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.607490276091312e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.504212280931341e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.011524221807065e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.472741787000302e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 61.49
[Task 2 Finish] Global Accuracy on Task 1: 63.73
[Task 2 Finish] Global Accuracy on Task 2: 85.22
tensor([[94.4099,  0.0000,  0.0000],
        [82.2981, 86.6667,  0.0000],
        [61.4907, 63.7333, 85.2201]], device='cuda:0')
[Task 2 Finish] Global AA: 70.15	Global AF: 27.93
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[I 2025-09-14 21:53:04,868] Trial 7 finished with value: 65.47029876708984 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.8, 'num_epoch_g': 10}. Best is trial 6 with value: 70.1480484008789.
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.17362380027771
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.132665486546784e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.172670873385357e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.246160893537024e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:9.252932309244954e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.709435701994892e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.17
tensor([[93.1677,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.17	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.06162944891031e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:9.666394351626195e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.6091599981146203e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.1317504711172433e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.002666699467226863
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.48254411156546e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.95
[Task 1 Finish] Global Accuracy on Task 1: 82.40
tensor([[93.1677,  0.0000,  0.0000],
        [77.9503, 82.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.18	Global AF: 15.22
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:0.028870712965726852
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.248065398395397e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.305292316570842e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.973925326114738e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:0.018517551943659782
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.074192401695484e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 74.53
[Task 2 Finish] Global Accuracy on Task 1: 70.93
[Task 2 Finish] Global Accuracy on Task 2: 50.94
tensor([[93.1677,  0.0000,  0.0000],
        [77.9503, 82.4000,  0.0000],
        [74.5342, 70.9333, 50.9434]], device='cuda:0')
[Task 2 Finish] Global AA: 65.47	Global AF: 15.05
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788265641778708
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.5583195551479605e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:0.041812438517808914
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.429464183277389e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.437757466530968e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.753601318656763e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.822870046718776e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.793150403832215e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:9.50467593519022e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.3209537907954427e-09
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796649689320475
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.088338084213717e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 86.65
[Task 1 Finish] Global Accuracy on Task 1: 72.53
tensor([[93.7888,  0.0000,  0.0000],
        [86.6460, 72.5333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.59	Global AF: 7.14
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.791403385162596e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.5065680925019365e-09
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.9837769194583927e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.9117239735688685e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:0.018517551943659782
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.707486622734791e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[I 2025-09-14 21:54:50,252] Trial 8 finished with value: 56.38405990600586 and parameters: {'num_recon_nodes': 3, 'beta': 0.02, 'decay': 0.9, 'num_epoch_g': 10}. Best is trial 6 with value: 70.1480484008789.
[I 2025-09-14 21:56:38,796] Trial 9 finished with value: 70.84659576416016 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.5, 'num_epoch_g': 5}. Best is trial 9 with value: 70.84659576416016.
[Task 2 Finish] Global Accuracy on Task 0: 73.60
[Task 2 Finish] Global Accuracy on Task 1: 66.93
[Task 2 Finish] Global Accuracy on Task 2: 28.62
tensor([[93.7888,  0.0000,  0.0000],
        [86.6460, 72.5333,  0.0000],
        [73.6025, 66.9333, 28.6164]], device='cuda:0')
[Task 2 Finish] Global AA: 56.38	Global AF: 12.89
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378826127620414
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.7980618650124143e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.0432464881435806e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.0024109027037014e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.235539224379693e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.870395363733905e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 92.55
tensor([[92.5466,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 92.55	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.1897206553257433e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:0.06739170849323273
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:2.9775448773250446e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.26800880695788e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.002666698768734932
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.1383573517729246e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 76.71
[Task 1 Finish] Global Accuracy on Task 1: 82.40
tensor([[92.5466,  0.0000,  0.0000],
        [76.7081, 82.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.55	Global AF: 15.84
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.68092050968039e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.025605487318785e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.344776370958982e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.816671506091552e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.0308440767659022e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.1343803405761719
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 76.09
[Task 2 Finish] Global Accuracy on Task 1: 77.33
[Task 2 Finish] Global Accuracy on Task 2: 59.12
tensor([[92.5466,  0.0000,  0.0000],
        [76.7081, 82.4000,  0.0000],
        [76.0870, 77.3333, 59.1195]], device='cuda:0')
[Task 2 Finish] Global AA: 70.85	Global AF: 10.76
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.01740207150578499
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.920811536024416e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.123573397826988e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.550119559963093e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:9.358638308754053e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.701267401571954e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.152973296482457e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.4311556384427604e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.1897252072401443e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.3937966336641239e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:9.776319753740381e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.093948844489773e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.37
[Task 1 Finish] Global Accuracy on Task 1: 85.60
tensor([[93.7888,  0.0000,  0.0000],
        [81.3665, 85.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.48	Global AF: 12.42
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[I 2025-09-14 21:58:29,783] Trial 10 finished with value: 63.175010681152344 and parameters: {'num_recon_nodes': 1, 'beta': 0.06999999999999999, 'decay': 0.4, 'num_epoch_g': 5}. Best is trial 9 with value: 70.84659576416016.
[I 2025-09-14 22:00:06,010] Trial 11 finished with value: 71.0164794921875 and parameters: {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 11 with value: 71.0164794921875.
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.638044723952021e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.432259169741883e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.8043208593887528e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.1682005363056192e-09
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.290418575969568e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.392071316696502e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 60.56
[Task 2 Finish] Global Accuracy on Task 1: 38.40
[Task 2 Finish] Global Accuracy on Task 2: 90.57
tensor([[93.7888,  0.0000,  0.0000],
        [81.3665, 85.6000,  0.0000],
        [60.5590, 38.4000, 90.5660]], device='cuda:0')
[Task 2 Finish] Global AA: 63.18	Global AF: 40.21
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:5.161899241379331e-10
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:0.028364455327391624
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.734385271656151e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.652807500920119e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792037568986416
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.061576270280142e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.193800058807426e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.180995077402883e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.062820498276551e-09
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.003967961161095e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:5.307458916803398e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.164864340187705e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.75
[Task 1 Finish] Global Accuracy on Task 1: 85.07
tensor([[94.4099,  0.0000,  0.0000],
        [80.7453, 85.0667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.91	Global AF: 13.66
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.294989695123434e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.396748296668477e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.0189695753837213e-09
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:2.377420482702064e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:2.1067515787454028e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.838593745785772e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 66.77
[Task 2 Finish] Global Accuracy on Task 1: 57.60
[Task 2 Finish] Global Accuracy on Task 2: 88.68
tensor([[94.4099,  0.0000,  0.0000],
        [80.7453, 85.0667,  0.0000],
        [66.7702, 57.6000, 88.6792]], device='cuda:0')
[Task 2 Finish] Global AA: 71.02	Global AF: 27.55
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788332580588758
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.0233527620614495e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.3782437958151945e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.1299715607648864e-09
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.969455013106085e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.5239341732975475e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.2203954220276785e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.849845082142366e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
[I 2025-09-14 22:02:03,115] Trial 12 finished with value: 65.66792297363281 and parameters: {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.5, 'num_epoch_g': 3}. Best is trial 11 with value: 71.0164794921875.
[I 2025-09-14 22:03:49,441] Trial 13 finished with value: 63.37042236328125 and parameters: {'num_recon_nodes': 3, 'beta': 0.06999999999999999, 'decay': 0.30000000000000004, 'num_epoch_g': 3}. Best is trial 11 with value: 71.0164794921875.
current_loss:1.107768987651525e-09
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.733619690140301e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796652308665216
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.477179377764372e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.57
[Task 1 Finish] Global Accuracy on Task 1: 88.00
tensor([[93.7888,  0.0000,  0.0000],
        [78.5714, 88.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.29	Global AF: 15.22
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.745053711590174e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.658196854443133e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.613993324717683e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.665927171882856e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.3278594596962705e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.396924822129392e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 50.00
[Task 2 Finish] Global Accuracy on Task 1: 57.07
[Task 2 Finish] Global Accuracy on Task 2: 89.94
tensor([[93.7888,  0.0000,  0.0000],
        [78.5714, 88.0000,  0.0000],
        [50.0000, 57.0667, 89.9371]], device='cuda:0')
[Task 2 Finish] Global AA: 65.67	Global AF: 37.36
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788290380034596
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.0102083614071944e-09
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.94573956841171e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.732496534070151e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979202301707119
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.974342132120114e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.098639371288073e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.089392489196712e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.3268314225101108e-09
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.683312071485091e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:2.09001052575708e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.774588502343136e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.95
[Task 1 Finish] Global Accuracy on Task 1: 89.60
tensor([[94.4099,  0.0000,  0.0000],
        [77.9503, 89.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.78	Global AF: 16.46
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.546139741381296e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:0.02285819873213768
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.689779203343903e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.00044972740579396486
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.205922471938294e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.0668056982818825e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 63.35
[Task 2 Finish] Global Accuracy on Task 1: 34.93
[Task 2 Finish] Global Accuracy on Task 2: 91.82
tensor([[94.4099,  0.0000,  0.0000],
        [77.9503, 89.6000,  0.0000],
        [63.3540, 34.9333, 91.8239]], device='cuda:0')
[Task 2 Finish] Global AA: 63.37	Global AF: 42.86
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:3.8915271005635077e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.2031734497597313e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.654634703868624e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:9.202772988103902e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.449352163429012e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.575229249961012e-10
[I 2025-09-14 22:05:28,869] Trial 14 finished with value: 75.11549377441406 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 14 with value: 75.11549377441406.
[I 2025-09-14 22:07:22,187] Trial 15 finished with value: 77.06944274902344 and parameters: {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:0.029233457520604134
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.476964520274464e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.292069087976415e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.062989247965447e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.002666698768734932
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.810628338018489e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.06
[Task 1 Finish] Global Accuracy on Task 1: 86.67
tensor([[94.7205,  0.0000,  0.0000],
        [81.0559, 86.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.86	Global AF: 13.66
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.489073250432909e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.851508970231237e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.188957845156608e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497279296629131
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.0682030815445387e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.632664417693945e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 63.35
[Task 2 Finish] Global Accuracy on Task 1: 75.20
[Task 2 Finish] Global Accuracy on Task 2: 86.79
tensor([[94.7205,  0.0000,  0.0000],
        [81.0559, 86.6667,  0.0000],
        [63.3540, 75.2000, 86.7924]], device='cuda:0')
[Task 2 Finish] Global AA: 75.12	Global AF: 21.42
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788237993139774
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.059328511691774e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.581972106760702e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:0.03505839407444
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.84568410239217e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.1751135614866968e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.333001817930949e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:9.114763388495817e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.6321566320698366e-09
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:2.6278393350231966e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966520176269114
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.061495915256955e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 72.98
[Task 1 Finish] Global Accuracy on Task 1: 90.67
tensor([[95.0311,  0.0000,  0.0000],
        [72.9814, 90.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.82	Global AF: 22.05
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.128363844697503e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.494339038238707e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.384008906426317e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.461752716762192e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.819624309706285e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.055221879464057e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 71.74
[Task 2 Finish] Global Accuracy on Task 1: 71.73
[Task 2 Finish] Global Accuracy on Task 2: 87.74
tensor([[95.0311,  0.0000,  0.0000],
        [72.9814, 90.6667,  0.0000],
        [71.7391, 71.7333, 87.7358]], device='cuda:0')
[Task 2 Finish] Global AA: 77.07	Global AF: 21.11
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[I 2025-09-14 22:09:12,917] Trial 16 finished with value: 60.23699188232422 and parameters: {'num_recon_nodes': 3, 'beta': 0.08, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:3.744737853139668e-10
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.114950212854353e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.332008723435422e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.071394055227273e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:4.657956687026399e-09
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.132010454962256e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.6966118510097772e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.379753474978656e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.6255731750145515e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.015632689060908e-09
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796645614784211
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.452675533312856e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 76.40
[Task 1 Finish] Global Accuracy on Task 1: 89.33
tensor([[94.4099,  0.0000,  0.0000],
        [76.3975, 89.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.87	Global AF: 18.01
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.401780772158361e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.3033070178636308e-09
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.5507368722467163e-09
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:9.478579032773382e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.174897815292013e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.876985813088822e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 43.48
[Task 2 Finish] Global Accuracy on Task 1: 46.67
[Task 2 Finish] Global Accuracy on Task 2: 90.57
tensor([[94.4099,  0.0000,  0.0000],
        [76.3975, 89.3333,  0.0000],
        [43.4783, 46.6667, 90.5660]], device='cuda:0')
[Task 2 Finish] Global AA: 60.24	Global AF: 46.80
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788283104076982
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.224301381443695e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.386004030607296e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.1281213740943485e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.793768854620794e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.866691494243014e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.853454942972292e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.14434947365794e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:0.00020711957768071443
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.654035100694955e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666997000575066
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.195067874832262e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.68
[Task 1 Finish] Global Accuracy on Task 1: 86.93
tensor([[95.0311,  0.0000,  0.0000],
        [81.6770, 86.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.31	Global AF: 13.35
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.555750386993964e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.960278630176788e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.025707395747303963
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.387633755267075e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.815819020289382e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
[I 2025-09-14 22:10:52,352] Trial 17 finished with value: 63.322654724121094 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 22:12:44,566] Trial 18 finished with value: 63.627803802490234 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.30000000000000004, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
current_loss:4.669166164816829e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 54.35
[Task 2 Finish] Global Accuracy on Task 1: 50.40
[Task 2 Finish] Global Accuracy on Task 2: 85.22
tensor([[95.0311,  0.0000,  0.0000],
        [81.6770, 86.9333,  0.0000],
        [54.3478, 50.4000, 85.2201]], device='cuda:0')
[Task 2 Finish] Global AA: 63.32	Global AF: 38.61
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:2.7672102387299446e-09
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:9.94431870182666e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.647785738029711e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.763610617075642e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.00937513692179e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.3589888103737735e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.17
tensor([[93.1677,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.17	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.47670417297519e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:9.275685219911622e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.3888082905921806e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.1491109132766724
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:4.793731633867537e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:2.5021579252992865e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.75
[Task 1 Finish] Global Accuracy on Task 1: 84.53
tensor([[93.1677,  0.0000,  0.0000],
        [80.7453, 84.5333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.64	Global AF: 12.42
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.7500025872863034e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.618451177051952e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.5815398990426388e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.049637374909821e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.318222641102153e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.145296245676832e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 54.97
[Task 2 Finish] Global Accuracy on Task 1: 52.27
[Task 2 Finish] Global Accuracy on Task 2: 83.65
tensor([[93.1677,  0.0000,  0.0000],
        [80.7453, 84.5333,  0.0000],
        [54.9689, 52.2667, 83.6478]], device='cuda:0')
[Task 2 Finish] Global AA: 63.63	Global AF: 35.23
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788243813905865
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.1817596901053662e-09
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.758645310078748e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.711796118885616e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979211614932865
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.487150928600414e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.17
tensor([[93.1677,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.17	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.1733448657125223e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.349582750582613e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.868918377480384e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.8400771451563287e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.000379664299543947
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.431856158783944e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 76.40
[Task 1 Finish] Global Accuracy on Task 1: 89.33
tensor([[93.1677,  0.0000,  0.0000],
        [76.3975, 89.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.87	Global AF: 16.77
--------------------------------------------------
[I 2025-09-14 22:14:26,995] Trial 19 finished with value: 67.3271484375 and parameters: {'num_recon_nodes': 3, 'beta': 0.06999999999999999, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 22:16:07,917] Trial 20 finished with value: 62.46495819091797 and parameters: {'num_recon_nodes': 1, 'beta': 0.01, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.1022358581413982e-09
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.371234013118453e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:9.942037193511055e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:8.0376705291485e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.624716886172166e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.270110707364609e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 58.07
[Task 2 Finish] Global Accuracy on Task 1: 56.80
[Task 2 Finish] Global Accuracy on Task 2: 87.11
tensor([[93.1677,  0.0000,  0.0000],
        [76.3975, 89.3333,  0.0000],
        [58.0745, 56.8000, 87.1069]], device='cuda:0')
[Task 2 Finish] Global AA: 67.33	Global AF: 33.81
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788275828119367
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.913061789681763e-11
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.15315842628479
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:9.941681922143175e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:8.675615226216848e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.701232346806307e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.6932194535357326e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:9.175120108118051e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.266945933892544e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.912410088766308e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:6.787335138369599e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:9.11665076763768e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.92
[Task 1 Finish] Global Accuracy on Task 1: 66.67
tensor([[94.4099,  0.0000,  0.0000],
        [82.9193, 66.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 74.79	Global AF: 11.49
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.605203606291354e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.326540987114157e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.286662467327233e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.03872288763523102
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:2.120451592091399e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.584503025626077e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 76.71
[Task 2 Finish] Global Accuracy on Task 1: 75.47
[Task 2 Finish] Global Accuracy on Task 2: 35.22
tensor([[94.4099,  0.0000,  0.0000],
        [82.9193, 66.6667,  0.0000],
        [76.7081, 75.4667, 35.2201]], device='cuda:0')
[Task 2 Finish] Global AA: 62.46	Global AF: 4.45
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:3.221472255621194e-10
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.617975642353997e-09
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:9.50146405997998e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.602293823818826e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.432480021383412e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.280416992547998e-09
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.1276294342721371e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.635013815094794e-10
[I 2025-09-14 22:18:05,064] Trial 21 finished with value: 68.96762084960938 and parameters: {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 22:19:48,317] Trial 22 finished with value: 58.06298065185547 and parameters: {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.0366564273667223e-09
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.473973165744269e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.7042012245838123e-09
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.654743422984666e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.02
[Task 1 Finish] Global Accuracy on Task 1: 91.20
tensor([[94.0994,  0.0000,  0.0000],
        [77.0186, 91.2000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.11	Global AF: 17.08
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.840646772308332e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.1791008169836914e-09
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.844561418693161e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.591347550572891e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:2.736398330149825e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.008720660448773e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 62.42
[Task 2 Finish] Global Accuracy on Task 1: 53.60
[Task 2 Finish] Global Accuracy on Task 2: 90.88
tensor([[94.0994,  0.0000,  0.0000],
        [77.0186, 91.2000,  0.0000],
        [62.4224, 53.6000, 90.8805]], device='cuda:0')
[Task 2 Finish] Global AA: 68.97	Global AF: 34.64
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00103692093398422
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:0.0008667521760798991
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.596319518907933e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.45619771585848e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.4253029301822835e-09
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.0215877860607634e-09
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.17
tensor([[93.1677,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.17	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.0556255869431652e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.6350283894037716e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.3448426816609071e-09
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.638782939523026e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796643577516079
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:2.2719158498940573e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 64.60
[Task 1 Finish] Global Accuracy on Task 1: 89.33
tensor([[93.1677,  0.0000,  0.0000],
        [64.5963, 89.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 76.96	Global AF: 28.57
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:2.2015784750806233e-09
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.1557540480211514e-09
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:9.625638064392206e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.965500871063512e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.557400733520069e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.402783941401481e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 49.38
[Task 2 Finish] Global Accuracy on Task 1: 40.53
[Task 2 Finish] Global Accuracy on Task 2: 84.28
tensor([[93.1677,  0.0000,  0.0000],
        [64.5963, 89.3333,  0.0000],
        [49.3789, 40.5333, 84.2767]], device='cuda:0')
[Task 2 Finish] Global AA: 58.06	Global AF: 46.29
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788249634671956
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:8.786018579343136e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:9.615505058846452e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.741872839884252e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.2409197547877966e-10
[I 2025-09-14 22:21:34,580] Trial 23 finished with value: 59.898773193359375 and parameters: {'num_recon_nodes': 3, 'beta': 0.08, 'decay': 0.4, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 22:23:13,442] Trial 24 finished with value: 67.06588745117188 and parameters: {'num_recon_nodes': 3, 'beta': 0.05, 'decay': 0.5, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:0.060132186859846115
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.779719480791812e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.415176168061976e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.879040280795891e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.3931844273537024e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796651726588607
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.103276772861932e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 76.71
[Task 1 Finish] Global Accuracy on Task 1: 88.80
tensor([[94.7205,  0.0000,  0.0000],
        [76.7081, 88.8000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.75	Global AF: 18.01
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.4835314088301743e-09
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.409213715308226e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.526225753728966e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.148238891803601e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.575425287065229e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.5659626373398794e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 45.34
[Task 2 Finish] Global Accuracy on Task 1: 46.93
[Task 2 Finish] Global Accuracy on Task 2: 87.42
tensor([[94.7205,  0.0000,  0.0000],
        [76.7081, 88.8000,  0.0000],
        [45.3416, 46.9333, 87.4214]], device='cuda:0')
[Task 2 Finish] Global AA: 59.90	Global AF: 45.62
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:4.4933315401785023e-10
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:8.634516435179762e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:9.562471925406157e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.684012149842488e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.440203370594588e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.1974077285259455e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.014329838130664e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.3860437242385615e-09
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.4957434996995005e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.215153474682268e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:3.287870531387682e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.9234507309693356e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.43
[Task 1 Finish] Global Accuracy on Task 1: 88.27
tensor([[94.4099,  0.0000,  0.0000],
        [80.4348, 88.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.35	Global AF: 13.98
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.174284499811279e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.678994107251924e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.025707395747303963
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.000449726969236508
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.101891686898341e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:9.19223475115416e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 58.39
[Task 2 Finish] Global Accuracy on Task 1: 54.13
[Task 2 Finish] Global Accuracy on Task 2: 88.68
tensor([[94.4099,  0.0000,  0.0000],
        [80.4348, 88.2667,  0.0000],
        [58.3851, 54.1333, 88.6792]], device='cuda:0')
[Task 2 Finish] Global AA: 67.07	Global AF: 35.08
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[I 2025-09-14 22:24:52,043] Trial 25 finished with value: 65.11274719238281 and parameters: {'num_recon_nodes': 3, 'beta': 0.08, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788294745609164
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.407652186624091e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.5413919019511297e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.509914274310802e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.598724427460013e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.449090817981727e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.63534141362743e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.768005683139734e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.229399773793887e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.5232436423318063e-09
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.2245641167751842e-09
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.25303975265723e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.50
[Task 1 Finish] Global Accuracy on Task 1: 88.53
tensor([[94.4099,  0.0000,  0.0000],
        [79.5031, 88.5333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.02	Global AF: 14.91
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.397581825938857e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.032763898491169e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.333861768403892e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.473817427630422e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:9.107947729347643e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.273236486884713e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 56.21
[Task 2 Finish] Global Accuracy on Task 1: 50.13
[Task 2 Finish] Global Accuracy on Task 2: 88.99
tensor([[94.4099,  0.0000,  0.0000],
        [79.5031, 88.5333,  0.0000],
        [56.2112, 50.1333, 88.9937]], device='cuda:0')
[Task 2 Finish] Global AA: 65.11	Global AF: 38.30
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378828746965155
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.853181272996721e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:2.773273000133969e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.164853072476717e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.135665226418951e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.573106031166787e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.1962718593494515e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.639033684445849e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:0.04202689975500107
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.831528120976316e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966453237459064
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.181781753156201e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.50
[Task 1 Finish] Global Accuracy on Task 1: 87.73
tensor([[94.7205,  0.0000,  0.0000],
        [79.5031, 87.7333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.62	Global AF: 15.22
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.973761650958977e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:2.726571746158868e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:9.900409381202735e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.415904226145017e-10
[I 2025-09-14 22:26:43,386] Trial 26 finished with value: 70.65110778808594 and parameters: {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 22:28:31,539] Trial 27 finished with value: 71.57896423339844 and parameters: {'num_recon_nodes': 3, 'beta': 0.06999999999999999, 'decay': 0.0, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.0819654061577921e-09
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.750750821041038e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 62.11
[Task 2 Finish] Global Accuracy on Task 1: 60.53
[Task 2 Finish] Global Accuracy on Task 2: 89.31
tensor([[94.7205,  0.0000,  0.0000],
        [79.5031, 87.7333,  0.0000],
        [62.1118, 60.5333, 89.3082]], device='cuda:0')
[Task 2 Finish] Global AA: 70.65	Global AF: 29.90
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788284559268504
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.246497208373114e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.629315595420906e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.997797896701741e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.7858640101216e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.986136196791449e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.1766743135410707e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.328899378374217e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.2095736265182495
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.81011524950037e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966464878991246
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:9.31383414837228e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 68.94
[Task 1 Finish] Global Accuracy on Task 1: 90.93
tensor([[95.0311,  0.0000,  0.0000],
        [68.9441, 90.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.94	Global AF: 26.09
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.851665263456596e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:9.295698100153515e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.316149825380535e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497270274441689
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.965988371046336e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.711350198860487e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 65.22
[Task 2 Finish] Global Accuracy on Task 1: 57.07
[Task 2 Finish] Global Accuracy on Task 2: 92.45
tensor([[95.0311,  0.0000,  0.0000],
        [68.9441, 90.9333,  0.0000],
        [65.2174, 57.0667, 92.4528]], device='cuda:0')
[Task 2 Finish] Global AA: 71.58	Global AF: 31.84
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788223441224545
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.37127567581652e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.06282016310422e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.459523388928744e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979206085205078
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.3296674872265157e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.5108866380231234e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.90989496124439e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:2.5744095744073547e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.5716638807924426e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:5.2844612019598e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.792589906685521e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 72.98
[Task 1 Finish] Global Accuracy on Task 1: 90.67
[I 2025-09-14 22:30:26,099] Trial 28 finished with value: 65.33971405029297 and parameters: {'num_recon_nodes': 1, 'beta': 0.09, 'decay': 0.0, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 22:32:18,592] Trial 29 finished with value: 73.72149658203125 and parameters: {'num_recon_nodes': 3, 'beta': 0.06999999999999999, 'decay': 0.2, 'num_epoch_g': 10}. Best is trial 15 with value: 77.06944274902344.
tensor([[94.4099,  0.0000,  0.0000],
        [72.9814, 90.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.82	Global AF: 21.43
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.1511893660554051e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.785812467491326e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.634780502778881e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.20973922388157e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.468516195428208e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.888853045668327e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 55.28
[Task 2 Finish] Global Accuracy on Task 1: 46.40
[Task 2 Finish] Global Accuracy on Task 2: 94.34
tensor([[94.4099,  0.0000,  0.0000],
        [72.9814, 90.6667,  0.0000],
        [55.2795, 46.4000, 94.3396]], device='cuda:0')
[Task 2 Finish] Global AA: 65.34	Global AF: 41.70
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:3.6325864538611086e-10
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.015389964973082e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.1711543956849368e-09
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.492048594733177e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.513681178292984e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.3028685902648505e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.876281293839327e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.8953591474080156e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:0.000207119868719019
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.5654809393250702e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796654928009957
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.739694996011792e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.06
[Task 1 Finish] Global Accuracy on Task 1: 83.73
tensor([[94.4099,  0.0000,  0.0000],
        [81.0559, 83.7333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.39	Global AF: 13.35
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.849268067796402e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.030457830175635e-09
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:9.193365513304741e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.4151240996548324e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.004365976115423e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.2193884230414795e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 74.22
[Task 2 Finish] Global Accuracy on Task 1: 83.73
[Task 2 Finish] Global Accuracy on Task 2: 63.21
tensor([[94.4099,  0.0000,  0.0000],
        [81.0559, 83.7333,  0.0000],
        [74.2236, 83.7333, 63.2075]], device='cuda:0')
[Task 2 Finish] Global AA: 73.72	Global AF: 10.09
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788293290417641
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.336692282005174e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.344609199653405e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.750339093779644e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.5858363511256357e-09
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.5125075636390761e-09
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 92.55
tensor([[92.5466,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 92.55	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[I 2025-09-14 22:34:05,701] Trial 30 finished with value: 62.834747314453125 and parameters: {'num_recon_nodes': 3, 'beta': 0.05, 'decay': 0.2, 'num_epoch_g': 10}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 22:36:07,541] Trial 31 finished with value: 48.65874481201172 and parameters: {'num_recon_nodes': 3, 'beta': 0.06999999999999999, 'decay': 0.0, 'num_epoch_g': 10}. Best is trial 15 with value: 77.06944274902344.
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.095779129886239e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.077847724052845e-09
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.052846640043242e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.727775393398304e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:7.05701330705466e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.535277319308364e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.54
[Task 1 Finish] Global Accuracy on Task 1: 82.13
tensor([[92.5466,  0.0000,  0.0000],
        [83.5404, 82.1333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.84	Global AF: 9.01
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.991473345761221e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.202269808852634e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:9.220896823869396e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.652854295767895e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:2.744144911304147e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:0.033466536551713943
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 73.91
[Task 2 Finish] Global Accuracy on Task 1: 80.00
[Task 2 Finish] Global Accuracy on Task 2: 34.59
tensor([[92.5466,  0.0000,  0.0000],
        [83.5404, 82.1333,  0.0000],
        [73.9130, 80.0000, 34.5912]], device='cuda:0')
[Task 2 Finish] Global AA: 62.83	Global AF: 10.38
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:7.58923257571098e-10
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.0302604042399253e-09
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.690049542650399e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.758360537872932e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979211614932865
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.682459975313691e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.650104275441322e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.296304754296102e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.314652772372199e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.560527676668926e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:4.0198874784458383e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.217995562884937e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 64.29
[Task 1 Finish] Global Accuracy on Task 1: 87.73
tensor([[93.7888,  0.0000,  0.0000],
        [64.2857, 87.7333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 76.01	Global AF: 29.50
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.612908554082253e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:2.58162879962498e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.0003939824237022549
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:2.8573882149274255e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.216861635546024e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.0116560922313056e-09
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 61.49
[Task 2 Finish] Global Accuracy on Task 1: 51.47
[Task 2 Finish] Global Accuracy on Task 2: 33.02
tensor([[93.7888,  0.0000,  0.0000],
        [64.2857, 87.7333,  0.0000],
        [61.4907, 51.4667, 33.0189]], device='cuda:0')
[Task 2 Finish] Global AA: 48.66	Global AF: 34.28
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788254000246525
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:9.010710511070386e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.4292739214383232e-09
[I 2025-09-14 22:37:54,071] Trial 32 finished with value: 55.79862594604492 and parameters: {'num_recon_nodes': 3, 'beta': 0.06999999999999999, 'decay': 0.1, 'num_epoch_g': 10}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 22:39:49,118] Trial 33 finished with value: 68.55636596679688 and parameters: {'num_recon_nodes': 3, 'beta': 0.08, 'decay': 0.2, 'num_epoch_g': 10}. Best is trial 15 with value: 77.06944274902344.
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.9146770835476445e-09
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.000397920812247321
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:0.060132186859846115
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 89.44
tensor([[89.4410,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 89.44	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.0731368016436704e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:0.06646177917718887
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:0.00020711951947305351
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.1490269899368286
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.002666699467226863
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.552968280169267e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 69.88
[Task 1 Finish] Global Accuracy on Task 1: 82.93
tensor([[89.4410,  0.0000,  0.0000],
        [69.8758, 82.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 76.40	Global AF: 19.57
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.3010572053626674e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.472285485337181e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.025707395747303963
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.8559970227371991e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.1486498419088775e-09
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.343397586037412e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 59.63
[Task 2 Finish] Global Accuracy on Task 1: 79.47
[Task 2 Finish] Global Accuracy on Task 2: 28.30
tensor([[89.4410,  0.0000,  0.0000],
        [69.8758, 82.9333,  0.0000],
        [59.6273, 79.4667, 28.3019]], device='cuda:0')
[Task 2 Finish] Global AA: 55.80	Global AF: 16.64
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.2607251909102501e-09
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:7.164030479955841e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.2162791884762214e-09
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.4061344311144808e-09
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:8.966921649644632e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.9394876815681528e-09
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.48
tensor([[93.4783,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.48	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.515275682706374e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.349188981704998e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:2.9616303853785553e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.375492356269774e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966525997035205
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.28287652407289e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 74.84
[Task 1 Finish] Global Accuracy on Task 1: 84.00
tensor([[93.4783,  0.0000,  0.0000],
        [74.8447, 84.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.42	Global AF: 18.63
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.803485163078051e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.333929492008394e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.1941641009372006e-09
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497271147556603
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:9.205537998546731e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.613130515946807e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 76.71
[Task 2 Finish] Global Accuracy on Task 1: 80.53
[Task 2 Finish] Global Accuracy on Task 2: 48.43
tensor([[93.4783,  0.0000,  0.0000],
        [74.8447, 84.0000,  0.0000],
        [76.7081, 80.5333, 48.4277]], device='cuda:0')
[Task 2 Finish] Global AA: 68.56	Global AF: 10.12
--------------------------------------------------
--------------------------------------------------
[I 2025-09-14 22:41:43,329] Trial 34 finished with value: 39.55419158935547 and parameters: {'num_recon_nodes': 3, 'beta': 0.03, 'decay': 0.0, 'num_epoch_g': 10}. Best is trial 15 with value: 77.06944274902344.
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788274372927845
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.32733959776499e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:9.509369958138336e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.678549769820961e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.116243067566529e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.491287979886295e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:3.3357638873354745e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.51225867570804e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.864203094814059e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.3111144381869906e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966493982821703
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.7167763044501072e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.12
[Task 1 Finish] Global Accuracy on Task 1: 79.73
tensor([[94.7205,  0.0000,  0.0000],
        [80.1242, 79.7333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.93	Global AF: 14.60
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.507891058329164e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.908382920225222e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.098388460884507e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497275804169476
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.2478477119422e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.1305646002712777e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 41.93
[Task 2 Finish] Global Accuracy on Task 1: 70.13
[Task 2 Finish] Global Accuracy on Task 2: 6.60
tensor([[94.7205,  0.0000,  0.0000],
        [80.1242, 79.7333,  0.0000],
        [41.9255, 70.1333,  6.6038]], device='cuda:0')
[Task 2 Finish] Global AA: 39.55	Global AF: 31.20
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788312207907438
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:7.1013966929101e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.617010438527473e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.600521240684998e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.604022884104666e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:9.358770425293983e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 91.93
tensor([[91.9255,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 91.93	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.2574679075783024e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.326077994778245e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.946094644964205e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.185598227543721e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:5.024241023221521e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.470906505600226e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 74.22
[Task 1 Finish] Global Accuracy on Task 1: 91.47
tensor([[91.9255,  0.0000,  0.0000],
        [74.2236, 91.4667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.85	Global AF: 17.70
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.634374881744122e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.1801448413814057e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
[I 2025-09-14 22:43:33,332] Trial 35 finished with value: 59.32159423828125 and parameters: {'num_recon_nodes': 3, 'beta': 0.09, 'decay': 0.2, 'num_epoch_g': 5}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 22:45:18,540] Trial 36 finished with value: 68.09817504882812 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.30000000000000004, 'num_epoch_g': 10}. Best is trial 15 with value: 77.06944274902344.
current_loss:9.926863775433503e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.88600890250035e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:9.80237557790531e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.346325384510294e-09
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 50.00
[Task 2 Finish] Global Accuracy on Task 1: 56.27
[Task 2 Finish] Global Accuracy on Task 2: 71.70
tensor([[91.9255,  0.0000,  0.0000],
        [74.2236, 91.4667,  0.0000],
        [50.0000, 56.2667, 71.6981]], device='cuda:0')
[Task 2 Finish] Global AA: 59.32	Global AF: 38.56
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:4.5402709369923855e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.547949351505707e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.252978607650505e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.307581430966877e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979204047936946
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.082214814602139e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 92.24
tensor([[92.2360,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 92.24	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.2474537786365545e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.2544701095437176e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.876398481037711e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.049681311459665e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796645032707602
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.956232977475054e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.26
[Task 1 Finish] Global Accuracy on Task 1: 82.67
tensor([[92.2360,  0.0000,  0.0000],
        [78.2609, 82.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.46	Global AF: 13.98
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.760387167264014e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.160713688669773e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.810092017557224e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.0301636200213977e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.3175092128392407e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.906711396721278e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 70.19
[Task 2 Finish] Global Accuracy on Task 1: 78.13
[Task 2 Finish] Global Accuracy on Task 2: 55.97
tensor([[92.2360,  0.0000,  0.0000],
        [78.2609, 82.6667,  0.0000],
        [70.1863, 78.1333, 55.9748]], device='cuda:0')
[Task 2 Finish] Global AA: 68.10	Global AF: 13.29
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788268552161753
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.536633569860669e-09
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.348127579158813e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:0.03505839407444
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:9.472974626945074e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.733091779092092e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.449770634768925e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.00825789226289e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.1826872521077973e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.856508694141894e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:3.018233163398776e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.562249077468607e-10
[I 2025-09-14 22:47:01,689] Trial 37 finished with value: 57.40876007080078 and parameters: {'num_recon_nodes': 3, 'beta': 0.06999999999999999, 'decay': 0.1, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 22:48:50,761] Trial 38 finished with value: 60.146881103515625 and parameters: {'num_recon_nodes': 1, 'beta': 0.09999999999999999, 'decay': 0.7000000000000001, 'num_epoch_g': 5}. Best is trial 15 with value: 77.06944274902344.
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.95
[Task 1 Finish] Global Accuracy on Task 1: 88.00
tensor([[94.7205,  0.0000,  0.0000],
        [77.9503, 88.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.98	Global AF: 16.77
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.502235889132123e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.4240334467174875e-09
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.078165913971702e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.747550768653298e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.024165863228177e-09
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.146155889259376e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 56.21
[Task 2 Finish] Global Accuracy on Task 1: 22.93
[Task 2 Finish] Global Accuracy on Task 2: 93.08
tensor([[94.7205,  0.0000,  0.0000],
        [77.9503, 88.0000,  0.0000],
        [56.2112, 22.9333, 93.0818]], device='cuda:0')
[Task 2 Finish] Global AA: 57.41	Global AF: 51.79
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0010369211668148637
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.0569136111324724e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.6153743887545886e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.733307327839611e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.766787603000978e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.996419778966697e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.883917962914211e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:9.912982656956615e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:0.00020711998513434082
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.851365585980318e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966782110743225
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.908920102688398e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.88
[Task 1 Finish] Global Accuracy on Task 1: 89.60
tensor([[94.7205,  0.0000,  0.0000],
        [78.8820, 89.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.24	Global AF: 15.84
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.83866835487845e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:9.600563677381047e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.4229163403101097e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.2804315647515523e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.615610866258834e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.6845740347679623e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 54.97
[Task 2 Finish] Global Accuracy on Task 1: 33.33
[Task 2 Finish] Global Accuracy on Task 2: 92.14
tensor([[94.7205,  0.0000,  0.0000],
        [78.8820, 89.6000,  0.0000],
        [54.9689, 33.3333, 92.1384]], device='cuda:0')
[Task 2 Finish] Global AA: 60.15	Global AF: 48.01
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:7.276840241488003e-10
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.0748115992528255e-09
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.474975472985477e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.928639801311419e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.1424474699595066e-09
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.7512792044603884e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[I 2025-09-14 22:50:25,490] Trial 39 finished with value: 62.593719482421875 and parameters: {'num_recon_nodes': 3, 'beta': 0.05, 'decay': 1.0, 'num_epoch_g': 10}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 22:52:14,389] Trial 40 finished with value: 70.52922058105469 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.813617613512292e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.4645846474768973e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.36513119989246e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:0.06120007857680321
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666990015655756
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.261088869585762e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.99
[Task 1 Finish] Global Accuracy on Task 1: 81.33
tensor([[93.7888,  0.0000,  0.0000],
        [81.9876, 81.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.66	Global AF: 11.80
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.775260600974889e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.1982383728027344
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.380880989200534e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497275804169476
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.497847342996522e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.757208516004141e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 76.40
[Task 2 Finish] Global Accuracy on Task 1: 73.33
[Task 2 Finish] Global Accuracy on Task 2: 38.05
tensor([[93.7888,  0.0000,  0.0000],
        [81.9876, 81.3333,  0.0000],
        [76.3975, 73.3333, 38.0503]], device='cuda:0')
[Task 2 Finish] Global AA: 62.59	Global AF: 12.70
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788242358714342
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.4521209790174794e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.491318511019472e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.2775159536081446e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.4919830926274358e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.957137728605176e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.96
tensor([[95.9627,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.96	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.992109279404303e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.533985657559583e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.9918821026496687e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.0132937822149302e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:8.038513743535702e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.7215455717110046e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.47
[Task 1 Finish] Global Accuracy on Task 1: 76.27
tensor([[95.9627,  0.0000,  0.0000],
        [84.4721, 76.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.37	Global AF: 11.49
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.670863306190711e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.297146055127655e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.4689163480882144e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.03872288763523102
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.6806924175181166e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.6710199890468402e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 72.98
[Task 2 Finish] Global Accuracy on Task 1: 77.60
[Task 2 Finish] Global Accuracy on Task 2: 61.01
tensor([[95.9627,  0.0000,  0.0000],
        [84.4721, 76.2667,  0.0000],
        [72.9814, 77.6000, 61.0063]], device='cuda:0')
[Task 2 Finish] Global AA: 70.53	Global AF: 10.82
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.17362380027771
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
[I 2025-09-14 22:54:10,782] Trial 41 finished with value: 66.29718017578125 and parameters: {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
current_loss:7.267077495320962e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.26039711790105e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.460886742802984e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.160347149590905e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.424607512656166e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.309518604664106e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.887500652614676e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:9.269358614005796e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.566898053643854e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666997000575066
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.7346892245437857e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 72.98
[Task 1 Finish] Global Accuracy on Task 1: 89.07
tensor([[94.4099,  0.0000,  0.0000],
        [72.9814, 89.0667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.02	Global AF: 21.43
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.0233752734123414e-09
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.788264312300839e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.658205015635076e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497273766901344
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.489075777769358e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.727894907854193e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 56.52
[Task 2 Finish] Global Accuracy on Task 1: 61.87
[Task 2 Finish] Global Accuracy on Task 2: 80.50
tensor([[94.4099,  0.0000,  0.0000],
        [72.9814, 89.0667,  0.0000],
        [56.5217, 61.8667, 80.5031]], device='cuda:0')
[Task 2 Finish] Global AA: 66.30	Global AF: 32.54
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788275828119367
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.121439938804428e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.0892619028979311e-09
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.850164159186932e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.122516524176831e-09
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.474109581766641e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.697894544023143e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.474303788055579e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.988421425406898e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.5574691243110976e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666997000575066
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.525370409628863e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.33
[Task 1 Finish] Global Accuracy on Task 1: 89.87
tensor([[93.7888,  0.0000,  0.0000],
        [77.3292, 89.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.60	Global AF: 16.46
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.073019475141052e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.068988786379066e-09
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.585573280621816e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.977205397300622e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:2.9326127637396837e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.1253888931861411e-09
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 63.04
[Task 2 Finish] Global Accuracy on Task 1: 50.67
[Task 2 Finish] Global Accuracy on Task 2: 88.68
tensor([[93.7888,  0.0000,  0.0000],
        [77.3292, 89.8667,  0.0000],
        [63.0435, 50.6667, 88.6792]], device='cuda:0')
[I 2025-09-14 22:56:02,055] Trial 42 finished with value: 67.463134765625 and parameters: {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.5, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 22:57:52,778] Trial 43 finished with value: 59.36391830444336 and parameters: {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[Task 2 Finish] Global AA: 67.46	Global AF: 34.97
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:8.006672547189453e-10
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.245970324807558e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.1813232603816743e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.074362598885159e-09
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.945033354493034e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.879918136246886e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.0062547179122703e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:0.06646177917718887
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.0833598462767213e-09
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.1197144322849795e-09
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:3.944167492608841e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.1131201516079159e-09
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.68
[Task 1 Finish] Global Accuracy on Task 1: 86.93
tensor([[94.0994,  0.0000,  0.0000],
        [81.6770, 86.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.31	Global AF: 12.42
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.782481077825196e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.533529745527233e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.204206592919093e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:8.729905687232531e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.723966938793069e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.062144675134107e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 53.11
[Task 2 Finish] Global Accuracy on Task 1: 32.53
[Task 2 Finish] Global Accuracy on Task 2: 92.45
tensor([[94.0994,  0.0000,  0.0000],
        [81.6770, 86.9333,  0.0000],
        [53.1056, 32.5333, 92.4528]], device='cuda:0')
[Task 2 Finish] Global AA: 59.36	Global AF: 47.70
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.4501413403422703e-09
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.661802138234862e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:0.04181229695677757
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.648708333363174e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.1355495977436476e-09
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.9646575477594297e-09
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.681514230777452e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.23747323288859e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.2538947364612056e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:2.4671373277662667e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:8.277360463715411e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.927660112232559e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.92
[Task 1 Finish] Global Accuracy on Task 1: 89.33
tensor([[94.4099,  0.0000,  0.0000],
        [82.9193, 89.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 86.13	Global AF: 11.49
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.690367231916184e-10
[I 2025-09-14 22:59:43,873] Trial 44 finished with value: 68.70986938476562 and parameters: {'num_recon_nodes': 3, 'beta': 0.06999999999999999, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 23:01:33,935] Trial 45 finished with value: 61.41374969482422 and parameters: {'num_recon_nodes': 3, 'beta': 0.04, 'decay': 0.4, 'num_epoch_g': 5}. Best is trial 15 with value: 77.06944274902344.
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.1690424184251924e-09
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.8910002452798835e-09
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.00044972760952077806
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.887690418011516e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.497923227792967e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 70.50
[Task 2 Finish] Global Accuracy on Task 1: 45.07
[Task 2 Finish] Global Accuracy on Task 2: 90.57
tensor([[94.4099,  0.0000,  0.0000],
        [82.9193, 89.3333,  0.0000],
        [70.4969, 45.0667, 90.5660]], device='cuda:0')
[Task 2 Finish] Global AA: 68.71	Global AF: 34.09
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788243813905865
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.4633435574396003e-09
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.2883147881836976e-09
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.2088814393962366e-09
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.1453420423765976e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.873539267118531e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.727874534208979e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.14132514339849e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.353773535610173e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.85518000540253e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:4.1550113349941853e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:2.8179789057780624e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.57
[Task 1 Finish] Global Accuracy on Task 1: 89.60
tensor([[94.4099,  0.0000,  0.0000],
        [78.5714, 89.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.09	Global AF: 15.84
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.811747751823134e-09
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.5671014192727455e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.0504068725936122e-09
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.03872288763523102
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.492556409691929e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.172292842445472e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 50.62
[Task 2 Finish] Global Accuracy on Task 1: 65.07
[Task 2 Finish] Global Accuracy on Task 2: 68.55
tensor([[94.4099,  0.0000,  0.0000],
        [78.5714, 89.6000,  0.0000],
        [50.6211, 65.0667, 68.5535]], device='cuda:0')
[Task 2 Finish] Global AA: 61.41	Global AF: 34.16
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.17362380027771
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.666022178691833e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.257994930448092e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.4360529138920413e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.798348912122719e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.529372739561552e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:3.674811011045165e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.440338097211338e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.820160075056037e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.565057303869025e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
[I 2025-09-14 23:03:24,072] Trial 46 finished with value: 67.81859588623047 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 23:05:20,700] Trial 47 finished with value: 67.27333068847656 and parameters: {'num_recon_nodes': 3, 'beta': 0.08, 'decay': 0.5, 'num_epoch_g': 10}. Best is trial 15 with value: 77.06944274902344.
current_loss:9.699693270803778e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.765690702652648e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.23
[Task 1 Finish] Global Accuracy on Task 1: 84.80
tensor([[94.4099,  0.0000,  0.0000],
        [83.2298, 84.8000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.01	Global AF: 11.18
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.799386136930764e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:0.0003803869185503572
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.711323748323281e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.4811190869076256e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:9.145518231612471e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.177490492944912e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 63.66
[Task 2 Finish] Global Accuracy on Task 1: 55.20
[Task 2 Finish] Global Accuracy on Task 2: 84.59
tensor([[94.4099,  0.0000,  0.0000],
        [83.2298, 84.8000,  0.0000],
        [63.6646, 55.2000, 84.5912]], device='cuda:0')
[Task 2 Finish] Global AA: 67.82	Global AF: 30.17
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788284559268504
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.4447870677614105e-09
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.8409739278044697e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.351495357963643e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.2889552475646724e-09
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.898303069238551e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.222163977971263e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.6819747251115587e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.537349550583826e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:0.06120007857680321
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.002666698768734932
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:9.073046758345527e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 73.91
[Task 1 Finish] Global Accuracy on Task 1: 91.47
tensor([[94.4099,  0.0000,  0.0000],
        [73.9130, 91.4667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.69	Global AF: 20.50
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.294756855178662e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:9.691728530825117e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.307255828730263e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497274640016258
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.404799387927369e-09
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.563101646011148e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 50.31
[Task 2 Finish] Global Accuracy on Task 1: 60.00
[Task 2 Finish] Global Accuracy on Task 2: 91.51
tensor([[94.4099,  0.0000,  0.0000],
        [73.9130, 91.4667,  0.0000],
        [50.3106, 60.0000, 91.5094]], device='cuda:0')
[Task 2 Finish] Global AA: 67.27	Global AF: 37.78
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788312207907438
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:9.28245869058486e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.080535909167793e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.730132869250724e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.0964745495177795e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.450296963222968e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
[I 2025-09-14 23:07:09,008] Trial 48 finished with value: 60.048370361328125 and parameters: {'num_recon_nodes': 1, 'beta': 0.06999999999999999, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 23:09:07,313] Trial 49 finished with value: 64.86410522460938 and parameters: {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.1, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:3.941792725559168e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.550440190267182e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.0134217909296694e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.1586460679779975e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:4.3384987269412534e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.579849525818361e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.92
[Task 1 Finish] Global Accuracy on Task 1: 88.53
tensor([[95.6522,  0.0000,  0.0000],
        [82.9193, 88.5333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 85.73	Global AF: 12.73
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.478204722133341e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.458574786094573e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.195465251934706e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.28042570674603e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.4678728232908611e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.12950193642547e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 51.86
[Task 2 Finish] Global Accuracy on Task 1: 35.20
[Task 2 Finish] Global Accuracy on Task 2: 93.08
tensor([[95.6522,  0.0000,  0.0000],
        [82.9193, 88.5333,  0.0000],
        [51.8634, 35.2000, 93.0818]], device='cuda:0')
[Task 2 Finish] Global AA: 60.05	Global AF: 48.56
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788357318844646
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.0987332144682966e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.398738843811259e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.2364316782107494e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.375045574242733e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.433179544629297e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.17
tensor([[93.1677,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.17	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.7502525257183663e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.812592157068309e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.986768551544344e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.3467850168424889e-09
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.000379664619686082
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.538962149527094e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.57
[Task 1 Finish] Global Accuracy on Task 1: 85.87
tensor([[93.1677,  0.0000,  0.0000],
        [78.5714, 85.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.22	Global AF: 14.60
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.431670892948489e-09
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.981248829556307e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.1120368221569947e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.1596553979061923e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.66002039576108e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.157399672941267e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 62.11
[Task 2 Finish] Global Accuracy on Task 1: 41.60
[Task 2 Finish] Global Accuracy on Task 2: 90.88
tensor([[93.1677,  0.0000,  0.0000],
        [78.5714, 85.8667,  0.0000],
        [62.1118, 41.6000, 90.8805]], device='cuda:0')
[Task 2 Finish] Global AA: 64.86	Global AF: 37.66
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[I 2025-09-14 23:11:01,741] Trial 50 finished with value: 66.65773010253906 and parameters: {'num_recon_nodes': 3, 'beta': 0.09, 'decay': 0.30000000000000004, 'num_epoch_g': 5}. Best is trial 15 with value: 77.06944274902344.
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0010369210503995419
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.5837349754430647e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.406881691845001e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.1052069259775976e-09
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979200846515596
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.817921978566119e-09
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.17
tensor([[93.1677,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.17	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.742240654666887e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:9.050873384097713e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.979163192864178e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.684712783311397e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:7.385042577467971e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.2200009325578094e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 73.29
[Task 1 Finish] Global Accuracy on Task 1: 86.93
tensor([[93.1677,  0.0000,  0.0000],
        [73.2919, 86.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.11	Global AF: 19.88
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.796555540589111e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.102181455107768e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:2.8403376872709885e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.0873891786999934e-09
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.729795444191609e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.224686487423583e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 50.93
[Task 2 Finish] Global Accuracy on Task 1: 59.73
[Task 2 Finish] Global Accuracy on Task 2: 89.31
tensor([[93.1677,  0.0000,  0.0000],
        [73.2919, 86.9333,  0.0000],
        [50.9317, 59.7333, 89.3082]], device='cuda:0')
[Task 2 Finish] Global AA: 66.66	Global AF: 34.72
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788280193693936
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:9.022593228102949e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:0.029654882848262787
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:8.138558160730724e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979208995588124
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.1284029266533935e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.48
tensor([[93.4783,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.48	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.088584246834785e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.364356902073155e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.9209535618311975e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.229213811437262e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966491072438657
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.218730530527239e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.02
[Task 1 Finish] Global Accuracy on Task 1: 83.20
tensor([[93.4783,  0.0000,  0.0000],
        [77.0186, 83.2000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.11	Global AF: 16.46
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.0713209208645935e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.286354049476415e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.673708252691313e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.048264666880243e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.649023164331027e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.408175963670601e-10
[I 2025-09-14 23:12:56,760] Trial 51 finished with value: 72.14285278320312 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.5, 'num_epoch_g': 5}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 23:14:48,465] Trial 52 finished with value: 69.17216491699219 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.6000000000000001, 'num_epoch_g': 5}. Best is trial 15 with value: 77.06944274902344.
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 77.33
[Task 2 Finish] Global Accuracy on Task 1: 81.87
[Task 2 Finish] Global Accuracy on Task 2: 57.23
tensor([[93.4783,  0.0000,  0.0000],
        [77.0186, 83.2000,  0.0000],
        [77.3292, 81.8667, 57.2327]], device='cuda:0')
[Task 2 Finish] Global AA: 72.14	Global AF: 8.74
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:4.926563601514999e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.629344212998433e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.5802611703393836e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.494785347894606e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.561461291492265e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.211566816460845e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.2639617130716374e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.4669136178268047e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.760940223811019e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:8.596096612301096e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966459058225155
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.178682010471448e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.88
[Task 1 Finish] Global Accuracy on Task 1: 81.87
tensor([[93.7888,  0.0000,  0.0000],
        [78.8820, 81.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.37	Global AF: 14.91
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.039262340744699e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.718289258245136e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:2.859907866081812e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.1194133398007011e-09
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.903963429254588e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.817241215983927e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 77.64
[Task 2 Finish] Global Accuracy on Task 1: 78.93
[Task 2 Finish] Global Accuracy on Task 2: 50.94
tensor([[93.7888,  0.0000,  0.0000],
        [78.8820, 81.8667,  0.0000],
        [77.6398, 78.9333, 50.9434]], device='cuda:0')
[Task 2 Finish] Global AA: 69.17	Global AF: 9.54
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378826127620414
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.4211803955888058e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.0163643804925755e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:0.00014271833060774952
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.2694530981960384e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.2403273963457195e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.131534889876946e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.7167752209299465e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.899009614118711e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.012616515782554e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0239687729626894
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.3101464357845316e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.95
[Task 1 Finish] Global Accuracy on Task 1: 82.67
tensor([[94.4099,  0.0000,  0.0000],
        [77.9503, 82.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.31	Global AF: 16.46
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[I 2025-09-14 23:16:40,912] Trial 53 finished with value: 67.33943939208984 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.4, 'num_epoch_g': 5}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 23:18:34,018] Trial 54 finished with value: 68.3652572631836 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.5, 'num_epoch_g': 5}. Best is trial 15 with value: 77.06944274902344.
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.4743223015508704e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.285287207890121e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.640160005704331e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:8.386175087693459e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.9533445961303926e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.940153481263309e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 68.94
[Task 2 Finish] Global Accuracy on Task 1: 69.87
[Task 2 Finish] Global Accuracy on Task 2: 63.21
tensor([[94.4099,  0.0000,  0.0000],
        [77.9503, 82.6667,  0.0000],
        [68.9441, 69.8667, 63.2075]], device='cuda:0')
[Task 2 Finish] Global AA: 67.34	Global AF: 19.13
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0010369210503995419
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.7268855234675584e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.3524545927623421e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.7169369531954146e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:8.631717562934682e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:0.060132186859846115
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 90.37
tensor([[90.3727,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 90.37	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.7608149383008254e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.851664625604712e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.795102258649877e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.778265561000694e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:3.657656399980169e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.314169908096858e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.06
[Task 1 Finish] Global Accuracy on Task 1: 81.87
tensor([[90.3727,  0.0000,  0.0000],
        [81.0559, 81.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.46	Global AF: 9.32
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.32256025312472e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.429184407075184e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.6072689280075565e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.891464621183729e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.479637937317761e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.978852661378767e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 76.09
[Task 2 Finish] Global Accuracy on Task 1: 80.27
[Task 2 Finish] Global Accuracy on Task 2: 48.74
tensor([[90.3727,  0.0000,  0.0000],
        [81.0559, 81.8667,  0.0000],
        [76.0870, 80.2667, 48.7421]], device='cuda:0')
[Task 2 Finish] Global AA: 68.37	Global AF: 7.94
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378833840135485
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.57451093566408e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.3938544469490637e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.312583233913927e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:4.390839081214182e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.127883838720095e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.031135201314044e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.14335352086448e-10
[I 2025-09-14 23:20:27,428] Trial 55 finished with value: 71.5794448852539 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 23:22:27,587] Trial 56 finished with value: 68.2701644897461 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.8, 'num_epoch_g': 5}. Best is trial 15 with value: 77.06944274902344.
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.525224970412637e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.710711903361698e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.2234758761664466e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.880562868933794e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.06
[Task 1 Finish] Global Accuracy on Task 1: 81.33
tensor([[94.0994,  0.0000,  0.0000],
        [81.0559, 81.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.19	Global AF: 13.04
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.3852818891990637e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.119145828404783e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.03265729300972e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.00044972708565182984
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.3507663876310971e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.442362199265972e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 79.50
[Task 2 Finish] Global Accuracy on Task 1: 73.60
[Task 2 Finish] Global Accuracy on Task 2: 61.64
tensor([[94.0994,  0.0000,  0.0000],
        [81.0559, 81.3333,  0.0000],
        [79.5031, 73.6000, 61.6352]], device='cuda:0')
[Task 2 Finish] Global AA: 71.58	Global AF: 11.16
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378832384943962
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.8052269679103006e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.1936997491044394e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.7322128720873593e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.000397920492105186
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.9970515786080796e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.6960057802606343e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.534246034193501e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.135314644164282e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.831849613282316e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:6.375775463141053e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.850888827931612e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.99
[Task 1 Finish] Global Accuracy on Task 1: 81.07
tensor([[93.7888,  0.0000,  0.0000],
        [81.9876, 81.0667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.53	Global AF: 11.80
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:2.1667918570500433e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.5506050877209816e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:9.548608570497663e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.03872288763523102
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.414592911343277e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.266045460279202e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 81.37
[Task 2 Finish] Global Accuracy on Task 1: 79.73
[Task 2 Finish] Global Accuracy on Task 2: 43.71
tensor([[93.7888,  0.0000,  0.0000],
        [81.9876, 81.0667,  0.0000],
        [81.3665, 79.7333, 43.7107]], device='cuda:0')
[Task 2 Finish] Global AA: 68.27	Global AF: 6.88
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378826709697023
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.6524123442637233e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.749928978447059e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:9.730555250442308e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.1806457042694092
[I 2025-09-14 23:24:22,109] Trial 57 finished with value: 68.28544616699219 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 23:26:09,386] Trial 58 finished with value: 72.4027328491211 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.560377158708718e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.0976866082756942e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.8703772692040275e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.046320111252612e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.800246951511042e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.1855062764798419e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.6831408489181854e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.75
[Task 1 Finish] Global Accuracy on Task 1: 84.27
tensor([[93.7888,  0.0000,  0.0000],
        [80.7453, 84.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.51	Global AF: 13.04
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.424814014138747e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.0055125621022398e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.007613437131738e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:9.034690218179264e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.340928975807515e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:9.565328529248518e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 68.32
[Task 2 Finish] Global Accuracy on Task 1: 69.87
[Task 2 Finish] Global Accuracy on Task 2: 66.67
tensor([[93.7888,  0.0000,  0.0000],
        [80.7453, 84.2667,  0.0000],
        [68.3230, 69.8667, 66.6667]], device='cuda:0')
[Task 2 Finish] Global AA: 68.29	Global AF: 19.93
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788248179480433
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.11023490401152e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.15315842628479
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.921640872623811e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:9.828299285530306e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.9110656113152658e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.96
tensor([[95.9627,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.96	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.903488808911561e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.1354057694035191e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.3742906519206315e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.0728934407566726e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:7.048829853140148e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.3352109418107716e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.99
[Task 1 Finish] Global Accuracy on Task 1: 85.33
tensor([[95.9627,  0.0000,  0.0000],
        [81.9876, 85.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.66	Global AF: 13.98
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.0835694563837706e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.6337825536894002e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:2.532473675209701e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.134158210738036e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.278351479174546e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.263841667575321e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 66.15
[Task 2 Finish] Global Accuracy on Task 1: 64.27
[Task 2 Finish] Global Accuracy on Task 2: 86.79
tensor([[95.9627,  0.0000,  0.0000],
        [81.9876, 85.3333,  0.0000],
        [66.1491, 64.2667, 86.7924]], device='cuda:0')
[Task 2 Finish] Global AA: 72.40	Global AF: 25.44
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[I 2025-09-14 23:28:02,301] Trial 59 finished with value: 71.35932922363281 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:7.747686936454556e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.079392213971687e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.083310994358214e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.859612960459117e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.498085875466074e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.270142738351581e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:0.029233457520604134
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.0597219202732617e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:9.514897758577945e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.1937622002022863e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796649689320475
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.200749523901152e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.02
[Task 1 Finish] Global Accuracy on Task 1: 81.60
tensor([[94.4099,  0.0000,  0.0000],
        [77.0186, 81.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.31	Global AF: 17.39
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.0064712658605117e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.1408353151054484e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.0004108723078388721
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.349587522436195e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:0.018517551943659782
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.0402022566100584e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 61.80
[Task 2 Finish] Global Accuracy on Task 1: 68.00
[Task 2 Finish] Global Accuracy on Task 2: 84.28
tensor([[94.4099,  0.0000,  0.0000],
        [77.0186, 81.6000,  0.0000],
        [61.8012, 68.0000, 84.2767]], device='cuda:0')
[Task 2 Finish] Global AA: 71.36	Global AF: 23.10
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378831366309896
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:7.851716499196471e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.646242197063998e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.126563618063074e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.1958757862327047e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.9183253036357826e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.17
tensor([[93.1677,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.17	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.6077431053140856e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.450927126864457e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.966000388684222e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.244541078144096e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:2.0792990940154965e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.0415593094422775e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.85
[Task 1 Finish] Global Accuracy on Task 1: 82.93
tensor([[93.1677,  0.0000,  0.0000],
        [83.8509, 82.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.39	Global AF: 9.32
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:0.028870712965726852
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.882087594777374e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.863426021437192e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.00044972807518206537
[I 2025-09-14 23:30:04,670] Trial 60 finished with value: 63.830440521240234 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.8, 'num_epoch_g': 10}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 23:31:51,697] Trial 61 finished with value: 66.05287170410156 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.420721814810349e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.227096781610044e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 77.64
[Task 2 Finish] Global Accuracy on Task 1: 73.60
[Task 2 Finish] Global Accuracy on Task 2: 40.25
tensor([[93.1677,  0.0000,  0.0000],
        [83.8509, 82.9333,  0.0000],
        [77.6398, 73.6000, 40.2516]], device='cuda:0')
[Task 2 Finish] Global AA: 63.83	Global AF: 12.43
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788306387141347
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.0866789690311407e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.157366283510157e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.236400922927544e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.9426425185441474e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.776868900435716e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:3.8631603471728226e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:9.25100607229723e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.976676376029388e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.548027037782788e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.5786624785185666e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.364921757371576e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.30
[Task 1 Finish] Global Accuracy on Task 1: 76.27
tensor([[94.7205,  0.0000,  0.0000],
        [82.2981, 76.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.28	Global AF: 12.42
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.647992877364175e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:9.93784943226217e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.172055673683616e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.77159276032657e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.2829678430748004e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.1568107289613465e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 79.19
[Task 2 Finish] Global Accuracy on Task 1: 78.40
[Task 2 Finish] Global Accuracy on Task 2: 40.57
tensor([[94.7205,  0.0000,  0.0000],
        [82.2981, 76.2667,  0.0000],
        [79.1926, 78.4000, 40.5660]], device='cuda:0')
[Task 2 Finish] Global AA: 66.05	Global AF: 6.70
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0010369211668148637
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.593755015796063e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:2.825245315474234e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.7749291753309535e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792052120901644
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.424456605065188e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.5724193875607e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.979553436257333e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.292610876812432e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.7849717804405714e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966633681207895
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.662909751182667e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.88
[Task 1 Finish] Global Accuracy on Task 1: 86.67
[I 2025-09-14 23:33:47,240] Trial 62 finished with value: 58.337154388427734 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 23:35:50,628] Trial 63 finished with value: 74.97743225097656 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
tensor([[94.4099,  0.0000,  0.0000],
        [78.8820, 86.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.77	Global AF: 15.53
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.904211646840963e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.0573728559393203e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.732577190720178e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.03872288763523102
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.192512779281458e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.944934573978486e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 43.79
[Task 2 Finish] Global Accuracy on Task 1: 41.60
[Task 2 Finish] Global Accuracy on Task 2: 89.62
tensor([[94.4099,  0.0000,  0.0000],
        [78.8820, 86.6667,  0.0000],
        [43.7888, 41.6000, 89.6226]], device='cuda:0')
[Task 2 Finish] Global AA: 58.34	Global AF: 47.84
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:3.9244002492111463e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.8113006911876255e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.5733772324751953e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.498395627689945e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.2103182900347065e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.015987152885316e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.443033966936241e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.267619118676237e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.643063487134839e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.1447738857437457e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966444506309927
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.529980557332891e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 87.89
[Task 1 Finish] Global Accuracy on Task 1: 78.67
tensor([[94.0994,  0.0000,  0.0000],
        [87.8882, 78.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.28	Global AF: 6.21
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.36167721332248e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.4050186569747325e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.657033423453697e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497271147556603
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.1756057739257812
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.0393192972912857e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 78.88
[Task 2 Finish] Global Accuracy on Task 1: 74.67
[Task 2 Finish] Global Accuracy on Task 2: 71.38
tensor([[94.0994,  0.0000,  0.0000],
        [87.8882, 78.6667,  0.0000],
        [78.8820, 74.6667, 71.3836]], device='cuda:0')
[Task 2 Finish] Global AA: 74.98	Global AF: 9.61
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788272917736322
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.523820845176886e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.780737082934252e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.781493617185163e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.8439006705127667e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.919307821677933e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[I 2025-09-14 23:37:45,400] Trial 64 finished with value: 76.10273742675781 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 23:39:44,180] Trial 65 finished with value: 68.14096069335938 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.0399130445648552e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.714719336109454e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.2245804370536462e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.1707042002484513e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.1023182366898254e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.312476180132421e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.43
[Task 1 Finish] Global Accuracy on Task 1: 76.53
tensor([[95.3416,  0.0000,  0.0000],
        [80.4348, 76.5333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 78.48	Global AF: 14.91
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.957228847528143e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.234009337051759e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.025707395747303963
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.792785612828254e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:0.018517551943659782
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.409832747384826e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 82.30
[Task 2 Finish] Global Accuracy on Task 1: 78.40
[Task 2 Finish] Global Accuracy on Task 2: 67.61
tensor([[95.3416,  0.0000,  0.0000],
        [80.4348, 76.5333,  0.0000],
        [82.2981, 78.4000, 67.6101]], device='cuda:0')
[Task 2 Finish] Global AA: 76.10	Global AF: 5.59
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378826127620414
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:7.969831461451804e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.647114608211325e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.04183314489859e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.747975541035231e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:8.118981598137509e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.7781847105879933e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.507787004255249e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.434054429707345e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.305737710819102e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.026424281299114227
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.7635606308630258e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.30
[Task 1 Finish] Global Accuracy on Task 1: 75.73
tensor([[95.0311,  0.0000,  0.0000],
        [82.2981, 75.7333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.02	Global AF: 12.73
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.208009106778434e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.410246252055771e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:2.89855139889994e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.9105857441157355e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:2.284639699645652e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.236742316507616e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 72.98
[Task 2 Finish] Global Accuracy on Task 1: 75.47
[Task 2 Finish] Global Accuracy on Task 2: 55.97
tensor([[95.0311,  0.0000,  0.0000],
        [82.2981, 75.7333,  0.0000],
        [72.9814, 75.4667, 55.9748]], device='cuda:0')
[Task 2 Finish] Global AA: 68.14	Global AF: 11.16
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788329670205712
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.5129913694985646e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.390224071064267e-10
[I 2025-09-14 23:41:41,437] Trial 66 finished with value: 51.044090270996094 and parameters: {'num_recon_nodes': 1, 'beta': 0.01, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 23:43:36,077] Trial 67 finished with value: 69.19558715820312 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.334433285040461e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.1925377069464957e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.2020306972004846e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.825168042899008e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.1428076807671346e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.5167528051059946e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:8.150235486503732e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:8.84399931067037e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.8739543250489987e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 87.27
[Task 1 Finish] Global Accuracy on Task 1: 77.07
tensor([[94.7205,  0.0000,  0.0000],
        [87.2671, 77.0667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.17	Global AF: 7.45
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.4218133337351446e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.314220732240301e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.668493924775419e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.673249092730259e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.720131507873759e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.504144362511454e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 58.39
[Task 2 Finish] Global Accuracy on Task 1: 53.87
[Task 2 Finish] Global Accuracy on Task 2: 40.88
tensor([[94.7205,  0.0000,  0.0000],
        [87.2671, 77.0667,  0.0000],
        [58.3851, 53.8667, 40.8805]], device='cuda:0')
[Task 2 Finish] Global AA: 51.04	Global AF: 29.77
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788274372927845
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.4516876589709682e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.0625011981346688e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.906531540591288e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:4.91455209861158e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.6276884274322185e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.163038885314108e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.188030200413806e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.586408114930606e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.782716858808271e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796644741669297
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.638136872463065e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.47
[Task 1 Finish] Global Accuracy on Task 1: 84.00
tensor([[94.7205,  0.0000,  0.0000],
        [84.4721, 84.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.24	Global AF: 10.25
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.080778103267903e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.1953462925903295e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.803367869068211e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.127777982112832e-09
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:2.9811939028512313e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.226807154810274e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 69.25
[Task 2 Finish] Global Accuracy on Task 1: 73.87
[Task 2 Finish] Global Accuracy on Task 2: 64.47
tensor([[94.7205,  0.0000,  0.0000],
        [84.4721, 84.0000,  0.0000],
        [69.2547, 73.8667, 64.4654]], device='cuda:0')
[Task 2 Finish] Global AA: 69.20	Global AF: 17.80
--------------------------------------------------
--------------------------------------------------
[I 2025-09-14 23:45:35,934] Trial 68 finished with value: 56.27564239501953 and parameters: {'num_recon_nodes': 1, 'beta': 0.01, 'decay': 0.6000000000000001, 'num_epoch_g': 10}. Best is trial 15 with value: 77.06944274902344.
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788235082756728
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.466430643581873e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.15315842628479
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.927936475025319e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.131999821131103e-07
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.9832223630575925e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.17
tensor([[93.1677,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.17	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.173011629113546e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.1554007530212402
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:2.501448215230795e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.420401125836975e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:3.819278504568757e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.874555841778317e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.99
[Task 1 Finish] Global Accuracy on Task 1: 74.40
tensor([[93.1677,  0.0000,  0.0000],
        [81.9876, 74.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 78.19	Global AF: 11.18
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.108915205973233e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.265836738350572e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.664720997306972e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.70357555524015e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.2146258443479496e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.60877225272327e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 66.46
[Task 2 Finish] Global Accuracy on Task 1: 76.27
[Task 2 Finish] Global Accuracy on Task 2: 26.10
tensor([[93.1677,  0.0000,  0.0000],
        [81.9876, 74.4000,  0.0000],
        [66.4596, 76.2667, 26.1006]], device='cuda:0')
[Task 2 Finish] Global AA: 56.28	Global AF: 12.42
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788242358714342
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.784824203518667e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.15315842628479
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.852350743433931e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.5591696467254224e-07
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.5512403583883838e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.48
tensor([[93.4783,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.48	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.128227842376987e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.4907499940904927e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.1335268541331516e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.286208775740931e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966464878991246
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.215564203795651e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.99
[Task 1 Finish] Global Accuracy on Task 1: 73.87
tensor([[93.4783,  0.0000,  0.0000],
        [81.9876, 73.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 77.93	Global AF: 11.49
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:0.028870712965726852
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:9.150054047779577e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
[I 2025-09-14 23:47:27,053] Trial 69 finished with value: 61.436363220214844 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 5}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 23:49:20,386] Trial 70 finished with value: 65.77915954589844 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
current_loss:9.35184929495847e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:8.542178075998663e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.3030037038805915e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.5403405207468097e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 71.43
[Task 2 Finish] Global Accuracy on Task 1: 72.00
[Task 2 Finish] Global Accuracy on Task 2: 40.88
tensor([[93.4783,  0.0000,  0.0000],
        [81.9876, 73.8667,  0.0000],
        [71.4286, 72.0000, 40.8805]], device='cuda:0')
[Task 2 Finish] Global AA: 61.44	Global AF: 11.96
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:5.874529196425726e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.741773170138572e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.917702828815095e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.179260436667278e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.403666485965687e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:9.158985792012686e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.96
tensor([[95.9627,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.96	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.80359324434221e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.480947362634936e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.317047357955573e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.2634808754796722e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666992343962193
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.978999517708417e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.43
[Task 1 Finish] Global Accuracy on Task 1: 82.13
tensor([[95.9627,  0.0000,  0.0000],
        [80.4348, 82.1333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.28	Global AF: 15.53
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.38672251038497e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.3211775007349047e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.5077930015650054e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.00044972720206715167
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.2163302587353542e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.852586972717063e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 72.67
[Task 2 Finish] Global Accuracy on Task 1: 74.67
[Task 2 Finish] Global Accuracy on Task 2: 50.00
tensor([[95.9627,  0.0000,  0.0000],
        [80.4348, 82.1333,  0.0000],
        [72.6708, 74.6667, 50.0000]], device='cuda:0')
[Task 2 Finish] Global AA: 65.78	Global AF: 15.38
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788363139610738
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.1954763845523075e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.834522947585242e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.8666386214505337e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.0781886494726223e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.5472949577730617e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.434294291286392e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.8212754354939307e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.958097041933399e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.214955689503142e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:7.036255467163244e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.7878463987042181e-10
[I 2025-09-14 23:51:14,670] Trial 71 finished with value: 63.01839828491211 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 23:53:16,752] Trial 72 finished with value: 75.6021728515625 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 86.34
[Task 1 Finish] Global Accuracy on Task 1: 81.33
tensor([[95.3416,  0.0000,  0.0000],
        [86.3354, 81.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.83	Global AF: 9.01
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.148724307486475e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.334096108202459e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.58334442515951e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.3488309347795564e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.4122506497571408e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:0.033466536551713943
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 73.91
[Task 2 Finish] Global Accuracy on Task 1: 66.40
[Task 2 Finish] Global Accuracy on Task 2: 48.74
tensor([[95.3416,  0.0000,  0.0000],
        [86.3354, 81.3333,  0.0000],
        [73.9130, 66.4000, 48.7421]], device='cuda:0')
[Task 2 Finish] Global AA: 63.02	Global AF: 18.18
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378828164888546
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:0.028364455327391624
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.8246362754048562e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.2847478343155387e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.259870872187378e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:0.060132186859846115
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.1562465146729437e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.508460047629285e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.912911437202297e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.2485065465669436e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966464878991246
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:0.04987136647105217
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 76.40
[Task 1 Finish] Global Accuracy on Task 1: 75.73
tensor([[95.0311,  0.0000,  0.0000],
        [76.3975, 75.7333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 76.07	Global AF: 18.63
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.225118865885946e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.891906655428272e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.757199551479573e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.488032971458836e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.379702794350294e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.392152918088811e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 78.88
[Task 2 Finish] Global Accuracy on Task 1: 80.00
[Task 2 Finish] Global Accuracy on Task 2: 67.92
tensor([[95.0311,  0.0000,  0.0000],
        [76.3975, 75.7333,  0.0000],
        [78.8820, 80.0000, 67.9245]], device='cuda:0')
[Task 2 Finish] Global AA: 75.60	Global AF: 5.94
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:4.1435319064753173e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:9.35530097834203e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.040928950985403e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.713981982540361e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792043389752507
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.4348138222561886e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[I 2025-09-14 23:55:13,674] Trial 73 finished with value: 69.44389343261719 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-14 23:57:00,864] Trial 74 finished with value: 60.34858322143555 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.183519393599397e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.4945291932663167e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.12818196293685e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.3029899381677978e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.285325179622987e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.085108055804312e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.88
[Task 1 Finish] Global Accuracy on Task 1: 81.33
tensor([[94.0994,  0.0000,  0.0000],
        [78.8820, 81.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.11	Global AF: 15.22
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.9333281076636695e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.576438448315571e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.264504387980651e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497272602748126
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.837264477863812e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.0194155519727133e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 68.63
[Task 2 Finish] Global Accuracy on Task 1: 68.00
[Task 2 Finish] Global Accuracy on Task 2: 71.70
tensor([[94.0994,  0.0000,  0.0000],
        [78.8820, 81.3333,  0.0000],
        [68.6335, 68.0000, 71.6981]], device='cuda:0')
[Task 2 Finish] Global AA: 69.44	Global AF: 19.40
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:4.639112427540226e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.475129876726271e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.1811213118662067e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.255533148089796e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.02327685058116913
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.841483909803543e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.141955525926448e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.784006607001402e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.165876142993909e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:2.4927118702500195e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966491072438657
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.194358914690667e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.12
[Task 1 Finish] Global Accuracy on Task 1: 78.40
tensor([[95.3416,  0.0000,  0.0000],
        [80.1242, 78.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.26	Global AF: 15.22
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:2.4392959874219855e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.95634311370452e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.483300007964488e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.395421331932937e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.894644217185885e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.292785181827298e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 51.86
[Task 2 Finish] Global Accuracy on Task 1: 60.00
[Task 2 Finish] Global Accuracy on Task 2: 69.18
tensor([[95.3416,  0.0000,  0.0000],
        [80.1242, 78.4000,  0.0000],
        [51.8634, 60.0000, 69.1824]], device='cuda:0')
[Task 2 Finish] Global AA: 60.35	Global AF: 30.94
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378825108986348
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.150602639363399e-10
[I 2025-09-14 23:58:53,641] Trial 75 finished with value: 71.51205444335938 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.5, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.446910534776748e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.2352492906895236e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:4.2064576821765343e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.756777194359074e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.173782848695737e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.0335856615029115e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.714000077070239e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.610255121053399e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:7.826128634036422e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.565745890365406e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.26
[Task 1 Finish] Global Accuracy on Task 1: 78.40
tensor([[95.0311,  0.0000,  0.0000],
        [78.2609, 78.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 78.33	Global AF: 16.77
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.2998689891705624e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.605141599282717e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.5386950602547245e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.2350758193946376e-09
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.2648083691502165e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.5943175385734207e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 63.98
[Task 2 Finish] Global Accuracy on Task 1: 68.80
[Task 2 Finish] Global Accuracy on Task 2: 81.76
tensor([[95.0311,  0.0000,  0.0000],
        [78.2609, 78.4000,  0.0000],
        [63.9752, 68.8000, 81.7610]], device='cuda:0')
[Task 2 Finish] Global AA: 71.51	Global AF: 20.33
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788296200800687
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.3959547113558983e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.219639885924778e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.40441314028439e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.8639769162074344e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:9.380646259771197e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.48
tensor([[93.4783,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.48	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.596005325791964e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.59231233438129e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.249911061433465e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:0.061206117272377014
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.002666698768734932
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:9.287974833682711e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.47
[Task 1 Finish] Global Accuracy on Task 1: 78.93
tensor([[93.4783,  0.0000,  0.0000],
        [84.4721, 78.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.70	Global AF: 9.01
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.1922839104894223e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.0796179505945247e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.025707395747303963
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.060623114478858e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.2874575284225216e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:9.944477463719181e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 77.95
[Task 2 Finish] Global Accuracy on Task 1: 69.87
[Task 2 Finish] Global Accuracy on Task 2: 41.51
tensor([[93.4783,  0.0000,  0.0000],
        [84.4721, 78.9333,  0.0000],
        [77.9503, 69.8667, 41.5094]], device='cuda:0')
[I 2025-09-15 00:00:41,856] Trial 76 finished with value: 63.10880661010742 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-15 00:02:35,495] Trial 77 finished with value: 57.4580078125 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.6000000000000001, 'num_epoch_g': 10}. Best is trial 15 with value: 77.06944274902344.
[Task 2 Finish] Global AA: 63.11	Global AF: 12.30
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788322394248098
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:8.312705523927377e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.307537187526634e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.3453269609442486e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792078314349055
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.6016337962306864e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.182481359142457e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.36134489634199e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:9.60644785941156e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:0.06120007857680321
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:3.858669495038214e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:2.4184201863342025e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 87.89
[Task 1 Finish] Global Accuracy on Task 1: 72.27
tensor([[94.4099,  0.0000,  0.0000],
        [87.8882, 72.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.08	Global AF: 6.52
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.166459092822208e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.1248290077148226e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.176837930027546e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.00044972749310545623
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.0648501231643763e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.971738659127368e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 75.47
[Task 2 Finish] Global Accuracy on Task 1: 57.60
[Task 2 Finish] Global Accuracy on Task 2: 39.31
tensor([[94.4099,  0.0000,  0.0000],
        [87.8882, 72.2667,  0.0000],
        [75.4658, 57.6000, 39.3082]], device='cuda:0')
[Task 2 Finish] Global AA: 57.46	Global AF: 16.81
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788296200800687
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.4556454919787427e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:2.3812771199338556e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.5207770860145047e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.887007548111001e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.6303270672656254e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.614211400801651e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.277435958881085e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.730579344387365e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.937424913364907e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.6563715676820578e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.306576372239192e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 73.60
[Task 1 Finish] Global Accuracy on Task 1: 82.93
tensor([[93.7888,  0.0000,  0.0000],
        [73.6025, 82.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 78.27	Global AF: 20.19
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.0669942413806837e-10
[I 2025-09-15 00:04:20,681] Trial 78 finished with value: 69.57221221923828 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-15 00:06:12,608] Trial 79 finished with value: 72.4996566772461 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.557797113527215e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.712567889368472e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:9.970717584906197e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.1756057739257812
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.3046410880265285e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 59.63
[Task 2 Finish] Global Accuracy on Task 1: 59.47
[Task 2 Finish] Global Accuracy on Task 2: 89.62
tensor([[93.7888,  0.0000,  0.0000],
        [73.6025, 82.9333,  0.0000],
        [59.6273, 59.4667, 89.6226]], device='cuda:0')
[Task 2 Finish] Global AA: 69.57	Global AF: 28.81
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788316573482007
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.531511360068464e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.077483628517342e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.243513596069448e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.598266739070823e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.34676358743269e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.954642889882678e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.483893534246164e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.297678962179475e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.5217266042563153e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796643577516079
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.5248474411785367e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.78
[Task 1 Finish] Global Accuracy on Task 1: 80.53
tensor([[94.7205,  0.0000,  0.0000],
        [84.7826, 80.5333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.66	Global AF: 9.94
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.774207306214919e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:0.02285819873213768
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.025707395747303963
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.888983189983321e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.526614638677984e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.1681573486299612e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 68.63
[Task 2 Finish] Global Accuracy on Task 1: 67.73
[Task 2 Finish] Global Accuracy on Task 2: 81.13
tensor([[94.7205,  0.0000,  0.0000],
        [84.7826, 80.5333,  0.0000],
        [68.6335, 67.7333, 81.1321]], device='cuda:0')
[Task 2 Finish] Global AA: 72.50	Global AF: 19.44
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0010369211668148637
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:9.214906615540031e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.5148002852072295e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.190973206836702e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.463414886110797e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.83430415090902e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.269736007093798e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.174545709112465e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.374392597623512e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.695568792267295e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
[I 2025-09-15 00:07:58,612] Trial 80 finished with value: 76.10722351074219 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-15 00:09:40,815] Trial 81 finished with value: 65.60932922363281 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
current_loss:0.026424281299114227
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.940380102906431e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.12
[Task 1 Finish] Global Accuracy on Task 1: 74.93
tensor([[95.6522,  0.0000,  0.0000],
        [80.1242, 74.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 77.53	Global AF: 15.53
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.166551630964022e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.908066341182462e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.834209781951927e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.309322508890602e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.245620214924031e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.788801967135157e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 71.43
[Task 2 Finish] Global Accuracy on Task 1: 77.33
[Task 2 Finish] Global Accuracy on Task 2: 79.56
tensor([[95.6522,  0.0000,  0.0000],
        [80.1242, 74.9333,  0.0000],
        [71.4286, 77.3333, 79.5597]], device='cuda:0')
[Task 2 Finish] Global AA: 76.11	Global AF: 10.91
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0010369212832301855
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.3089916917639073e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.610050367645727e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.2555447787286909e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.995021259304508e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.0626320096361894e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.193369705975726e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.7840633938564e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.990014429966493e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.08984401900625e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:3.861864161791573e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.566381717197032e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.54
[Task 1 Finish] Global Accuracy on Task 1: 82.67
tensor([[94.7205,  0.0000,  0.0000],
        [83.5404, 82.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.10	Global AF: 11.18
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.841113396940159e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.813634184117291e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.534177560662101e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.873477425590636e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.215196802714871e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.443619414766346e-11
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 63.98
[Task 2 Finish] Global Accuracy on Task 1: 57.07
[Task 2 Finish] Global Accuracy on Task 2: 75.79
tensor([[94.7205,  0.0000,  0.0000],
        [83.5404, 82.6667,  0.0000],
        [63.9752, 57.0667, 75.7862]], device='cuda:0')
[Task 2 Finish] Global AA: 65.61	Global AF: 28.17
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788341311737895
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:8.750303814863969e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.240802820021372e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.516546026067658e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792031748220325
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.1484891643552828e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
[I 2025-09-15 00:11:30,355] Trial 82 finished with value: 70.80961608886719 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-15 00:13:22,720] Trial 83 finished with value: 59.72966003417969 and parameters: {'num_recon_nodes': 1, 'beta': 0.01, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.066461139513478e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.09134801090849e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.344565594065045e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.890649800224026e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966432864777744
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.187703765509923e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.68
[Task 1 Finish] Global Accuracy on Task 1: 77.60
tensor([[95.0311,  0.0000,  0.0000],
        [81.6770, 77.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.64	Global AF: 13.35
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.433970271643943e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.249580935564381e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.618001536726979e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.00044972749310545623
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.157186013678313e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.231031246528573e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 76.71
[Task 2 Finish] Global Accuracy on Task 1: 74.40
[Task 2 Finish] Global Accuracy on Task 2: 61.32
tensor([[95.0311,  0.0000,  0.0000],
        [81.6770, 77.6000,  0.0000],
        [76.7081, 74.4000, 61.3208]], device='cuda:0')
[Task 2 Finish] Global AA: 70.81	Global AF: 10.76
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.4738662512669976e-09
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:7.640955090870705e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:2.9107577459441814e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.113233808058283e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:4.1478976697817416e-08
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.696696530639201e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.4182116309390267e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.635406278933999e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:0.04348265007138252
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.805446761681821e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:8.652646932283403e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.445171701370157e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 85.40
[Task 1 Finish] Global Accuracy on Task 1: 77.33
tensor([[95.6522,  0.0000,  0.0000],
        [85.4037, 77.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.37	Global AF: 10.25
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.60920382258945e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.6067091807877603e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.934026715501915e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:8.033737564083765e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.2710124326106325e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.302733335239452e-11
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 69.88
[Task 2 Finish] Global Accuracy on Task 1: 77.87
[Task 2 Finish] Global Accuracy on Task 2: 31.45
tensor([[95.6522,  0.0000,  0.0000],
        [85.4037, 77.3333,  0.0000],
        [69.8758, 77.8667, 31.4465]], device='cuda:0')
[Task 2 Finish] Global AA: 59.73	Global AF: 12.62
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[I 2025-09-15 00:15:17,709] Trial 84 finished with value: 61.1307487487793 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788312207907438
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.231998557673421e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.011600578974651e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.0243392779592e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.1294181145871107e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.6255776724705129e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.642741746607726e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.933952939076505e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.08285766306804e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:2.4023480982293677e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:4.874435854951287e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.0119568516486765e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 85.09
[Task 1 Finish] Global Accuracy on Task 1: 78.67
tensor([[94.0994,  0.0000,  0.0000],
        [85.0932, 78.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.88	Global AF: 9.01
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.698689380968403e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.742276264544046e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.944063491940653e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.451265077700441e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.968232574815602e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.909962684848892e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 59.32
[Task 2 Finish] Global Accuracy on Task 1: 58.67
[Task 2 Finish] Global Accuracy on Task 2: 65.41
tensor([[94.0994,  0.0000,  0.0000],
        [85.0932, 78.6667,  0.0000],
        [59.3168, 58.6667, 65.4088]], device='cuda:0')
[Task 2 Finish] Global AA: 61.13	Global AF: 27.39
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788296200800687
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:7.71446628800021e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.553932562271882e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:9.345147988781832e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.124941695351822e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.1797004484392914e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.890274851732102e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.4018898809051734e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.2095736265182495
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.114880906655685e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:9.459681926671237e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.904504662979093e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 85.40
[Task 1 Finish] Global Accuracy on Task 1: 77.07
tensor([[94.7205,  0.0000,  0.0000],
        [85.4037, 77.0667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.24	Global AF: 9.32
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.179088352098461e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.802973267523328e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.5846881846500764e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.887784786968609e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.3800176546527894e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.172092754079927e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.[I 2025-09-15 00:17:13,944] Trial 85 finished with value: 67.68489074707031 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-15 00:19:14,670] Trial 86 finished with value: 72.03819274902344 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.

[Task 2 Finish] Global Accuracy on Task 0: 75.16
[Task 2 Finish] Global Accuracy on Task 1: 70.67
[Task 2 Finish] Global Accuracy on Task 2: 57.23
tensor([[94.7205,  0.0000,  0.0000],
        [85.4037, 77.0667,  0.0000],
        [75.1553, 70.6667, 57.2327]], device='cuda:0')
[Task 2 Finish] Global AA: 67.68	Global AF: 12.98
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:6.086181003617241e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.395984770117934e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.73370081916147e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.457570034257287e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.288277038495437e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.0125806859662134e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.765514342672475e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.161495923530993e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.460692701994788e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.856124474235003e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:2.163255796716612e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.659052588174006e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.85
[Task 1 Finish] Global Accuracy on Task 1: 78.40
tensor([[94.0994,  0.0000,  0.0000],
        [83.8509, 78.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.13	Global AF: 10.25
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.192120735460378e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:2.157415579517874e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.92006563163261e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.418361315179254e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.91963328250489e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.202592913087443e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 73.29
[Task 2 Finish] Global Accuracy on Task 1: 69.87
[Task 2 Finish] Global Accuracy on Task 2: 72.96
tensor([[94.0994,  0.0000,  0.0000],
        [83.8509, 78.4000,  0.0000],
        [73.2919, 69.8667, 72.9560]], device='cuda:0')
[Task 2 Finish] Global AA: 72.04	Global AF: 14.67
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378826709697023
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:9.726900396245242e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.345053454343997e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.4681862937091523e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792046300135553
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.856716166543265e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.035721479223042e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.133595381070279e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.551561598262424e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.12511533212745e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966432864777744
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.782626765262535e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.92
[Task 1 Finish] Global Accuracy on Task 1: 80.53
tensor([[95.6522,  0.0000,  0.0000],
        [82.9193, 80.5333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.73	Global AF: 12.73
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[I 2025-09-15 00:21:12,456] Trial 87 finished with value: 68.5886001586914 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-15 00:23:07,899] Trial 88 finished with value: 55.010372161865234 and parameters: {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.5, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.711230460254569e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:2.463649839690163e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.4186350982825502e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.4443981828123924e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.461506997177622e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.596399537706077e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 77.02
[Task 2 Finish] Global Accuracy on Task 1: 71.20
[Task 2 Finish] Global Accuracy on Task 2: 57.55
tensor([[95.6522,  0.0000,  0.0000],
        [82.9193, 80.5333,  0.0000],
        [77.0186, 71.2000, 57.5472]], device='cuda:0')
[Task 2 Finish] Global AA: 68.59	Global AF: 13.98
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:5.734276942170879e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.318314760278554e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.323351676660536e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:9.819144386469247e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.1446277259352655e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.592488528880722e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.7145578290467256e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.4476184140299608e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.55901191956076e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.693073872909849e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666990015655756
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.56663287582171e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.61
[Task 1 Finish] Global Accuracy on Task 1: 79.47
tensor([[95.0311,  0.0000,  0.0000],
        [82.6087, 79.4667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.04	Global AF: 12.42
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.210155888477288e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.0484011436773244e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.4158679490813313e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.774735217263128e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.374832245941263e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.818692029255999e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 47.83
[Task 2 Finish] Global Accuracy on Task 1: 25.07
[Task 2 Finish] Global Accuracy on Task 2: 92.14
tensor([[95.0311,  0.0000,  0.0000],
        [82.6087, 79.4667,  0.0000],
        [47.8261, 25.0667, 92.1384]], device='cuda:0')
[Task 2 Finish] Global AA: 55.01	Global AF: 50.80
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378829765599221
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.985094671448252e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.0156976371078485e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.2187798548168871e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979205503128469
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.0847869269525745e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.903848603911911e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.197737630245001e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
[I 2025-09-15 00:25:01,701] Trial 89 finished with value: 72.1397705078125 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-15 00:26:57,310] Trial 90 finished with value: 62.670188903808594 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.7000000000000001, 'num_epoch_g': 10}. Best is trial 15 with value: 77.06944274902344.
current_loss:7.35766336745769e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.070202922067949e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966453237459064
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.3628167745168867e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.23
[Task 1 Finish] Global Accuracy on Task 1: 81.60
tensor([[93.7888,  0.0000,  0.0000],
        [83.2298, 81.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.41	Global AF: 10.56
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.2122792769631019e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.514689455614729e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.085664915391533e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.613354780997781e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.9462206552775e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.03712096875131e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 63.66
[Task 2 Finish] Global Accuracy on Task 1: 65.33
[Task 2 Finish] Global Accuracy on Task 2: 87.42
tensor([[93.7888,  0.0000,  0.0000],
        [83.2298, 81.6000,  0.0000],
        [63.6646, 65.3333, 87.4214]], device='cuda:0')
[Task 2 Finish] Global AA: 72.14	Global AF: 23.20
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788254000246525
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.5571732792096782e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.3076552063395752e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:9.091705721608889e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:4.0717038074511436e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.040975969983208e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 92.24
tensor([[92.2360,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 92.24	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.5690429217870587e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.144572463005147e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.665848346048108e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.695650617809633e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.5776563389025e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.883648125313499e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.75
[Task 1 Finish] Global Accuracy on Task 1: 82.93
tensor([[92.2360,  0.0000,  0.0000],
        [80.7453, 82.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.84	Global AF: 11.49
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.2269753217697144
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.229793820227258e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.0966898500441857e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.929258195536136e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.246927672227116e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:9.605892747899247e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 72.36
[Task 2 Finish] Global Accuracy on Task 1: 77.60
[Task 2 Finish] Global Accuracy on Task 2: 38.05
tensor([[92.2360,  0.0000,  0.0000],
        [80.7453, 82.9333,  0.0000],
        [72.3603, 77.6000, 38.0503]], device='cuda:0')
[Task 2 Finish] Global AA: 62.67	Global AF: 12.60
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378824672428891
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.0456417943192093e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.938103814744466e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:9.761962349585929e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792057941667736
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.688295502346506e-11
[I 2025-09-15 00:28:54,997] Trial 91 finished with value: 71.2286148071289 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.5, 'num_epoch_g': 5}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-15 00:30:46,951] Trial 92 finished with value: 62.63821029663086 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.5, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.884219778096167e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.1656691157344596e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:0.00020711963588837534
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.5909306084214165e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.002666698768734932
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.1990535231376498e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.02
[Task 1 Finish] Global Accuracy on Task 1: 88.00
tensor([[94.0994,  0.0000,  0.0000],
        [77.0186, 88.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.51	Global AF: 17.08
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.179771387479718e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:0.0016131977317854762
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:2.3326063303130695e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:9.202427708743244e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.966248995901367e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.016409675486557e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 75.78
[Task 2 Finish] Global Accuracy on Task 1: 79.73
[Task 2 Finish] Global Accuracy on Task 2: 58.18
tensor([[94.0994,  0.0000,  0.0000],
        [77.0186, 88.0000,  0.0000],
        [75.7764, 79.7333, 58.1761]], device='cuda:0')
[Task 2 Finish] Global AA: 71.23	Global AF: 13.29
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788286014460027
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.682042726271817e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.853327822435972e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.8858991024959266e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.065124596472572e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:0.060132186859846115
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 92.24
tensor([[92.2360,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 92.24	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.875030627602086e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.590960555108438e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.919457146674745e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.5284623566813593e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966546369716525
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.321296736582326e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 75.16
[Task 1 Finish] Global Accuracy on Task 1: 80.53
tensor([[92.2360,  0.0000,  0.0000],
        [75.1553, 80.5333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 77.84	Global AF: 17.08
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.083206964355384e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.972445481563284e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.2169948089032516e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497273766901344
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:9.32516397433858e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.310667850975335e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 70.19
[Task 2 Finish] Global Accuracy on Task 1: 76.53
[Task 2 Finish] Global Accuracy on Task 2: 41.19
tensor([[92.2360,  0.0000,  0.0000],
        [75.1553, 80.5333,  0.0000],
        [70.1863, 76.5333, 41.1950]], device='cuda:0')
[Task 2 Finish] Global AA: 62.64	Global AF: 13.02
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[I 2025-09-15 00:33:03,797] Trial 93 finished with value: 74.49539184570312 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788242358714342
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:8.673474161113859e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.904644385599454e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:9.16279385698715e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.8326674339496094e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.911011762866792e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.48
tensor([[93.4783,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.48	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.465137231652761e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.8502296361688764e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.265766239188508e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.631684090763201e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:2.8657226591732865e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.30870744533496e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 87.27
[Task 1 Finish] Global Accuracy on Task 1: 82.93
tensor([[93.4783,  0.0000,  0.0000],
        [87.2671, 82.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 85.10	Global AF: 6.21
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.4685741511755168e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.898793841221163e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.0284669782478773e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.8836786564466763e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.1873723115840562e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.3731146220052892e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 72.05
[Task 2 Finish] Global Accuracy on Task 1: 70.93
[Task 2 Finish] Global Accuracy on Task 2: 80.50
tensor([[93.4783,  0.0000,  0.0000],
        [87.2671, 82.9333,  0.0000],
        [72.0497, 70.9333, 80.5031]], device='cuda:0')
[Task 2 Finish] Global AA: 74.50	Global AF: 16.71
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788316573482007
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.926516251555711e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.578298461512588e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.2331929921671758e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:4.350993731971897e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:8.067295165226085e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.676452168896674e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.547842297724202e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.638932099039096e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.2072599586687716e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796649689320475
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.2317730169186802e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.57
[Task 1 Finish] Global Accuracy on Task 1: 86.67
tensor([[95.3416,  0.0000,  0.0000],
        [78.5714, 86.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.62	Global AF: 16.77
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.112279045591748e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.0892381441252041e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.742729235538093e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.1789555998120704e-09
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.228893594835029e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
[I 2025-09-15 00:34:53,666] Trial 94 finished with value: 71.24176788330078 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-15 00:36:34,960] Trial 95 finished with value: 70.99639892578125 and parameters: {'num_recon_nodes': 3, 'beta': 0.05, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
current_loss:1.1343801021575928
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 65.84
[Task 2 Finish] Global Accuracy on Task 1: 62.67
[Task 2 Finish] Global Accuracy on Task 2: 85.22
tensor([[95.3416,  0.0000,  0.0000],
        [78.5714, 86.6667,  0.0000],
        [65.8385, 62.6667, 85.2201]], device='cuda:0')
[Task 2 Finish] Global AA: 71.24	Global AF: 26.75
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.01740207150578499
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:0.028213825076818466
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.822738874921129e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:8.202566958992463e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.487968413042665e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.567255628198154e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.69308997324913e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.477187757842785e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.361175392515349e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.050711350205404e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666990015655756
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.234486567471606e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.33
[Task 1 Finish] Global Accuracy on Task 1: 89.33
tensor([[93.7888,  0.0000,  0.0000],
        [77.3292, 89.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.33	Global AF: 16.46
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.348548606117106e-09
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.0745698775238566e-09
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.4523937608146298e-09
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.03872288763523102
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.319760022435503e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.616254376647703e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 72.36
[Task 2 Finish] Global Accuracy on Task 1: 73.33
[Task 2 Finish] Global Accuracy on Task 2: 67.30
tensor([[93.7888,  0.0000,  0.0000],
        [77.3292, 89.3333,  0.0000],
        [72.3603, 73.3333, 67.2956]], device='cuda:0')
[Task 2 Finish] Global AA: 71.00	Global AF: 18.71
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.173619031906128
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.709773960773987e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.345993647765113e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.334284680635903e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.162849261326926e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.899675747933486e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.238761977670151e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.417316624647725e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.343342907553449e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.858483143050819e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:8.093210546178398e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.639232107476857e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 85.40
[Task 1 Finish] Global Accuracy on Task 1: 84.27
tensor([[95.3416,  0.0000,  0.0000],
        [85.4037, 84.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.84	Global AF: 9.94
--------------------------------------------------
[I 2025-09-15 00:38:33,595] Trial 96 finished with value: 73.02113342285156 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-15 00:40:28,817] Trial 97 finished with value: 75.8421859741211 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.871424623218104e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.0384116899686546e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.1514751374619436e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.314142459411642e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.0879940282038092e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.040063839028107e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 66.46
[Task 2 Finish] Global Accuracy on Task 1: 62.67
[Task 2 Finish] Global Accuracy on Task 2: 89.94
tensor([[95.3416,  0.0000,  0.0000],
        [85.4037, 84.2667,  0.0000],
        [66.4596, 62.6667, 89.9371]], device='cuda:0')
[Task 2 Finish] Global AA: 73.02	Global AF: 25.24
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788237993139774
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:9.42467992537388e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.69206748507267e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.799248941646852e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.975073216087253e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.350260652761449e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.791221639548041e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.0419269880788136e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.966303562310316e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:8.861891220846019e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0261098500341177
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.31973512515782e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 87.58
[Task 1 Finish] Global Accuracy on Task 1: 77.33
tensor([[95.0311,  0.0000,  0.0000],
        [87.5776, 77.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.46	Global AF: 7.45
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.4146095406175618e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:2.951233701864453e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.568549675873726e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.954535198249289e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.306369900091255e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.571986926357965e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 77.64
[Task 2 Finish] Global Accuracy on Task 1: 81.33
[Task 2 Finish] Global Accuracy on Task 2: 68.55
tensor([[95.0311,  0.0000,  0.0000],
        [87.5776, 77.3333,  0.0000],
        [77.6398, 81.3333, 68.5535]], device='cuda:0')
[Task 2 Finish] Global AA: 75.84	Global AF: 6.70
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:6.993070011951374e-10
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.4861644127026636e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:0.04181229695677757
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.1362580876195238e-09
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:9.320407778901085e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.817342246279168e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:3.035224016567639e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.743496346242381e-10
[I 2025-09-15 00:42:14,942] Trial 98 finished with value: 65.20814514160156 and parameters: {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-15 00:44:06,246] Trial 99 finished with value: 75.12462615966797 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:0.041359443217515945
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.559874003528535e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:5.523890789227437e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.960599236409792e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 72.67
[Task 1 Finish] Global Accuracy on Task 1: 87.47
tensor([[93.7888,  0.0000,  0.0000],
        [72.6708, 87.4667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.07	Global AF: 21.12
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:0.040998924523591995
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.0451911558462257e-09
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.0269578510377926e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.18495929419305e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.911420159459112e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.812569869867446e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 54.66
[Task 2 Finish] Global Accuracy on Task 1: 50.40
[Task 2 Finish] Global Accuracy on Task 2: 90.57
tensor([[93.7888,  0.0000,  0.0000],
        [72.6708, 87.4667,  0.0000],
        [54.6584, 50.4000, 90.5660]], device='cuda:0')
[Task 2 Finish] Global AA: 65.21	Global AF: 38.10
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788319483865052
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.375802580864786e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.044537093075064e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.720713347479034e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.130388501863649e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.3268841287691373e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.6169042771352338e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:9.68626623354396e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.710667411700342e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.3192879011469927e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.026424281299114227
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.536019586140696e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 86.02
[Task 1 Finish] Global Accuracy on Task 1: 82.13
tensor([[94.4099,  0.0000,  0.0000],
        [86.0248, 82.1333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.08	Global AF: 8.39
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.753409191404216e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:2.874082360992958e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.0687477569604198e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.974800016377401e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.423088727558479e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:9.517260313174347e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 75.78
[Task 2 Finish] Global Accuracy on Task 1: 70.67
[Task 2 Finish] Global Accuracy on Task 2: 78.93
tensor([[94.4099,  0.0000,  0.0000],
        [86.0248, 82.1333,  0.0000],
        [75.7764, 70.6667, 78.9308]], device='cuda:0')
[Task 2 Finish] Global AA: 75.12	Global AF: 15.05
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:4.5974024587280837e-10
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:8.579281729481636e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.159896068081423e-09
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:9.754187457744479e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.4571619466607899e-08
[I 2025-09-15 00:46:06,040] Trial 100 finished with value: 57.727718353271484 and parameters: {'num_recon_nodes': 3, 'beta': 0.02, 'decay': 0.9, 'num_epoch_g': 10}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-15 00:47:56,781] Trial 101 finished with value: 62.97697448730469 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:0.060132186859846115
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 90.37
tensor([[90.3727,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 90.37	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:3.691693339913371e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.1146865652733595e-09
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.782160943963333e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.690522663139632e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966485251672566
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.58615090348502e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 41.93
[Task 1 Finish] Global Accuracy on Task 1: 70.13
tensor([[90.3727,  0.0000,  0.0000],
        [41.9255, 70.1333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 56.03	Global AF: 48.45
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:2.4677966337094404e-09
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.0132353844838349e-09
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.674465035163337e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.940856305843624e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.583165708587188e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.79744815990091e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 71.74
[Task 2 Finish] Global Accuracy on Task 1: 74.40
[Task 2 Finish] Global Accuracy on Task 2: 27.04
tensor([[90.3727,  0.0000,  0.0000],
        [41.9255, 70.1333,  0.0000],
        [71.7391, 74.4000, 27.0440]], device='cuda:0')
[Task 2 Finish] Global AA: 57.73	Global AF: 7.18
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:6.648086525729013e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:0.00038310419768095016
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.586939965165129e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.3971820629096214e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.4062889741595086e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.086622955121413e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.6628026733300771e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.121450958294304e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:0.000207119868719019
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:8.077860047528418e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.5475077219662126e-08
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.211822085016138e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 87.27
[Task 1 Finish] Global Accuracy on Task 1: 77.87
tensor([[95.3416,  0.0000,  0.0000],
        [87.2671, 77.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.57	Global AF: 8.07
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.4143998739466497e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.1110395936597683e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.094776515754631e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.669130330789642e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.758353238682901e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.022044695188413e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 67.39
[Task 2 Finish] Global Accuracy on Task 1: 60.53
[Task 2 Finish] Global Accuracy on Task 2: 61.01
tensor([[95.3416,  0.0000,  0.0000],
        [87.2671, 77.8667,  0.0000],
        [67.3913, 60.5333, 61.0063]], device='cuda:0')
[Task 2 Finish] Global AA: 62.98	Global AF: 22.64
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[I 2025-09-15 00:49:48,815] Trial 102 finished with value: 71.85820770263672 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.01740207150578499
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.167983930740803e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:0.04181229695677757
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.848537682455856e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.291347443010409e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.788795943648893e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.102540777736976e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.4130575598514383e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.988462615733823e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.1067741167991585e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026667085476219654
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.726552010365538e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 87.58
[Task 1 Finish] Global Accuracy on Task 1: 84.27
tensor([[95.0311,  0.0000,  0.0000],
        [87.5776, 84.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 85.92	Global AF: 7.45
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.7475544344947025e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.200361807844445e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.0012121323961764574
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.03872288763523102
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.830635667145259e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.4373497664598176e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 77.02
[Task 2 Finish] Global Accuracy on Task 1: 65.60
[Task 2 Finish] Global Accuracy on Task 2: 72.96
tensor([[95.0311,  0.0000,  0.0000],
        [87.5776, 84.2667,  0.0000],
        [77.0186, 65.6000, 72.9560]], device='cuda:0')
[Task 2 Finish] Global AA: 71.86	Global AF: 18.34
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788350042887032
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:0.028364455327391624
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.771403437966228e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.861130080222267e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979208704549819
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.5985543151161323e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 96.27
tensor([[96.2733,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 96.27	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.315201777657876e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:9.517465704433903e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.715943912105615e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.11294495841463e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796644741669297
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:2.7386101719706346e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.02
[Task 1 Finish] Global Accuracy on Task 1: 90.13
tensor([[96.2733,  0.0000,  0.0000],
        [77.0186, 90.1333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.58	Global AF: 19.25
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.603980612889359e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.1641804187334515e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.3765013835184163e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.104663275938947e-10
[I 2025-09-15 00:51:47,846] Trial 103 finished with value: 71.78932189941406 and parameters: {'num_recon_nodes': 1, 'beta': 0.08, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 15 with value: 77.06944274902344.
[I 2025-09-15 00:53:35,051] Trial 104 finished with value: 78.39065551757812 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 104 with value: 78.39065551757812.
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.589763817428263e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:0.033466536551713943
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 60.25
[Task 2 Finish] Global Accuracy on Task 1: 62.67
[Task 2 Finish] Global Accuracy on Task 2: 92.45
tensor([[96.2733,  0.0000,  0.0000],
        [77.0186, 90.1333,  0.0000],
        [60.2484, 62.6667, 92.4528]], device='cuda:0')
[Task 2 Finish] Global AA: 71.79	Global AF: 31.75
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:9.620571006507816e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:7.606616447830561e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.6166381566762311e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.2734904242250877e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.8927889417218466e-08
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.883016379077844e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.700108801105387e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.125391388029811e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.705446670667413e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.123454521222982e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.654159031971858e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.912864004502637e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 76.71
[Task 1 Finish] Global Accuracy on Task 1: 82.93
tensor([[94.4099,  0.0000,  0.0000],
        [76.7081, 82.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.82	Global AF: 17.70
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.140918026720783e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.46080863756049e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.026850299909710884
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.0127116922831192e-09
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.1756057739257812
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.0406958628195184e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 71.43
[Task 2 Finish] Global Accuracy on Task 1: 79.47
[Task 2 Finish] Global Accuracy on Task 2: 84.28
tensor([[94.4099,  0.0000,  0.0000],
        [76.7081, 82.9333,  0.0000],
        [71.4286, 79.4667, 84.2767]], device='cuda:0')
[Task 2 Finish] Global AA: 78.39	Global AF: 13.22
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788351498078555
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.334476194107651e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.5497363382042124e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.397367635635476e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.3017644739932166e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.690911465348279e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.84557172164557e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.6901577893953e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:9.012545154618579e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.117229748945022e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00266669993288815
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.899085776470912e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 86.34
[Task 1 Finish] Global Accuracy on Task 1: 83.20
[I 2025-09-15 00:55:26,064] Trial 105 finished with value: 69.7887191772461 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 104 with value: 78.39065551757812.
[I 2025-09-15 00:57:12,758] Trial 106 finished with value: 66.66484069824219 and parameters: {'num_recon_nodes': 1, 'beta': 0.06999999999999999, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 104 with value: 78.39065551757812.
tensor([[95.0311,  0.0000,  0.0000],
        [86.3354, 83.2000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.77	Global AF: 8.70
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.172112265723229e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:0.02285819873213768
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.401974340595416e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497271729633212
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.113404146657615e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.912444922013705e-11
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 67.39
[Task 2 Finish] Global Accuracy on Task 1: 69.33
[Task 2 Finish] Global Accuracy on Task 2: 72.64
tensor([[95.0311,  0.0000,  0.0000],
        [86.3354, 83.2000,  0.0000],
        [67.3913, 69.3333, 72.6415]], device='cuda:0')
[Task 2 Finish] Global AA: 69.79	Global AF: 20.75
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788283104076982
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.26412025081413e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.820911223672567e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.298531170425889e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.535006342149984e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.276841546526413e-11
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.560849227644212e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.9587522149275856e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.7471839520186734e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.0172196418523072e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.002666699467226863
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.5284730692808353e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 71.74
[Task 1 Finish] Global Accuracy on Task 1: 90.67
tensor([[95.0311,  0.0000,  0.0000],
        [71.7391, 90.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.20	Global AF: 23.29
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.0177807485689527e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.338665868912187e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:9.074263007669003e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.00044972842442803085
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.823374560343098e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.131179594437981e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 54.04
[Task 2 Finish] Global Accuracy on Task 1: 54.13
[Task 2 Finish] Global Accuracy on Task 2: 91.82
tensor([[95.0311,  0.0000,  0.0000],
        [71.7391, 90.6667,  0.0000],
        [54.0373, 54.1333, 91.8239]], device='cuda:0')
[Task 2 Finish] Global AA: 66.66	Global AF: 38.76
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788255455438048
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:0.00038310536183416843
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.15294998179894e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.412363724919487e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792052120901644
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.199948804879284e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[I 2025-09-15 00:59:05,108] Trial 107 finished with value: 67.81950378417969 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 104 with value: 78.39065551757812.
[I 2025-09-15 01:00:55,645] Trial 108 finished with value: 68.18366241455078 and parameters: {'num_recon_nodes': 3, 'beta': 0.02, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 104 with value: 78.39065551757812.
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.550516878396252e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.835084248064561e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.7358144355792433e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.509432354777744e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.127520410371119e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.987403350893317e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.99
[Task 1 Finish] Global Accuracy on Task 1: 84.27
tensor([[95.0311,  0.0000,  0.0000],
        [81.9876, 84.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.13	Global AF: 13.04
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.847435786103915e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.356182247202469e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.637034976111124e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.6901118272147926e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.299208294395896e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.711468685833722e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 60.25
[Task 2 Finish] Global Accuracy on Task 1: 58.93
[Task 2 Finish] Global Accuracy on Task 2: 84.28
tensor([[95.0311,  0.0000,  0.0000],
        [81.9876, 84.2667,  0.0000],
        [60.2484, 58.9333, 84.2767]], device='cuda:0')
[Task 2 Finish] Global AA: 67.82	Global AF: 30.06
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378825691062957
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.025184825920178e-09
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:9.255191613100067e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:0.03505839407444
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.428867438401653e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.92817184230654e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.086570609158514e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.638866123509501e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:0.00020712055265903473
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.016780796867181e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.837263563508884e-09
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.54097767668793e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.47
[Task 1 Finish] Global Accuracy on Task 1: 82.67
tensor([[94.7205,  0.0000,  0.0000],
        [84.4721, 82.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.57	Global AF: 10.25
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.862049096665544e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.0518358406486072e-09
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.0342321443701508e-09
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.0863622768606547e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:2.9521865507753375e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.909966570629479e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 76.40
[Task 2 Finish] Global Accuracy on Task 1: 76.27
[Task 2 Finish] Global Accuracy on Task 2: 51.89
tensor([[94.7205,  0.0000,  0.0000],
        [84.4721, 82.6667,  0.0000],
        [76.3975, 76.2667, 51.8868]], device='cuda:0')
[Task 2 Finish] Global AA: 68.18	Global AF: 12.36
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.17362380027771
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:7.798953705062672e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.1966440061073058e-09
[I 2025-09-15 01:02:49,514] Trial 109 finished with value: 74.54149627685547 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 104 with value: 78.39065551757812.
[I 2025-09-15 01:04:39,208] Trial 110 finished with value: 71.6312026977539 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 104 with value: 78.39065551757812.
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.277995900916267e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.426368881484734e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.079784926032005e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.96
tensor([[95.9627,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.96	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.0830535357442272e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.4168790847010087e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.20149820385052e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:0.06120007857680321
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666990015655756
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.506333722316015e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 86.34
[Task 1 Finish] Global Accuracy on Task 1: 77.60
tensor([[95.9627,  0.0000,  0.0000],
        [86.3354, 77.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.97	Global AF: 9.63
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.015043380574014e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.722885581567084e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.176225559289094e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.255325784605304e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:9.882217266721227e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.1847179903767824e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 69.25
[Task 2 Finish] Global Accuracy on Task 1: 73.87
[Task 2 Finish] Global Accuracy on Task 2: 80.50
tensor([[95.9627,  0.0000,  0.0000],
        [86.3354, 77.6000,  0.0000],
        [69.2547, 73.8667, 80.5031]], device='cuda:0')
[Task 2 Finish] Global AA: 74.54	Global AF: 15.22
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:9.428339220463045e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.0976579645216589e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.795260937802027e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.8218291592274625e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792017196305096
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:8.956553276817658e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.1816252944501e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.006389664468202e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.2799960504355e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.031000173070453e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.02377021498978138
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.826937903881003e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.19
[Task 1 Finish] Global Accuracy on Task 1: 80.53
tensor([[94.7205,  0.0000,  0.0000],
        [79.1926, 80.5333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.86	Global AF: 15.53
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.4260104208574376e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.682026126332175e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.518646178399479e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497271729633212
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.379401368799108e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.796550018808631e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 60.56
[Task 2 Finish] Global Accuracy on Task 1: 68.80
[Task 2 Finish] Global Accuracy on Task 2: 85.53
tensor([[94.7205,  0.0000,  0.0000],
        [79.1926, 80.5333,  0.0000],
        [60.5590, 68.8000, 85.5346]], device='cuda:0')
[Task 2 Finish] Global AA: 71.63	Global AF: 22.95
--------------------------------------------------
--------------------------------------------------
[I 2025-09-15 01:07:14,117] Trial 111 finished with value: 74.8440170288086 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 104 with value: 78.39065551757812.
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788245269097388
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.8010938147037265e-11
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:0.029529517516493797
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.595169882965934e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979202301707119
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.52463516758894e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.17
tensor([[93.1677,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.17	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.3787786468100194e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:0.06646177917718887
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.84226658770126e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.4655455737866419e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.026424281299114227
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.129902058698121e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.19
[Task 1 Finish] Global Accuracy on Task 1: 82.13
tensor([[93.1677,  0.0000,  0.0000],
        [79.1926, 82.1333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.66	Global AF: 13.98
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.671297013762569e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.057214340162488e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:9.877324513851704e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.123077517765751e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.173202202053858e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.5354170419287243e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 67.70
[Task 2 Finish] Global Accuracy on Task 1: 70.67
[Task 2 Finish] Global Accuracy on Task 2: 86.16
tensor([[93.1677,  0.0000,  0.0000],
        [79.1926, 82.1333,  0.0000],
        [67.7019, 70.6667, 86.1635]], device='cuda:0')
[Task 2 Finish] Global AA: 74.84	Global AF: 18.47
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.2018834816274193e-09
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.3089675444131217e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.792965162067844e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.270363034881598e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.359308552499442e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:8.636703019426761e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.52824302896471e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.143605458750699e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.187131752431128e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:2.935657272828962e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966491072438657
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.511189672344983e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.81
[Task 1 Finish] Global Accuracy on Task 1: 82.13
tensor([[94.4099,  0.0000,  0.0000],
        [79.8137, 82.1333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.97	Global AF: 14.60
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.428536509199944e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.2861522664416896e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
[I 2025-09-15 01:09:42,915] Trial 112 finished with value: 69.01222229003906 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 104 with value: 78.39065551757812.
[I 2025-09-15 01:12:17,332] Trial 113 finished with value: 73.30635833740234 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 104 with value: 78.39065551757812.
current_loss:4.980692525080599e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:2.3155953543518848e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.103181766052955e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.0333597311174003e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 58.39
[Task 2 Finish] Global Accuracy on Task 1: 58.40
[Task 2 Finish] Global Accuracy on Task 2: 90.25
tensor([[94.4099,  0.0000,  0.0000],
        [79.8137, 82.1333,  0.0000],
        [58.3851, 58.4000, 90.2516]], device='cuda:0')
[Task 2 Finish] Global AA: 69.01	Global AF: 29.88
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378826709697023
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.238992212801662e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.048179652078488e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:0.03505839407444
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.467738596274472e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.1622356410612156e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.1012090128659224e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.4070793419307392e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.1965733665882965e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.070506568065184e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796648234128952
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.535286366573303e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 71.12
[Task 1 Finish] Global Accuracy on Task 1: 85.87
tensor([[94.0994,  0.0000,  0.0000],
        [71.1180, 85.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 78.49	Global AF: 22.98
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.7758157711564877e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.4837517881005624e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.141794295366765e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.75371306155148e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.859920881867708e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.7446342981397578e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 68.63
[Task 2 Finish] Global Accuracy on Task 1: 68.27
[Task 2 Finish] Global Accuracy on Task 2: 83.02
tensor([[94.0994,  0.0000,  0.0000],
        [71.1180, 85.8667,  0.0000],
        [68.6335, 68.2667, 83.0189]], device='cuda:0')
[Task 2 Finish] Global AA: 73.31	Global AF: 21.53
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.0215891466103244e-09
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.52755682839512e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.021663197433355e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:8.852032440387347e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.59872698097297e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.826092303567009e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.0740734968095467e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.200109480327455e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.203400653743586e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.026881690791015e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:4.459217439745089e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.552077686488133e-10
[I 2025-09-15 01:14:44,576] Trial 114 finished with value: 74.90625 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 104 with value: 78.39065551757812.
[I 2025-09-15 01:17:03,740] Trial 115 finished with value: 79.04704284667969 and parameters: {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.12
[Task 1 Finish] Global Accuracy on Task 1: 85.87
tensor([[95.0311,  0.0000,  0.0000],
        [80.1242, 85.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.00	Global AF: 14.91
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.201941294912359e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.596753060999049e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.2894487699810497e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:2.9353172670276706e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.5544356347116945e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.1343803405761719
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 66.46
[Task 2 Finish] Global Accuracy on Task 1: 71.47
[Task 2 Finish] Global Accuracy on Task 2: 86.79
tensor([[95.0311,  0.0000,  0.0000],
        [80.1242, 85.8667,  0.0000],
        [66.4596, 71.4667, 86.7924]], device='cuda:0')
[Task 2 Finish] Global AA: 74.91	Global AF: 21.49
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:9.730396488549786e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.553655951258008e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.0213984102946938e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.418848147975552e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:4.922546259500393e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.622978276915603e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.355485499514145e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.9350375468629721e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.444578511313523e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.176918976308343e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:6.261574037047524e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.3624279482371549e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.50
[Task 1 Finish] Global Accuracy on Task 1: 85.60
tensor([[95.3416,  0.0000,  0.0000],
        [79.5031, 85.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.55	Global AF: 15.84
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.882702020481133e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.243185023459887e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.148461101889268e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:2.3550378314141085e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.768222483519935e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.3147107281195076e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 67.08
[Task 2 Finish] Global Accuracy on Task 1: 81.07
[Task 2 Finish] Global Accuracy on Task 2: 88.99
tensor([[95.3416,  0.0000,  0.0000],
        [79.5031, 85.6000,  0.0000],
        [67.0807, 81.0667, 88.9937]], device='cuda:0')
[Task 2 Finish] Global AA: 79.05	Global AF: 16.40
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0010369211668148637
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.991737744321824e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.818418607501542e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.963898346867836e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.069007518760827e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.4695680490036693e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[I 2025-09-15 01:19:42,351] Trial 116 finished with value: 69.3609619140625 and parameters: {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 01:22:13,540] Trial 117 finished with value: 69.19942474365234 and parameters: {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:3.906917567242374e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.4899661766351073e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.25190907324702e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.3272606891898704e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:5.517363788065666e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.59283341861061e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.75
[Task 1 Finish] Global Accuracy on Task 1: 87.20
tensor([[93.7888,  0.0000,  0.0000],
        [80.7453, 87.2000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.97	Global AF: 13.04
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.829773661707009e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.2374651303659334e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:2.7088650766948774e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.582256878966518e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.2353379430507516e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:0.033466536551713943
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 56.21
[Task 2 Finish] Global Accuracy on Task 1: 59.73
[Task 2 Finish] Global Accuracy on Task 2: 92.14
tensor([[93.7888,  0.0000,  0.0000],
        [80.7453, 87.2000,  0.0000],
        [56.2112, 59.7333, 92.1384]], device='cuda:0')
[Task 2 Finish] Global AA: 69.36	Global AF: 32.52
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788268552161753
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.414237309013913e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.75437317187999e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.701877941495127e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.2015550776567352e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.723342521082088e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.995575950798695e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.033987505673963e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.980097528279771e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.4877206133689924e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966464878991246
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.31616997487572e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.19
[Task 1 Finish] Global Accuracy on Task 1: 86.93
tensor([[95.0311,  0.0000,  0.0000],
        [79.1926, 86.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.06	Global AF: 15.84
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.968535110589812e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.226855449511845e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.417608111597417e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497272311709821
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.9965151754064436e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.8887700564972363e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 59.94
[Task 2 Finish] Global Accuracy on Task 1: 58.67
[Task 2 Finish] Global Accuracy on Task 2: 88.99
tensor([[95.0311,  0.0000,  0.0000],
        [79.1926, 86.9333,  0.0000],
        [59.9379, 58.6667, 88.9937]], device='cuda:0')
[Task 2 Finish] Global AA: 69.20	Global AF: 31.68
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:7.407633395573043e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.358812755178576e-10
[I 2025-09-15 01:25:05,898] Trial 118 finished with value: 61.71954345703125 and parameters: {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.1202019312150924e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.676625918800028e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792031748220325
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.646326822234983e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.36477592852458e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:9.3349528107467e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.357378984882644e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.0450396104033643e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666985359042883
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.576940658753472e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 76.09
[Task 1 Finish] Global Accuracy on Task 1: 88.00
tensor([[95.6522,  0.0000,  0.0000],
        [76.0870, 88.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.04	Global AF: 19.57
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.2519189018789234e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.679120507195989e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.7348867897837295e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:9.023854441458923e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:9.46294931303271e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.8602762653106026e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 49.69
[Task 2 Finish] Global Accuracy on Task 1: 47.73
[Task 2 Finish] Global Accuracy on Task 2: 87.74
tensor([[95.6522,  0.0000,  0.0000],
        [76.0870, 88.0000,  0.0000],
        [49.6894, 47.7333, 87.7358]], device='cuda:0')
[Task 2 Finish] Global AA: 61.72	Global AF: 43.11
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:6.219405546126211e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.782631513045033e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.242208499569358e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:8.246163751834956e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.179168205415863e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:9.18635612023877e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.9818835461649087e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.002308260479651e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:2.231863166501924e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.3171810570896696e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:3.9796979933726107e-08
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:2.849303015750593e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.23
[Task 1 Finish] Global Accuracy on Task 1: 85.07
tensor([[95.6522,  0.0000,  0.0000],
        [83.2298, 85.0667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.15	Global AF: 12.42
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.745474344706849e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.418766546583242e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.054385881526514e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497273184824735
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.0341211220676882e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.318953610888855e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 72.67
[Task 2 Finish] Global Accuracy on Task 1: 81.07
[Task 2 Finish] Global Accuracy on Task 2: 69.81
tensor([[95.6522,  0.0000,  0.0000],
        [83.2298, 85.0667,  0.0000],
        [72.6708, 81.0667, 69.8113]], device='cuda:0')
[I 2025-09-15 01:27:45,163] Trial 119 finished with value: 74.51626586914062 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 01:30:08,449] Trial 120 finished with value: 70.80162811279297 and parameters: {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[Task 2 Finish] Global AA: 74.52	Global AF: 13.49
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.4886469834607396e-09
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:0.001759817823767662
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.860502331842213e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.876776205087197e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792031748220325
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.9160677211527144e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.2638451113721203e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.0258352207445114e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.240861326669346e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.1423314778299414e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.026424281299114227
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.211412967831563e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.19
[Task 1 Finish] Global Accuracy on Task 1: 88.00
tensor([[94.0994,  0.0000,  0.0000],
        [79.1926, 88.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.60	Global AF: 14.91
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.722698036616293e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:0.02285819873213768
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.352420256483526e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.7484110260166403e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.535541080017083e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.267520391567416e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 56.21
[Task 2 Finish] Global Accuracy on Task 1: 67.20
[Task 2 Finish] Global Accuracy on Task 2: 88.99
tensor([[94.0994,  0.0000,  0.0000],
        [79.1926, 88.0000,  0.0000],
        [56.2112, 67.2000, 88.9937]], device='cuda:0')
[Task 2 Finish] Global AA: 70.80	Global AF: 29.34
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788290380034596
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.126530394112706e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.214176395680227e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.3331264698001064e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.3945533556002374e-08
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.252589084849603e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:0.029233457520604134
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.42449255116739e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.070454777213797e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.0674477381516e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.000379664619686082
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.804646680511837e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.50
[Task 1 Finish] Global Accuracy on Task 1: 85.87
tensor([[94.7205,  0.0000,  0.0000],
        [79.5031, 85.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.68	Global AF: 15.22
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.0021194984943804e-09
[I 2025-09-15 01:32:48,118] Trial 121 finished with value: 73.52487182617188 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 01:35:17,831] Trial 122 finished with value: 74.89994049072266 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.26589882809958e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.163825478327055e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.00044972720206715167
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.6320809148595572e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.460723179722237e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 71.12
[Task 2 Finish] Global Accuracy on Task 1: 83.73
[Task 2 Finish] Global Accuracy on Task 2: 65.72
tensor([[94.7205,  0.0000,  0.0000],
        [79.5031, 85.8667,  0.0000],
        [71.1180, 83.7333, 65.7233]], device='cuda:0')
[Task 2 Finish] Global AA: 73.52	Global AF: 12.87
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378826709697023
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.158732914647743e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.1275279598876864e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.020445336181069e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.653156831542105e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.054684005743269e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.055587142839158e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:0.001442389446310699
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:9.653132737597048e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.3362135009575837e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966601666994393
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.612729335804147e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.30
[Task 1 Finish] Global Accuracy on Task 1: 84.53
tensor([[94.4099,  0.0000,  0.0000],
        [82.2981, 84.5333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.42	Global AF: 12.11
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:0.028870712965726852
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:9.082189444953315e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:9.85449832846541e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497270565479994
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.096900927512252e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.2131015076087834e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 69.57
[Task 2 Finish] Global Accuracy on Task 1: 69.60
[Task 2 Finish] Global Accuracy on Task 2: 85.53
tensor([[94.4099,  0.0000,  0.0000],
        [82.2981, 84.5333,  0.0000],
        [69.5652, 69.6000, 85.5346]], device='cuda:0')
[Task 2 Finish] Global AA: 74.90	Global AF: 19.89
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788357318844646
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.522476365094064e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.639157001941953e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.4261014298108137e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.1244303266266797e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.779059453203672e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.3731568659913762e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:0.06646177917718887
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.482269083145752e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.530491147849204e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
[I 2025-09-15 01:37:42,268] Trial 123 finished with value: 61.102134704589844 and parameters: {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 01:40:21,815] Trial 124 finished with value: 72.89729309082031 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
current_loss:3.9427422438009785e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.658680191089616e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 71.43
[Task 1 Finish] Global Accuracy on Task 1: 89.60
tensor([[94.4099,  0.0000,  0.0000],
        [71.4286, 89.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.51	Global AF: 22.98
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.093228811452576e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:9.92774640273808e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.310870797638813e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.03872288763523102
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.445768280765151e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.0027961794278895e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 45.34
[Task 2 Finish] Global Accuracy on Task 1: 49.60
[Task 2 Finish] Global Accuracy on Task 2: 88.36
tensor([[94.4099,  0.0000,  0.0000],
        [71.4286, 89.6000,  0.0000],
        [45.3416, 49.6000, 88.3648]], device='cuda:0')
[Task 2 Finish] Global AA: 61.10	Global AF: 44.53
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788259821012616
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.5944358333630504e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.961372754967556e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.6829458927023495e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:9.43208733339418e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.734756338578336e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.162490600620686e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.794832391714522e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:0.00020712011610157788
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.078280573833638e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.8136429247306296e-08
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.229292164900869e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 74.22
[Task 1 Finish] Global Accuracy on Task 1: 85.33
tensor([[95.3416,  0.0000,  0.0000],
        [74.2236, 85.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.78	Global AF: 21.12
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.3022787282455113e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.837679146163509e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:9.311258986066662e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.194234486971538e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.12332423549833e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.9953539648630567e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 64.60
[Task 2 Finish] Global Accuracy on Task 1: 70.13
[Task 2 Finish] Global Accuracy on Task 2: 83.96
tensor([[95.3416,  0.0000,  0.0000],
        [74.2236, 85.3333,  0.0000],
        [64.5963, 70.1333, 83.9623]], device='cuda:0')
[Task 2 Finish] Global AA: 72.90	Global AF: 22.97
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378826127620414
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.17348008982421e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.300216625123369e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.99743080251136e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:4.0984685090172945e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.788065665119802e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
[I 2025-09-15 01:42:56,224] Trial 125 finished with value: 70.05683898925781 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 01:45:35,374] Trial 126 finished with value: 73.59335327148438 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.388026301846651e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.817782922079573e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.66815808231047e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.2837605967728223e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.226491093635559
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.1132958150669197e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.06
[Task 1 Finish] Global Accuracy on Task 1: 85.33
tensor([[95.3416,  0.0000,  0.0000],
        [81.0559, 85.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.19	Global AF: 14.29
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.896630406176939e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:2.0655921417755962e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.265177820985457e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.03879820927977562
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.0770279113003767e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.540471054692574e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 63.04
[Task 2 Finish] Global Accuracy on Task 1: 58.13
[Task 2 Finish] Global Accuracy on Task 2: 88.99
tensor([[95.3416,  0.0000,  0.0000],
        [81.0559, 85.3333,  0.0000],
        [63.0435, 58.1333, 88.9937]], device='cuda:0')
[Task 2 Finish] Global AA: 70.06	Global AF: 29.75
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:2.380940444801638e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.17443374206772e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.087881865290967e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.4273776311776203e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.565931828650946e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.5703479889525056e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.48
tensor([[93.4783,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.48	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.8622344777341482e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.6238507467322165e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.407181924432791e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.536341302596725e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:3.5888209071188726e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.609706281248464e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.47
[Task 1 Finish] Global Accuracy on Task 1: 83.47
tensor([[93.4783,  0.0000,  0.0000],
        [84.4720, 83.4667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.97	Global AF: 9.01
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.095810605761699e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.811987002779517e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.149552533862845e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.804266677347016e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.0889606993913503e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.9727975636717474e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 70.19
[Task 2 Finish] Global Accuracy on Task 1: 61.60
[Task 2 Finish] Global Accuracy on Task 2: 88.99
tensor([[93.4783,  0.0000,  0.0000],
        [84.4720, 83.4667,  0.0000],
        [70.1863, 61.6000, 88.9937]], device='cuda:0')
[Task 2 Finish] Global AA: 73.59	Global AF: 22.58
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[I 2025-09-15 01:48:04,103] Trial 127 finished with value: 69.35797119140625 and parameters: {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788265641778708
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.094246773891143e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.495118999248149e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.9926972839054997e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.294533783091083e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.2114920178163402e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.2610676098675526e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.7732168511308544e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.600642172254311e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.0320582983532915e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796649689320475
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.407028961876506e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 74.84
[Task 1 Finish] Global Accuracy on Task 1: 76.00
tensor([[93.7888,  0.0000,  0.0000],
        [74.8447, 76.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 75.42	Global AF: 18.94
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.45388392833479e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.623480014982363e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.219767644312981e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.300753724846174e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.8059050355698787e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.243099370806249e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 68.32
[Task 2 Finish] Global Accuracy on Task 1: 58.93
[Task 2 Finish] Global Accuracy on Task 2: 80.82
tensor([[93.7888,  0.0000,  0.0000],
        [74.8447, 76.0000,  0.0000],
        [68.3230, 58.9333, 80.8176]], device='cuda:0')
[Task 2 Finish] Global AA: 69.36	Global AF: 21.27
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:8.435923071203888e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.027416898923832e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.008624961329474e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.660157815195021e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792232564650476
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.76464970308632e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.477638673871525e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.052950947601829e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.2066531107635114e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.3391684428043504e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.026424281299114227
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.735856234423409e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.23
[Task 1 Finish] Global Accuracy on Task 1: 80.00
tensor([[95.0311,  0.0000,  0.0000],
        [83.2298, 80.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.61	Global AF: 11.80
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.020424879795485e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.300712812075005e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.025707395747303963
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.251167196045458e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.846268717555006e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.913989936130349e-10
[I 2025-09-15 01:50:25,758] Trial 128 finished with value: 67.63125610351562 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 01:53:06,751] Trial 129 finished with value: 78.372314453125 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 68.94
[Task 2 Finish] Global Accuracy on Task 1: 72.00
[Task 2 Finish] Global Accuracy on Task 2: 61.95
tensor([[95.0311,  0.0000,  0.0000],
        [83.2298, 80.0000,  0.0000],
        [68.9441, 72.0000, 61.9497]], device='cuda:0')
[Task 2 Finish] Global AA: 67.63	Global AF: 17.04
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:8.173636212305269e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.973530033312244e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.3180896918949543e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.8204727442471267e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979204047936946
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.429732302137836e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.148613367924384e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.800063124754672e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:9.631415665012355e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.4015527334018145e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:3.3069158522636144e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.884844916399402e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.30
[Task 1 Finish] Global Accuracy on Task 1: 78.93
tensor([[95.6522,  0.0000,  0.0000],
        [82.2981, 78.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.62	Global AF: 13.35
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.788038075024929e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:2.746547433929436e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.3553750122241581e-08
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:2.870866877557887e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:9.272786982705838e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:9.482086227308173e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 73.60
[Task 2 Finish] Global Accuracy on Task 1: 77.87
[Task 2 Finish] Global Accuracy on Task 2: 83.65
tensor([[95.6522,  0.0000,  0.0000],
        [82.2981, 78.9333,  0.0000],
        [73.6025, 77.8667, 83.6478]], device='cuda:0')
[Task 2 Finish] Global AA: 78.37	Global AF: 11.56
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788291835226119
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.75356198847976e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.029828444742975e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.3189969116922384e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:9.504431686124803e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.22089863061359e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:0.029233457520604134
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.2407830318750257e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.205292863408317e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:0.06120007857680321
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.002666700864210725
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.1720940591183364e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.23
[Task 1 Finish] Global Accuracy on Task 1: 85.87
tensor([[95.3416,  0.0000,  0.0000],
        [83.2298, 85.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.55	Global AF: 12.11
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[I 2025-09-15 01:55:37,382] Trial 130 finished with value: 73.76263427734375 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 01:58:15,017] Trial 131 finished with value: 59.723934173583984 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.799354023203421e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:9.376428522500646e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:9.415667134859973e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.1057585109527395e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.704463485438737e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.300427484757677e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 68.01
[Task 2 Finish] Global Accuracy on Task 1: 71.20
[Task 2 Finish] Global Accuracy on Task 2: 82.08
tensor([[95.3416,  0.0000,  0.0000],
        [83.2298, 85.8667,  0.0000],
        [68.0124, 71.2000, 82.0755]], device='cuda:0')
[Task 2 Finish] Global AA: 73.76	Global AF: 21.00
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788286014460027
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:7.740643126474822e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.739282937788914e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.1146880085632915e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792037568986416
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.386078250069204e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.711570105759733e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.412411104213419e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.811941566375879e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.2299804508231205e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796651726588607
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.555844118099174e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.64
[Task 1 Finish] Global Accuracy on Task 1: 88.00
tensor([[94.0994,  0.0000,  0.0000],
        [77.6398, 88.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.82	Global AF: 16.46
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.3272404286723827e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.0501473024504548e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.4233485490808846e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:2.5540144998892345e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.2194502074791558e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.60266816379351e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 51.24
[Task 2 Finish] Global Accuracy on Task 1: 51.20
[Task 2 Finish] Global Accuracy on Task 2: 76.73
tensor([[94.0994,  0.0000,  0.0000],
        [77.6398, 88.0000,  0.0000],
        [51.2422, 51.2000, 76.7296]], device='cuda:0')
[Task 2 Finish] Global AA: 59.72	Global AF: 39.83
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788382057100534
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.1440657310402003e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:9.63670476750167e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.8877620300283837e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.501129079516943e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.843268563980985e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:0.029233457520604134
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.960767045567252e-10
[I 2025-09-15 02:00:48,861] Trial 132 finished with value: 72.39196014404297 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 02:03:27,054] Trial 133 finished with value: 72.34336853027344 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.229120080332052e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.40139394217465e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966493982821703
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.754148989569387e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.95
[Task 1 Finish] Global Accuracy on Task 1: 86.13
tensor([[94.7205,  0.0000,  0.0000],
        [77.9503, 86.1333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.04	Global AF: 16.77
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.7374253691879744e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.1285981038611226e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.322447175856951e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.986809547055884e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.643783301285566e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.576118845494136e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 71.12
[Task 2 Finish] Global Accuracy on Task 1: 78.13
[Task 2 Finish] Global Accuracy on Task 2: 67.92
tensor([[94.7205,  0.0000,  0.0000],
        [77.9503, 86.1333,  0.0000],
        [71.1180, 78.1333, 67.9245]], device='cuda:0')
[Task 2 Finish] Global AA: 72.39	Global AF: 15.80
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.017413990572094917
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.642108782284879e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.488078018231704e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.3433061874532655e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:8.181732513712348e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.157822667913649e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.96
tensor([[95.9627,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.96	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.03757488448764e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.098745952698437e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.3211234328736055e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:8.364284820316925e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666990015655756
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.4174120744932e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 85.40
[Task 1 Finish] Global Accuracy on Task 1: 80.53
tensor([[95.9627,  0.0000,  0.0000],
        [85.4037, 80.5333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.97	Global AF: 10.56
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.8659993550329546e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:9.24329113249911e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.2857472864169495e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:8.207744484067803e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:2.6126711905050115e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.0586773679932548e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 76.71
[Task 2 Finish] Global Accuracy on Task 1: 76.80
[Task 2 Finish] Global Accuracy on Task 2: 63.52
tensor([[95.9627,  0.0000,  0.0000],
        [85.4037, 80.5333,  0.0000],
        [76.7081, 76.8000, 63.5220]], device='cuda:0')
[Task 2 Finish] Global AA: 72.34	Global AF: 11.49
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788268552161753
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.989317292647399e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.15315842628479
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.728453184554837e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.2786173231305042e-09
[I 2025-09-15 02:06:03,123] Trial 134 finished with value: 77.0921859741211 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 02:08:48,227] Trial 135 finished with value: 71.47457885742188 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.82850490093989e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.331069143795105e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.032957077297453e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.8758082854251086e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:0.06120007857680321
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966473610140383
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.078069241828189e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 86.96
[Task 1 Finish] Global Accuracy on Task 1: 83.20
tensor([[95.3416,  0.0000,  0.0000],
        [86.9565, 83.2000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 85.08	Global AF: 8.39
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.766883720032979e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.098589330617017e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.759995424017063e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.0508236503170565e-09
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.396026096590958e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.909347485147151e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 73.91
[Task 2 Finish] Global Accuracy on Task 1: 71.20
[Task 2 Finish] Global Accuracy on Task 2: 86.16
tensor([[95.3416,  0.0000,  0.0000],
        [86.9565, 83.2000,  0.0000],
        [73.9130, 71.2000, 86.1635]], device='cuda:0')
[Task 2 Finish] Global AA: 77.09	Global AF: 16.71
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:8.710287491275892e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:0.0008667545043863356
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.721562030240989e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.815925436219004e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.570294893062709e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:0.060132186859846115
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.347672304978346e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.371022043261121e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.516869431929308e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.114322074843528e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.3871500614826004e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.1369740704481046e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.33
[Task 1 Finish] Global Accuracy on Task 1: 79.47
tensor([[95.0311,  0.0000,  0.0000],
        [77.3292, 79.4667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 78.40	Global AF: 17.70
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.1745310279920318e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.780487672384481e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.201218344907943e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.000449727667728439
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.60117952019823e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.256322764881418e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 62.11
[Task 2 Finish] Global Accuracy on Task 1: 73.07
[Task 2 Finish] Global Accuracy on Task 2: 79.25
tensor([[95.0311,  0.0000,  0.0000],
        [77.3292, 79.4667,  0.0000],
        [62.1118, 73.0667, 79.2453]], device='cuda:0')
[Task 2 Finish] Global AA: 71.47	Global AF: 19.66
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[I 2025-09-15 02:11:39,735] Trial 136 finished with value: 69.38050079345703 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:5.209322417876194e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.0251422760964033e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.295664710722406e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.697258220749291e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.2415304340152034e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.641700995262511e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.48
tensor([[93.4783,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.48	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.760399155567256e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.387211787777346e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.782742062976354e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.72743122426067e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.002666699467226863
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.0260353384447e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 86.34
[Task 1 Finish] Global Accuracy on Task 1: 77.07
tensor([[93.4783,  0.0000,  0.0000],
        [86.3354, 77.0667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.70	Global AF: 7.14
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.47992556782151e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.045323187540362e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.623475213794137e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.745954380018901e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.831681166272972e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.870341517917211e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 77.95
[Task 2 Finish] Global Accuracy on Task 1: 78.93
[Task 2 Finish] Global Accuracy on Task 2: 51.26
tensor([[93.4783,  0.0000,  0.0000],
        [86.3354, 77.0667,  0.0000],
        [77.9503, 78.9333, 51.2579]], device='cuda:0')
[Task 2 Finish] Global AA: 69.38	Global AF: 6.83
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378827728331089
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.178404454715292e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:9.349406804304294e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.087455570036866e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.126252365985408e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.0068381118297793e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.164820958749374e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.0726152188667015e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.971227873795669e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:8.38479508047385e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666992343962193
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.633405603637897e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.85
[Task 1 Finish] Global Accuracy on Task 1: 81.33
tensor([[94.7205,  0.0000,  0.0000],
        [83.8509, 81.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.59	Global AF: 10.87
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:2.630791973157187e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.5417288546391035e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.00039396254578605294
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497273184824735
[I 2025-09-15 02:14:15,015] Trial 137 finished with value: 71.16470336914062 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 02:16:57,218] Trial 138 finished with value: 66.64561462402344 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.815760261209448e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.83044637411956e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 65.22
[Task 2 Finish] Global Accuracy on Task 1: 64.00
[Task 2 Finish] Global Accuracy on Task 2: 84.28
tensor([[94.7205,  0.0000,  0.0000],
        [83.8509, 81.3333,  0.0000],
        [65.2174, 64.0000, 84.2767]], device='cuda:0')
[Task 2 Finish] Global AA: 71.16	Global AF: 23.42
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788254000246525
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.0090413777040794e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.222560327591054e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.933118523733128e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.125438962139128e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.46956813174404e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.178357742607886e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.616161536879048e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.932179357794666e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.022064513722114e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.5606195802320144e-07
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.590789746243388e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.68
[Task 1 Finish] Global Accuracy on Task 1: 73.33
tensor([[94.0994,  0.0000,  0.0000],
        [81.6770, 73.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 77.51	Global AF: 12.42
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.737975177806277e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.1652908899791896e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.030366123648378e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:8.621756641957745e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.1755964756011963
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:9.655174437739333e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 74.22
[Task 2 Finish] Global Accuracy on Task 1: 77.60
[Task 2 Finish] Global Accuracy on Task 2: 48.11
tensor([[94.0994,  0.0000,  0.0000],
        [81.6770, 73.3333,  0.0000],
        [74.2236, 77.6000, 48.1132]], device='cuda:0')
[Task 2 Finish] Global AA: 66.65	Global AF: 7.80
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788294745609164
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.670676623241832e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.122410439208693e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.0134381928957907e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792057941667736
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.753766269516291e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.837986926162444e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.0709807480034925e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.968735505845757e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.123079183100288e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.9437254583642982e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.912975109545471e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.33
[Task 1 Finish] Global Accuracy on Task 1: 81.33
[I 2025-09-15 02:19:35,292] Trial 139 finished with value: 76.97535705566406 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 02:22:10,060] Trial 140 finished with value: 68.64810180664062 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
tensor([[95.0311,  0.0000,  0.0000],
        [77.3292, 81.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.33	Global AF: 17.70
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.177721750295518e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.875697788899515e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.694654358125774e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.3531730170288654e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.347627340945849e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.0278585194665197e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 75.78
[Task 2 Finish] Global Accuracy on Task 1: 76.53
[Task 2 Finish] Global Accuracy on Task 2: 78.62
tensor([[95.0311,  0.0000,  0.0000],
        [77.3292, 81.3333,  0.0000],
        [75.7764, 76.5333, 78.6163]], device='cuda:0')
[Task 2 Finish] Global AA: 76.98	Global AF: 12.03
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378824090352282
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:8.583475596957157e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.555541275434564e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.179085104169758e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:9.022563807192796e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.368815949476243e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.96
tensor([[95.9627,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.96	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.0104004299904545e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.250664542571059e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.322322584762503e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.1493889173763705e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966444506309927
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:9.310796023065393e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.19
[Task 1 Finish] Global Accuracy on Task 1: 78.93
tensor([[95.9627,  0.0000,  0.0000],
        [79.1926, 78.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.06	Global AF: 16.77
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:0.028870712965726852
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.5488489657489168e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.034375694101811e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.2984518722199994e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.9910044713487025e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.332406183278238e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 71.43
[Task 2 Finish] Global Accuracy on Task 1: 65.33
[Task 2 Finish] Global Accuracy on Task 2: 69.18
tensor([[95.9627,  0.0000,  0.0000],
        [79.1926, 78.9333,  0.0000],
        [71.4286, 65.3333, 69.1824]], device='cuda:0')
[Task 2 Finish] Global AA: 68.65	Global AF: 19.07
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788274372927845
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:0.0008667520014569163
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.837221510127335e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:0.03505839407444
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:9.106368437095114e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:8.800165596234422e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.96
tensor([[95.9627,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.96	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[I 2025-09-15 02:24:59,559] Trial 141 finished with value: 74.67727661132812 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 02:27:37,075] Trial 142 finished with value: 69.50163269042969 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.603256830217674e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.458684644768283e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.1472580925017155e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.2760449908408873e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796647069975734
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.2368802648765609e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.16
[Task 1 Finish] Global Accuracy on Task 1: 82.40
tensor([[95.9627,  0.0000,  0.0000],
        [84.1615, 82.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.28	Global AF: 11.80
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.172648975815264e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.037304072810002e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.0676757256078417e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:8.21471224377035e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.591558439541842e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.365765692351033e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 72.67
[Task 2 Finish] Global Accuracy on Task 1: 69.60
[Task 2 Finish] Global Accuracy on Task 2: 81.76
tensor([[95.9627,  0.0000,  0.0000],
        [84.1615, 82.4000,  0.0000],
        [72.6708, 69.6000, 81.7610]], device='cuda:0')
[Task 2 Finish] Global AA: 74.68	Global AF: 18.05
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788286014460027
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.141901987000153e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.359534093254183e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.968994854997021e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792072493582964
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:8.30484014890942e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.48
tensor([[93.4783,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.48	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.4410247439755608e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.519954493493628e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.021663333579454e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.263141116846782e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.2097686186152146e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.451551767672754e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.78
[Task 1 Finish] Global Accuracy on Task 1: 78.40
tensor([[93.4783,  0.0000,  0.0000],
        [84.7826, 78.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.59	Global AF: 8.70
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:0.028870712965726852
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.198849128973393e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.00039397639920935035
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.763529736275586e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.432713971551209e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.981749067769272e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 78.26
[Task 2 Finish] Global Accuracy on Task 1: 69.87
[Task 2 Finish] Global Accuracy on Task 2: 60.38
tensor([[93.4783,  0.0000,  0.0000],
        [84.7826, 78.4000,  0.0000],
        [78.2609, 69.8667, 60.3774]], device='cuda:0')
[Task 2 Finish] Global AA: 69.50	Global AF: 11.88
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0010629916796460748
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.501299416010852e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.022869035784197e-10
[I 2025-09-15 02:30:25,664] Trial 143 finished with value: 62.86690902709961 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 02:33:14,948] Trial 144 finished with value: 69.13092041015625 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.2764069795844222e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.1672830702025294e-08
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.236751977553354e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.96
tensor([[95.9627,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.96	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.56440482369203e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.79493969371714e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.038847117333489e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:2.833419887604549e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:2.154515454932948e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.198331209932405e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.16
[Task 1 Finish] Global Accuracy on Task 1: 80.00
tensor([[95.9627,  0.0000,  0.0000],
        [84.1615, 80.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.08	Global AF: 11.80
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.0369221026838034e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.6111149060456e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.1721453807567173e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.570254092366554e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.724247270106787e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.2505259050499262e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 51.24
[Task 2 Finish] Global Accuracy on Task 1: 60.00
[Task 2 Finish] Global Accuracy on Task 2: 77.36
tensor([[95.9627,  0.0000,  0.0000],
        [84.1615, 80.0000,  0.0000],
        [51.2422, 60.0000, 77.3585]], device='cuda:0')
[Task 2 Finish] Global AA: 62.87	Global AF: 32.36
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788300566375256
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:9.996813377100011e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.574612438330462e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.045537988466407e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.557911355476449e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.1490126848220825
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.623508880781003e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.805734781816341e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.146667229702587e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.404406924088164e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966491072438657
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:0.04987136647105217
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.57
[Task 1 Finish] Global Accuracy on Task 1: 81.60
tensor([[95.6522,  0.0000,  0.0000],
        [78.5714, 81.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.09	Global AF: 17.08
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.44165609742231e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.616333509372851e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.0713931963834966e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.371906335900235e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.5735089887189986e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.954137903887215e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 69.88
[Task 2 Finish] Global Accuracy on Task 1: 66.13
[Task 2 Finish] Global Accuracy on Task 2: 71.38
tensor([[95.6522,  0.0000,  0.0000],
        [78.5714, 81.6000,  0.0000],
        [69.8758, 66.1333, 71.3836]], device='cuda:0')
[Task 2 Finish] Global AA: 69.13	Global AF: 20.62
--------------------------------------------------
--------------------------------------------------
[I 2025-09-15 02:35:52,770] Trial 145 finished with value: 73.17090606689453 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788268552161753
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.326808521528449e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.983652462404621e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.3895492796153235e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.526365117105911e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:0.060132186859846115
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.137820169309748e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.726653347551178e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.0389347422120636e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.453719225696375e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796646778937429
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.209550261817355e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 75.78
[Task 1 Finish] Global Accuracy on Task 1: 84.53
tensor([[94.4099,  0.0000,  0.0000],
        [75.7764, 84.5333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.15	Global AF: 18.63
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.845068566465386e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.511461925207129e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.686490970966076e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.871168468589815e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.0828956620301255e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.815233046682408e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 71.74
[Task 2 Finish] Global Accuracy on Task 1: 77.33
[Task 2 Finish] Global Accuracy on Task 2: 70.44
tensor([[94.4099,  0.0000,  0.0000],
        [75.7764, 84.5333,  0.0000],
        [71.7391, 77.3333, 70.4402]], device='cuda:0')
[Task 2 Finish] Global AA: 73.17	Global AF: 14.94
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788274372927845
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.876953923511508e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.837888978315164e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.5882560811550945e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.0923109083904592e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.043934797084205e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.291013738251138e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.113618500336315e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.5609175063602265e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.251208687999224e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666992343962193
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.753246047288883e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.57
[Task 1 Finish] Global Accuracy on Task 1: 86.40
tensor([[95.0311,  0.0000,  0.0000],
        [78.5714, 86.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.49	Global AF: 16.46
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.634146010320308e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.7900257665015573e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
[I 2025-09-15 02:38:46,262] Trial 146 finished with value: 76.19780731201172 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 02:41:20,597] Trial 147 finished with value: 75.09870910644531 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
current_loss:7.143242108931247e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497270565479994
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.491001707826683e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.6267829578152657e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 74.22
[Task 2 Finish] Global Accuracy on Task 1: 73.87
[Task 2 Finish] Global Accuracy on Task 2: 80.50
tensor([[95.0311,  0.0000,  0.0000],
        [78.5714, 86.4000,  0.0000],
        [74.2236, 73.8667, 80.5031]], device='cuda:0')
[Task 2 Finish] Global AA: 76.20	Global AF: 16.67
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378828164888546
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.730312890861455e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.0978684334724846e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.30915875099447e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.3013356614521854e-08
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.1100422803167476e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.133317435683352e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:9.298353753628419e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:0.041359443217515945
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.073779812432178e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:8.789372007989016e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.4306174300759977e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 86.02
[Task 1 Finish] Global Accuracy on Task 1: 78.93
tensor([[94.0994,  0.0000,  0.0000],
        [86.0248, 78.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.48	Global AF: 8.07
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.0339036293771642e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.789148853161066e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.9785872940047966e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.914860823352797e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.371554784832199e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.22580978490339e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 72.36
[Task 2 Finish] Global Accuracy on Task 1: 81.87
[Task 2 Finish] Global Accuracy on Task 2: 71.07
tensor([[94.0994,  0.0000,  0.0000],
        [86.0248, 78.9333,  0.0000],
        [72.3603, 81.8667, 71.0692]], device='cuda:0')
[Task 2 Finish] Global AA: 75.10	Global AF: 9.40
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:7.148086011987687e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:9.521596844308533e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:0.04181229695677757
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.1154576151639617e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:4.152984622862732e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.574376267716616e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.0194550476304585e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.741611075471553e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.554539854266352e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:2.739694582309937e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:2.1881535472445535e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.260210434952171e-10
[I 2025-09-15 02:44:10,899] Trial 148 finished with value: 64.51253509521484 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 02:47:00,869] Trial 149 finished with value: 65.29713439941406 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 87.27
[Task 1 Finish] Global Accuracy on Task 1: 79.73
tensor([[95.0311,  0.0000,  0.0000],
        [87.2671, 79.7333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.50	Global AF: 7.76
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.4257548475171689e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.313961575798999e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.164252748710794e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.851145513600329e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.67586358521288e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.5746967325399623e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 72.36
[Task 2 Finish] Global Accuracy on Task 1: 60.80
[Task 2 Finish] Global Accuracy on Task 2: 60.38
tensor([[95.0311,  0.0000,  0.0000],
        [87.2671, 79.7333,  0.0000],
        [72.3603, 60.8000, 60.3774]], device='cuda:0')
[Task 2 Finish] Global AA: 64.51	Global AF: 20.80
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788290380034596
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:7.5299377844118e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.52165424494433e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.2787145221035985e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.3827934353116689e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.702246618279673e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.088287793216125e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.967933062820066e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.845995437210206e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.215083004854847e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.6601731100962525e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.7118724215947623e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.92
[Task 1 Finish] Global Accuracy on Task 1: 78.93
tensor([[94.7205,  0.0000,  0.0000],
        [82.9193, 78.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.93	Global AF: 11.80
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.0894498636560002e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.906137245936804e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:9.318296134708248e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.157065968181996e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:2.752015559881471e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.472539171298308e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 68.63
[Task 2 Finish] Global Accuracy on Task 1: 76.00
[Task 2 Finish] Global Accuracy on Task 2: 51.26
tensor([[94.7205,  0.0000,  0.0000],
        [82.9193, 78.9333,  0.0000],
        [68.6335, 76.0000, 51.2579]], device='cuda:0')
[Task 2 Finish] Global AA: 65.30	Global AF: 14.51
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:4.5147319216454207e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.458324460137163e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.317359998864731e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.018276544837107e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.491625599760795e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.499175004253232e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[I 2025-09-15 02:49:58,389] Trial 150 finished with value: 72.02218627929688 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 02:52:40,243] Trial 151 finished with value: 68.89501190185547 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.270452100944681e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.487661519116728e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.667352225875334e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.2985767723102697e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966552190482616
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.993371189281447e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.16
[Task 1 Finish] Global Accuracy on Task 1: 81.87
tensor([[94.7205,  0.0000,  0.0000],
        [84.1615, 81.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.01	Global AF: 10.56
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.58066814981828e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.3797227804701606e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.417332859027681e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.1798531041051774e-09
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.4188176189477986e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.776423813077855e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 76.71
[Task 2 Finish] Global Accuracy on Task 1: 78.67
[Task 2 Finish] Global Accuracy on Task 2: 60.69
tensor([[94.7205,  0.0000,  0.0000],
        [84.1615, 81.8667,  0.0000],
        [76.7081, 78.6667, 60.6918]], device='cuda:0')
[Task 2 Finish] Global AA: 72.02	Global AF: 10.61
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788336946163327
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:9.307528636703921e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.313564836548437e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.965477473639623e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.3402319254396389e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.94520036031787e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.2291310191869798e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.5134657122858357e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.1762040230678394e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.4796973646369338e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.026967735961079597
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:9.492139296796154e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.99
[Task 1 Finish] Global Accuracy on Task 1: 78.13
tensor([[95.6522,  0.0000,  0.0000],
        [81.9876, 78.1333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.06	Global AF: 13.66
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.1672502964188425e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.691274118646561e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.0162022334725407e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.6167721605953034e-09
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.1756057739257812
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:0.0010427035158500075
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 71.74
[Task 2 Finish] Global Accuracy on Task 1: 62.93
[Task 2 Finish] Global Accuracy on Task 2: 72.01
tensor([[95.6522,  0.0000,  0.0000],
        [81.9876, 78.1333,  0.0000],
        [71.7391, 62.9333, 72.0126]], device='cuda:0')
[Task 2 Finish] Global AA: 68.90	Global AF: 19.56
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788310752715915
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.677310288554338e-10
[I 2025-09-15 02:55:34,080] Trial 152 finished with value: 76.00648498535156 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.2098123614023848e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.496470028594103e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:9.15344411378527e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:9.18251238934964e-11
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.991734579133492e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.447910290610423e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.768831995960454e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.205351481078594e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:8.226260228560989e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.5448962109587683e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 85.71
[Task 1 Finish] Global Accuracy on Task 1: 85.07
tensor([[95.6522,  0.0000,  0.0000],
        [85.7143, 85.0667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 85.39	Global AF: 9.94
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:2.6062338398524787e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.067911981067482e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.185319644304911e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:8.977514287522581e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.842709094316945e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.934099240294643e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 69.25
[Task 2 Finish] Global Accuracy on Task 1: 70.40
[Task 2 Finish] Global Accuracy on Task 2: 88.36
tensor([[95.6522,  0.0000,  0.0000],
        [85.7143, 85.0667,  0.0000],
        [69.2547, 70.4000, 88.3648]], device='cuda:0')
[Task 2 Finish] Global AA: 76.01	Global AF: 20.53
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788268552161753
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.4217909889177065e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.92560603415626e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.9152725239113266e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:8.11396505540074e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:0.060132186859846115
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.2845507707813795e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.2115493597828504e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.569500664634688e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:8.510075422130114e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966473610140383
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.052703504013436e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 74.53
[Task 1 Finish] Global Accuracy on Task 1: 83.20
tensor([[95.3416,  0.0000,  0.0000],
        [74.5342, 83.2000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 78.87	Global AF: 20.81
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.1943159228831064e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.35947350335897e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.517376555630449e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.705449558299989e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.117642031317928e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.4342267373734785e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 66.15
[Task 2 Finish] Global Accuracy on Task 1: 58.13
[Task 2 Finish] Global Accuracy on Task 2: 85.53
tensor([[95.3416,  0.0000,  0.0000],
        [74.5342, 83.2000,  0.0000],
        [66.1491, 58.1333, 85.5346]], device='cuda:0')
[I 2025-09-15 02:58:29,662] Trial 153 finished with value: 69.93899536132812 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 03:01:25,198] Trial 154 finished with value: 71.064697265625 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[Task 2 Finish] Global AA: 69.94	Global AF: 27.13
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:9.196899908303635e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.1274849942566334e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.158060172900548e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.314528179172328e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979230241384357
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.8403784052267724e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.6796418417518453e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.097943928638159e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.1907466385993075e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.749471371745528e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966479430906475
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.065626586971291e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 86.65
[Task 1 Finish] Global Accuracy on Task 1: 79.73
tensor([[95.6522,  0.0000,  0.0000],
        [86.6460, 79.7333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.19	Global AF: 9.01
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.0391333893931005e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.0522778204347105e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.220833210195508e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.573522754431792e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.50816892097572e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.9235086573820013e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 60.87
[Task 2 Finish] Global Accuracy on Task 1: 67.73
[Task 2 Finish] Global Accuracy on Task 2: 84.59
tensor([[95.6522,  0.0000,  0.0000],
        [86.6460, 79.7333,  0.0000],
        [60.8696, 67.7333, 84.5912]], device='cuda:0')
[Task 2 Finish] Global AA: 71.06	Global AF: 23.39
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378825108986348
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.636297014024791e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.168950350549096e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.9240103954487608e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.902254961500432e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.6620394777410183e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.870251065128059e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.092690796322131e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.5173735601337057e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.338614550431942e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.4362205869034028e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.4170372914820177e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.99
[Task 1 Finish] Global Accuracy on Task 1: 82.93
tensor([[95.0311,  0.0000,  0.0000],
        [81.9876, 82.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.46	Global AF: 13.04
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.1564433854971412e-09
[I 2025-09-15 03:04:08,302] Trial 155 finished with value: 72.37731170654297 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 03:07:00,620] Trial 156 finished with value: 71.68914031982422 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.897876797002823e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.292014131936696e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.3544142463703963e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.1756057739257812
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.0992573518109339e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 68.01
[Task 2 Finish] Global Accuracy on Task 1: 73.33
[Task 2 Finish] Global Accuracy on Task 2: 75.79
tensor([[95.0311,  0.0000,  0.0000],
        [81.9876, 82.9333,  0.0000],
        [68.0124, 73.3333, 75.7862]], device='cuda:0')
[Task 2 Finish] Global AA: 72.38	Global AF: 18.31
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:3.139465909463013e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.626743598303619e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.5915510021002888e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.194493086195905e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.1073685019246113e-08
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.3924654752048866e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.787905793004256e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.83393122804776e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.3120054749046233e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:2.857760139640675e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.000379664619686082
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.721248640457645e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.78
[Task 1 Finish] Global Accuracy on Task 1: 80.00
tensor([[94.4099,  0.0000,  0.0000],
        [84.7826, 80.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.39	Global AF: 9.63
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.071309093831246e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.2721913522639738e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.214999434395736e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.163232146860764e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.3432692725376967e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.776556065763884e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 71.74
[Task 2 Finish] Global Accuracy on Task 1: 68.80
[Task 2 Finish] Global Accuracy on Task 2: 74.53
tensor([[94.4099,  0.0000,  0.0000],
        [84.7826, 80.0000,  0.0000],
        [71.7391, 68.8000, 74.5283]], device='cuda:0')
[Task 2 Finish] Global AA: 71.69	Global AF: 16.94
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:8.323602918025585e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.569136818373011e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.4921579527538142e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.2685542333533704e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.642974976183268e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.514355166409302e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.229151083836371e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.2295932050321312e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.084883152901455e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.130068705279541e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
[I 2025-09-15 03:10:02,227] Trial 157 finished with value: 70.33085632324219 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 03:13:06,715] Trial 158 finished with value: 75.38710021972656 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
current_loss:0.002666698768734932
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:9.78806702356394e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.88
[Task 1 Finish] Global Accuracy on Task 1: 84.00
tensor([[95.0311,  0.0000,  0.0000],
        [78.8820, 84.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.44	Global AF: 16.15
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.0935438110593054e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.55469306504375e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.057268020498441e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.289147063715973e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.249589651867836e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.165071260635699e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 73.29
[Task 2 Finish] Global Accuracy on Task 1: 61.60
[Task 2 Finish] Global Accuracy on Task 2: 76.10
tensor([[95.0311,  0.0000,  0.0000],
        [78.8820, 84.0000,  0.0000],
        [73.2919, 61.6000, 76.1006]], device='cuda:0')
[Task 2 Finish] Global AA: 70.33	Global AF: 22.07
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788268552161753
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.76550862607661e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.028128471247669e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.509633694775971e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.77403244608854e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.0945677697549172e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 96.27
tensor([[96.2733,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 96.27	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.134012659446796e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.6506335187571608e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.6845179685052187e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.205600005555368e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.002666698768734932
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:0.04987136647105217
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 75.78
[Task 1 Finish] Global Accuracy on Task 1: 73.87
tensor([[96.2733,  0.0000,  0.0000],
        [75.7764, 73.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 74.82	Global AF: 20.50
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.38591093735397e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.380257516231836e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.743984897778944e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.940170022533664e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.086586400501972e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.25571181125639e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 75.78
[Task 2 Finish] Global Accuracy on Task 1: 76.80
[Task 2 Finish] Global Accuracy on Task 2: 73.58
tensor([[96.2733,  0.0000,  0.0000],
        [75.7764, 73.8667,  0.0000],
        [75.7764, 76.8000, 73.5849]], device='cuda:0')
[Task 2 Finish] Global AA: 75.39	Global AF: 8.78
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.17362380027771
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:0.00038310542004182935
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:9.051637772650167e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.459231483013639e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.838434818412509e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:8.831362863226389e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[I 2025-09-15 03:15:51,790] Trial 159 finished with value: 70.77384185791016 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 03:18:56,874] Trial 160 finished with value: 58.906490325927734 and parameters: {'num_recon_nodes': 1, 'beta': 0.01, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.240936242652424e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:0.06646177917718887
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.298358891041687e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.5961481015256425e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:5.646158540706381e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.153940135256164e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.47
[Task 1 Finish] Global Accuracy on Task 1: 77.33
tensor([[95.0311,  0.0000,  0.0000],
        [84.4721, 77.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.90	Global AF: 10.56
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.666299344817219e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.874535219911991e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.202579867966904e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.657004226693573e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:0.018517551943659782
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.962281141551728e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 77.64
[Task 2 Finish] Global Accuracy on Task 1: 74.93
[Task 2 Finish] Global Accuracy on Task 2: 59.75
tensor([[95.0311,  0.0000,  0.0000],
        [84.4721, 77.3333,  0.0000],
        [77.6398, 74.9333, 59.7484]], device='cuda:0')
[Task 2 Finish] Global AA: 70.77	Global AF: 9.90
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788239448331296
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.035672214655392e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.476784746884846e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.1313506515241443e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.3172733126509684e-08
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.295774457321102e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.256263202468858e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.4060903269784717e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:9.396490252555623e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.7168959576838745e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.026424281299114227
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.261224068573654e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.30
[Task 1 Finish] Global Accuracy on Task 1: 70.93
tensor([[94.4099,  0.0000,  0.0000],
        [82.2981, 70.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 76.62	Global AF: 12.11
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.393141016580728e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:2.815635780084591e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.9204982049103592e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.680815179902709e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.857931610428693e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:0.0010427035158500075
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 73.60
[Task 2 Finish] Global Accuracy on Task 1: 65.07
[Task 2 Finish] Global Accuracy on Task 2: 38.05
tensor([[94.4099,  0.0000,  0.0000],
        [82.2981, 70.9333,  0.0000],
        [73.6025, 65.0667, 38.0503]], device='cuda:0')
[Task 2 Finish] Global AA: 58.91	Global AF: 13.34
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
[I 2025-09-15 03:21:44,608] Trial 161 finished with value: 63.88715744018555 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
current_loss:0.00013788286014460027
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.837414775884838e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.1531145572662354
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:8.42568348424777e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:8.525610772913694e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.246339113667119e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.1839320634976502e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.902358519132122e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.837436007321116e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.319290008465316e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:6.616552861160585e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.1177574421594727e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 86.02
[Task 1 Finish] Global Accuracy on Task 1: 74.40
tensor([[95.3416,  0.0000,  0.0000],
        [86.0248, 74.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.21	Global AF: 9.32
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.534840612028916e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:0.02285819873213768
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:9.222980157375105e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.3213555805080546e-09
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.03627148265673e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.751457477996212e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 73.91
[Task 2 Finish] Global Accuracy on Task 1: 74.67
[Task 2 Finish] Global Accuracy on Task 2: 43.08
tensor([[95.3416,  0.0000,  0.0000],
        [86.0248, 74.4000,  0.0000],
        [73.9130, 74.6667, 43.0818]], device='cuda:0')
[Task 2 Finish] Global AA: 63.89	Global AF: 10.58
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.17362380027771
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:0.0003831062058452517
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.764622278472189e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:8.307806664831219e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.028774703788372e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.221067632734446e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:0.029233457520604134
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.607683401491869e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.6335862924351545e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.687559229665794e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:3.111904345320937e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.763912290847941e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.64
[Task 1 Finish] Global Accuracy on Task 1: 73.60
tensor([[95.6522,  0.0000,  0.0000],
        [77.6398, 73.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 75.62	Global AF: 18.01
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.177296062505945e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.666085933775378e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:9.329521599710233e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.345843129804905e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.27332796820923e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.364618914706966e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 72.05
[Task 2 Finish] Global Accuracy on Task 1: 72.80
[Task 2 Finish] Global Accuracy on Task 2: 35.22
[I 2025-09-15 03:24:42,677] Trial 162 finished with value: 60.02326965332031 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 03:27:50,547] Trial 163 finished with value: 60.0811767578125 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
tensor([[95.6522,  0.0000,  0.0000],
        [77.6398, 73.6000,  0.0000],
        [72.0497, 72.8000, 35.2201]], device='cuda:0')
[Task 2 Finish] Global AA: 60.02	Global AF: 12.20
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788283104076982
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.726046386518192e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.003271520363171e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.9537190188454474e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.52753065541367e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.5817227789513026e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.0349874290938033e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.778995532639385e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.618026127114263e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.0528086180627838e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:8.515257388097552e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.0559616776292273e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.30
[Task 1 Finish] Global Accuracy on Task 1: 77.60
tensor([[93.7888,  0.0000,  0.0000],
        [82.2981, 77.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.95	Global AF: 11.49
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.443677730809782e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.759520331302895e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.808990121205284e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.03872288763523102
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.5506478313074297e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.366473600938889e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 77.64
[Task 2 Finish] Global Accuracy on Task 1: 62.67
[Task 2 Finish] Global Accuracy on Task 2: 39.94
tensor([[93.7888,  0.0000,  0.0000],
        [82.2981, 77.6000,  0.0000],
        [77.6398, 62.6667, 39.9371]], device='cuda:0')
[Task 2 Finish] Global AA: 60.08	Global AF: 15.54
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788302021566778
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:7.700915460873148e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.51206208349231e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.2266253568427032e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.219451927272132e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:0.060132186859846115
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.296662635740802e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.899300409810792e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:9.431869729681353e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:8.607434209828568e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796647069975734
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:2.778008101333995e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.50
[Task 1 Finish] Global Accuracy on Task 1: 78.13
tensor([[94.7205,  0.0000,  0.0000],
        [79.5031, 78.1333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 78.82	Global AF: 15.22
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[I 2025-09-15 03:30:44,864] Trial 164 finished with value: 69.80707550048828 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 03:33:53,628] Trial 165 finished with value: 54.924678802490234 and parameters: {'num_recon_nodes': 1, 'beta': 0.01, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.649051557758526e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.494050852623445e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.655792501002566e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.780035451317332e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.781536360771611e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:0.033466536551713943
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 79.81
[Task 2 Finish] Global Accuracy on Task 1: 66.40
[Task 2 Finish] Global Accuracy on Task 2: 63.21
tensor([[94.7205,  0.0000,  0.0000],
        [79.5031, 78.1333,  0.0000],
        [79.8137, 66.4000, 63.2075]], device='cuda:0')
[Task 2 Finish] Global AA: 69.81	Global AF: 13.32
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788283104076982
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.5828602872858255e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.1732078903677916e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.218329491794236e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792113238945603
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.488851678199126e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.934769371965018e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.316648953370475e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.2903277335496455e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:0.06120007857680321
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:3.75179193268238e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.799200481464538e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 87.27
[Task 1 Finish] Global Accuracy on Task 1: 76.00
tensor([[94.7205,  0.0000,  0.0000],
        [87.2671, 76.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.63	Global AF: 7.45
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:2.67847660717635e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.64946623026907e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.064265673482282e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:2.830615464244346e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.7415057174119397e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.613757626474978e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 63.66
[Task 2 Finish] Global Accuracy on Task 1: 76.27
[Task 2 Finish] Global Accuracy on Task 2: 24.84
tensor([[94.7205,  0.0000,  0.0000],
        [87.2671, 76.0000,  0.0000],
        [63.6646, 76.2667, 24.8428]], device='cuda:0')
[Task 2 Finish] Global AA: 54.92	Global AF: 15.39
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788264186587185
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.291499543564782e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.967947330238644e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.186184342560352e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.951416109401976e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.340224568633033e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.0531194805096789e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.12480296982676e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:9.297337344449375e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.2260460424684538e-09
[I 2025-09-15 03:37:07,477] Trial 166 finished with value: 68.88053894042969 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 03:40:23,858] Trial 167 finished with value: 72.098876953125 and parameters: {'num_recon_nodes': 3, 'beta': 0.04, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966464878991246
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.565381571732587e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 85.71
[Task 1 Finish] Global Accuracy on Task 1: 78.40
tensor([[95.3416,  0.0000,  0.0000],
        [85.7143, 78.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.06	Global AF: 9.63
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.2521054193470604e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.527210993922949e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.761366383971733e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.520866152077588e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:2.845614854862788e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.0843803339463136e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 79.19
[Task 2 Finish] Global Accuracy on Task 1: 74.93
[Task 2 Finish] Global Accuracy on Task 2: 52.52
tensor([[95.3416,  0.0000,  0.0000],
        [85.7143, 78.4000,  0.0000],
        [79.1926, 74.9333, 52.5157]], device='cuda:0')
[Task 2 Finish] Global AA: 68.88	Global AF: 9.81
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788255455438048
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.446568834306277e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:9.503439146740789e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.048990752738348e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:8.844986409961564e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.004862082432112e-09
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.3101520979219572e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.749585890197807e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:2.1546238404557272e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.749747900019031e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:2.861608727755538e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.613775555524114e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.92
[Task 1 Finish] Global Accuracy on Task 1: 81.60
tensor([[94.7205,  0.0000,  0.0000],
        [82.9193, 81.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.26	Global AF: 11.80
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.660436894876057e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.2020477946350638e-09
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.556902798493525e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.038958860228206e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.470860514085075e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.013712223167488e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 65.22
[Task 2 Finish] Global Accuracy on Task 1: 62.40
[Task 2 Finish] Global Accuracy on Task 2: 88.68
tensor([[94.7205,  0.0000,  0.0000],
        [82.9193, 81.6000,  0.0000],
        [65.2174, 62.4000, 88.6792]], device='cuda:0')
[Task 2 Finish] Global AA: 72.10	Global AF: 24.35
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378842134727165
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.1448633670806885
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.1770631136442944e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.309314264958289e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.1193161952860464e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.7689997036662852e-11
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
[I 2025-09-15 03:43:28,545] Trial 168 finished with value: 64.56210327148438 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.8, 'num_epoch_g': 5}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 03:46:44,471] Trial 169 finished with value: 71.7124252319336 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.826812921050362e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.825305320923292e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:0.00020711960678454489
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.977100008853654e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666997000575066
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.82210249297799e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.99
[Task 1 Finish] Global Accuracy on Task 1: 79.20
tensor([[95.6522,  0.0000,  0.0000],
        [81.9876, 79.2000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.59	Global AF: 13.66
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.5691242456236125e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.379359847510699e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.774079547826716e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.728904100583577e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.5922323459705012e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.936645312651592e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 83.54
[Task 2 Finish] Global Accuracy on Task 1: 71.47
[Task 2 Finish] Global Accuracy on Task 2: 38.68
tensor([[95.6522,  0.0000,  0.0000],
        [81.9876, 79.2000,  0.0000],
        [83.5404, 71.4667, 38.6792]], device='cuda:0')
[Task 2 Finish] Global AA: 64.56	Global AF: 9.92
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788262731395662
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.485998405025839e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.1193366233896995e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.632450699761705e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.3290086808837032e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.002440849390723e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.267678155311927e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.8737626167618657e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.482546249271138e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:8.53211001849985e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966505624353886
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.724763051442096e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.50
[Task 1 Finish] Global Accuracy on Task 1: 81.87
tensor([[94.7205,  0.0000,  0.0000],
        [79.5031, 81.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.68	Global AF: 15.22
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.921669821162823e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:0.02285819873213768
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.948645854734423e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.4146714062165415e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.0646892256716e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.741581654561401e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 70.19
[Task 2 Finish] Global Accuracy on Task 1: 80.80
[Task 2 Finish] Global Accuracy on Task 2: 64.15
tensor([[94.7205,  0.0000,  0.0000],
        [79.5031, 81.8667,  0.0000],
        [70.1863, 80.8000, 64.1509]], device='cuda:0')
[Task 2 Finish] Global AA: 71.71	Global AF: 12.80
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[I 2025-09-15 03:50:00,088] Trial 170 finished with value: 65.41209411621094 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.4, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788229261990637
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:8.019035990791679e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.898071699812931e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.149969894979733e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.6720859686312224e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.168346418558343e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.234025600766358e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.694998834153807e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.30933899675523e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.6284681642916325e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:9.788632127083474e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:9.600388262143156e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 89.13
[Task 1 Finish] Global Accuracy on Task 1: 82.13
tensor([[95.0311,  0.0000,  0.0000],
        [89.1304, 82.1333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 85.63	Global AF: 5.90
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.761198905775757e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.012429053572134e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.897138805581847e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.803383692378091e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.595273883634121e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.087114146069439e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 53.42
[Task 2 Finish] Global Accuracy on Task 1: 57.60
[Task 2 Finish] Global Accuracy on Task 2: 85.22
tensor([[95.0311,  0.0000,  0.0000],
        [89.1304, 82.1333,  0.0000],
        [53.4161, 57.6000, 85.2201]], device='cuda:0')
[Task 2 Finish] Global AA: 65.41	Global AF: 33.07
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788262731395662
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.218950354686115e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.1982481380209435e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.619563230891856e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.5950396559105684e-08
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.411429472244265e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.582246331847784e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.140637525715476e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.796195745588761e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.2293104312277592e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026667050551623106
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.766314092880975e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.19
[Task 1 Finish] Global Accuracy on Task 1: 89.07
tensor([[95.0311,  0.0000,  0.0000],
        [79.1926, 89.0667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.13	Global AF: 15.84
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.497989451543674e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.380523414646234e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.369684696887589e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.00044972734758630395
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.062003594069608e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.1048186809858862e-09
[I 2025-09-15 03:53:23,182] Trial 171 finished with value: 73.03076171875 and parameters: {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 03:56:44,041] Trial 172 finished with value: 71.46540069580078 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 57.76
[Task 2 Finish] Global Accuracy on Task 1: 70.13
[Task 2 Finish] Global Accuracy on Task 2: 91.19
tensor([[95.0311,  0.0000,  0.0000],
        [79.1926, 89.0667,  0.0000],
        [57.7640, 70.1333, 91.1950]], device='cuda:0')
[Task 2 Finish] Global AA: 73.03	Global AF: 28.10
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788316573482007
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.3238589113839794e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.5607919401361414e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.760125739076358e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.755712655959201e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.577146717199554e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.971413281040782e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.840350980612641e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.2763256824507323e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.290851645689543e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966453237459064
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.411744941064001e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 85.09
[Task 1 Finish] Global Accuracy on Task 1: 81.87
tensor([[95.0311,  0.0000,  0.0000],
        [85.0932, 81.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.48	Global AF: 9.94
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.359006016725232e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.431238071449627e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.830366857027201e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.311983465259516e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.317307705254848e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.820480846769783e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 79.50
[Task 2 Finish] Global Accuracy on Task 1: 72.00
[Task 2 Finish] Global Accuracy on Task 2: 62.89
tensor([[95.0311,  0.0000,  0.0000],
        [85.0932, 81.8667,  0.0000],
        [79.5031, 72.0000, 62.8931]], device='cuda:0')
[Task 2 Finish] Global AA: 71.47	Global AF: 12.70
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788249634671956
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.942767389299775e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.2507098690051066e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.227377419814161e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792037568986416
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.994316320036887e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.6164555511651884e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.3553537459021214e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:0.0002071194612653926
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:2.631976581124462e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:8.676588891809445e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.896405668754824e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.37
[Task 1 Finish] Global Accuracy on Task 1: 84.00
tensor([[94.4099,  0.0000,  0.0000],
        [81.3665, 84.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.68	Global AF: 13.04
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[I 2025-09-15 03:59:41,369] Trial 173 finished with value: 71.33968353271484 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 04:02:57,058] Trial 174 finished with value: 76.1939926147461 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.5, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.5586779644749527e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:0.02285819873213768
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.911019368947223e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.919889661283207e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.4445310492792203e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.722561313703523e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 64.29
[Task 2 Finish] Global Accuracy on Task 1: 66.40
[Task 2 Finish] Global Accuracy on Task 2: 83.33
tensor([[94.4099,  0.0000,  0.0000],
        [81.3665, 84.0000,  0.0000],
        [64.2857, 66.4000, 83.3333]], device='cuda:0')
[Task 2 Finish] Global AA: 71.34	Global AF: 23.86
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:5.942160652416817e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.7944378195042816e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.714959451173172e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.061817714453355e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.8816264102383684e-08
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.221678562288389e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.74807892792262e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.664818365971655e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.0447996912077429e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.053552352256133e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.026424281299114227
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.906423600736787e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.23
[Task 1 Finish] Global Accuracy on Task 1: 81.87
tensor([[94.7205,  0.0000,  0.0000],
        [83.2298, 81.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.55	Global AF: 11.49
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.8994507355873935e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.1837679725346106e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.942923068744335e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.0414644702194664e-09
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.5985318330998837e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.765124488910089e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 74.53
[Task 2 Finish] Global Accuracy on Task 1: 70.40
[Task 2 Finish] Global Accuracy on Task 2: 83.65
tensor([[94.7205,  0.0000,  0.0000],
        [83.2298, 81.8667,  0.0000],
        [74.5342, 70.4000, 83.6478]], device='cuda:0')
[Task 2 Finish] Global AA: 76.19	Global AF: 15.83
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788243813905865
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.2539143057210822e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.007027017330131e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.276308834289978e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792145253159106
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.630326677634855e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.572062338783269e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.0957045820946263e-10
[I 2025-09-15 04:06:25,004] Trial 175 finished with value: 70.10697937011719 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.5, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 04:09:55,010] Trial 176 finished with value: 72.7225341796875 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.5, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.136194997617082e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.7638657201501928e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796643577516079
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.680770546831695e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.54
[Task 1 Finish] Global Accuracy on Task 1: 82.67
tensor([[95.3416,  0.0000,  0.0000],
        [83.5404, 82.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.10	Global AF: 11.80
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.0138605510690013e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.532519554649838e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.510640442909278e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.00044972740579396486
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.2544438821038284e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.261573954307153e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 76.09
[Task 2 Finish] Global Accuracy on Task 1: 58.13
[Task 2 Finish] Global Accuracy on Task 2: 76.10
tensor([[95.3416,  0.0000,  0.0000],
        [83.5404, 82.6667,  0.0000],
        [76.0870, 58.1333, 76.1006]], device='cuda:0')
[Task 2 Finish] Global AA: 70.11	Global AF: 21.89
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:5.572391437169699e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.7539126534747993e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.3436499690655523e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.679179655906694e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:4.18856238582066e-08
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.09392994662727e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.189214223934925e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.040881045914603e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.212271418450712e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.987967426930197e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:4.6482034887773693e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.014175298243771e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.02
[Task 1 Finish] Global Accuracy on Task 1: 85.07
tensor([[94.4099,  0.0000,  0.0000],
        [77.0186, 85.0667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.04	Global AF: 17.39
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.2542547262769403e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.530698316518311e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.978147114646617e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.557562353710523e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.115096874368618e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.391402407324165e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 69.88
[Task 2 Finish] Global Accuracy on Task 1: 70.93
[Task 2 Finish] Global Accuracy on Task 2: 77.36
tensor([[94.4099,  0.0000,  0.0000],
        [77.0186, 85.0667,  0.0000],
        [69.8758, 70.9333, 77.3585]], device='cuda:0')
[Task 2 Finish] Global AA: 72.72	Global AF: 19.33
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:8.439117182845735e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.678502585342414e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:0.02950146608054638
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.081769615169264e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:8.64502247566179e-10
[I 2025-09-15 04:13:03,338] Trial 177 finished with value: 65.7695541381836 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.4, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 04:16:37,407] Trial 178 finished with value: 67.61976623535156 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.175634365528481e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.469141026841044e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.1724545213052124e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.182968581569526e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.3342424094205967e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796651435550302
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.106120609139509e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 89.44
[Task 1 Finish] Global Accuracy on Task 1: 78.40
tensor([[95.6522,  0.0000,  0.0000],
        [89.4410, 78.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.92	Global AF: 6.21
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.2152031603207547e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.038570033948474e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.303950139674441e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:8.066848300458673e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.1481579020866661e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.541838737383898e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 84.16
[Task 2 Finish] Global Accuracy on Task 1: 72.27
[Task 2 Finish] Global Accuracy on Task 2: 40.88
tensor([[95.6522,  0.0000,  0.0000],
        [89.4410, 78.4000,  0.0000],
        [84.1615, 72.2667, 40.8805]], device='cuda:0')
[Task 2 Finish] Global AA: 65.77	Global AF: 8.81
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788223441224545
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:7.015881209326835e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.0085292601047513e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.378939155724737e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.313070373600624e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:9.416087909386306e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 96.27
tensor([[96.2733,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 96.27	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.174626618194452e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.770388723456364e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:2.950143906943481e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.0190536192666855e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:4.984188173295934e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.5310573919791182e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.61
[Task 1 Finish] Global Accuracy on Task 1: 77.33
tensor([[96.2733,  0.0000,  0.0000],
        [82.6087, 77.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.97	Global AF: 13.66
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.313113282667814e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.56537268994839e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.0620160306729076e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.101940619451796e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.623349563776969e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.768032552642353e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 76.09
[Task 2 Finish] Global Accuracy on Task 1: 75.20
[Task 2 Finish] Global Accuracy on Task 2: 51.57
tensor([[96.2733,  0.0000,  0.0000],
        [82.6087, 77.3333,  0.0000],
        [76.0870, 75.2000, 51.5723]], device='cuda:0')
[Task 2 Finish] Global AA: 67.62	Global AF: 11.16
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[I 2025-09-15 04:19:53,741] Trial 179 finished with value: 72.96693420410156 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:5.564601557317417e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.849267571354176e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.15315842628479
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.277299932489484e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.4133220815892855e-08
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:9.466508688049657e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.414250879911322e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.778336780755012e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.364725887853524e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.390019872768107e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666990015655756
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.271745428027998e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 88.20
[Task 1 Finish] Global Accuracy on Task 1: 78.13
tensor([[95.0311,  0.0000,  0.0000],
        [88.1988, 78.1333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.17	Global AF: 6.83
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.7407203456443199e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.237950852939207e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.517255706801507e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.03872288763523102
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.0840226494224225e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.696967649207238e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 70.19
[Task 2 Finish] Global Accuracy on Task 1: 65.07
[Task 2 Finish] Global Accuracy on Task 2: 83.65
tensor([[95.0311,  0.0000,  0.0000],
        [88.1988, 78.1333,  0.0000],
        [70.1863, 65.0667, 83.6478]], device='cuda:0')
[Task 2 Finish] Global AA: 72.97	Global AF: 18.96
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378823071718216
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.370676043308208e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.3413430366426837e-09
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.370744570245336e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.4038862395391334e-08
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.038915508124518e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.0616636458848916e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.951270504705008e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.307449591982703e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.517142410647267e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796647069975734
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.452207101936835e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.06
[Task 1 Finish] Global Accuracy on Task 1: 83.20
tensor([[94.0994,  0.0000,  0.0000],
        [81.0559, 83.2000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.13	Global AF: 13.04
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.2269152402877808
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.9194159029420916e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.369304528242026e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.6389067587249144e-10
[I 2025-09-15 04:23:09,209] Trial 180 finished with value: 71.10163879394531 and parameters: {'num_recon_nodes': 3, 'beta': 0.03, 'decay': 0.5, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 04:26:27,876] Trial 181 finished with value: 58.81272506713867 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.2895514917873356e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.191247680144897e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 78.26
[Task 2 Finish] Global Accuracy on Task 1: 74.67
[Task 2 Finish] Global Accuracy on Task 2: 60.38
tensor([[94.0994,  0.0000,  0.0000],
        [81.0559, 83.2000,  0.0000],
        [78.2609, 74.6667, 60.3774]], device='cuda:0')
[Task 2 Finish] Global AA: 71.10	Global AF: 12.19
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788302021566778
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.399878405005666e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.0857050248300766e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.294654880141138e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.3468045002038593e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.400720981540985e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.48
tensor([[93.4783,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.48	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.323719574183542e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.919115446204273e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.133239389110145e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.043600702694164e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796644741669297
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:0.04987136647105217
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.33
[Task 1 Finish] Global Accuracy on Task 1: 76.27
tensor([[93.4783,  0.0000,  0.0000],
        [77.3292, 76.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 76.80	Global AF: 16.15
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.084081099506534e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.460605939118125e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.354487019384237e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.793721058466872e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.41031133624881e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.047274849648062e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 69.57
[Task 2 Finish] Global Accuracy on Task 1: 79.20
[Task 2 Finish] Global Accuracy on Task 2: 27.67
tensor([[93.4783,  0.0000,  0.0000],
        [77.3292, 76.2667,  0.0000],
        [69.5652, 79.2000, 27.6730]], device='cuda:0')
[Task 2 Finish] Global AA: 58.81	Global AF: 10.49
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788248179480433
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.995156676126157e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:0.04181229695677757
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.799504682573286e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:8.971062781526484e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.595681223409144e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.028695432811702e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.99653279756518e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.597570267885544e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.0471112572326717e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.026424281299114227
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.6450983908455896e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.75
[Task 1 Finish] Global Accuracy on Task 1: 80.27
[I 2025-09-15 04:29:33,294] Trial 182 finished with value: 68.85775756835938 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 04:33:03,037] Trial 183 finished with value: 72.4866714477539 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.5, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
tensor([[94.4099,  0.0000,  0.0000],
        [80.7453, 80.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.51	Global AF: 13.66
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.663623376366388e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:0.02285819873213768
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.1231600094419036e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:8.448044486186745e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.4102057823211e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:0.0010427037486806512
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 74.22
[Task 2 Finish] Global Accuracy on Task 1: 70.40
[Task 2 Finish] Global Accuracy on Task 2: 61.95
tensor([[94.4099,  0.0000,  0.0000],
        [80.7453, 80.2667,  0.0000],
        [74.2236, 70.4000, 61.9497]], device='cuda:0')
[Task 2 Finish] Global AA: 68.86	Global AF: 15.03
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:3.7965044996646213e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:8.79564754363571e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.172504729562434e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.627153270599706e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:8.851967692180551e-08
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.159606548093109e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.459929730555757e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.31630209141565e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.42263559108369e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.1004985811524648e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796644741669297
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.5319439040115697e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.99
[Task 1 Finish] Global Accuracy on Task 1: 82.13
tensor([[93.7888,  0.0000,  0.0000],
        [81.9876, 82.1333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.06	Global AF: 11.80
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.2108430924584468e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.8309199711907809e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.290262200003838e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:8.770134063418311e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.782611139399819e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.082224948019018e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 77.33
[Task 2 Finish] Global Accuracy on Task 1: 77.87
[Task 2 Finish] Global Accuracy on Task 2: 62.26
tensor([[93.7888,  0.0000,  0.0000],
        [81.9876, 82.1333,  0.0000],
        [77.3292, 77.8667, 62.2641]], device='cuda:0')
[Task 2 Finish] Global AA: 72.49	Global AF: 10.36
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:5.024178850732142e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.811690655972313e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.1273154632007731e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.788802049875528e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792113238945603
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:0.060132186859846115
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[I 2025-09-15 04:36:18,804] Trial 184 finished with value: 72.6268081665039 and parameters: {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 04:39:34,339] Trial 185 finished with value: 65.94290161132812 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.5, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.469167034341751e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.205565588641605e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:2.421099432048379e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.931680619435497e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:6.534939256397365e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.842425515074524e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 73.91
[Task 1 Finish] Global Accuracy on Task 1: 86.40
tensor([[94.7205,  0.0000,  0.0000],
        [73.9130, 86.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.16	Global AF: 20.81
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.8053483414634e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.864190161768533e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:9.881594431604412e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.52131249106813e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.546455711906816e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.780362382663441e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 64.91
[Task 2 Finish] Global Accuracy on Task 1: 65.87
[Task 2 Finish] Global Accuracy on Task 2: 87.11
tensor([[94.7205,  0.0000,  0.0000],
        [73.9130, 86.4000,  0.0000],
        [64.9068, 65.8667, 87.1069]], device='cuda:0')
[Task 2 Finish] Global AA: 72.63	Global AF: 25.17
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788355863653123
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.5760505667781217e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.282917271363317e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:0.03505839407444
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.1282884322722e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.392999463145088e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.96
tensor([[95.9627,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.96	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:3.769547451959454e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.453199168949709e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.411144865519191e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.0132455985356614e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.002666700631380081
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.4148727744967005e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.78
[Task 1 Finish] Global Accuracy on Task 1: 79.47
tensor([[95.9627,  0.0000,  0.0000],
        [84.7826, 79.4667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.12	Global AF: 11.18
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:0.028870712965726852
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.1934485621978297e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.530971791678496e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.695086069401611e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.622916269906966e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.9809154316874356e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 77.02
[Task 2 Finish] Global Accuracy on Task 1: 69.87
[Task 2 Finish] Global Accuracy on Task 2: 50.94
tensor([[95.9627,  0.0000,  0.0000],
        [84.7826, 79.4667,  0.0000],
        [77.0186, 69.8667, 50.9434]], device='cuda:0')
[Task 2 Finish] Global AA: 65.94	Global AF: 14.27
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788270007353276
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.1164562597219003e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.845172596468217e-10
[I 2025-09-15 04:43:00,506] Trial 186 finished with value: 68.5329360961914 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.4, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 04:46:20,856] Trial 187 finished with value: 63.19315719604492 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:8.94538942919354e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.0974419151210668e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:9.764913322385382e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.5638179346774166e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.178945163715639e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.978730843736457e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.33285004833806e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666990015655756
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.426412262923066e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 75.16
[Task 1 Finish] Global Accuracy on Task 1: 84.00
tensor([[94.4099,  0.0000,  0.0000],
        [75.1553, 84.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.58	Global AF: 19.25
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.758565208540233e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.9315720123944686e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.148169361454904e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.6781079859029546e-09
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.719382190072508e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.037970206624777e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 58.70
[Task 2 Finish] Global Accuracy on Task 1: 66.40
[Task 2 Finish] Global Accuracy on Task 2: 80.50
tensor([[94.4099,  0.0000,  0.0000],
        [75.1553, 84.0000,  0.0000],
        [58.6957, 66.4000, 80.5031]], device='cuda:0')
[Task 2 Finish] Global AA: 68.53	Global AF: 26.66
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378825108986348
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.175568862370028e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:9.396404765382727e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:0.03505839407444
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.7493359528184556e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.2354521849999855e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 96.27
tensor([[96.2733,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 96.27	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:3.3624755757521996e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.593045719429426e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.1071044081489845e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.4142467197331143e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796651435550302
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.792990059345527e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.26
[Task 1 Finish] Global Accuracy on Task 1: 78.93
tensor([[96.2733,  0.0000,  0.0000],
        [78.2609, 78.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 78.60	Global AF: 18.01
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.5435387957249986e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:9.190921357316029e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.5044718804091417e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.18675991045825e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.089064418292935e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.4338954468229304e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 68.63
[Task 2 Finish] Global Accuracy on Task 1: 65.60
[Task 2 Finish] Global Accuracy on Task 2: 55.35
tensor([[96.2733,  0.0000,  0.0000],
        [78.2609, 78.9333,  0.0000],
        [68.6335, 65.6000, 55.3459]], device='cuda:0')
[Task 2 Finish] Global AA: 63.19	Global AF: 20.49
--------------------------------------------------
--------------------------------------------------
[I 2025-09-15 04:49:47,404] Trial 188 finished with value: 59.87193298339844 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 1.0, 'num_epoch_g': 10}. Best is trial 115 with value: 79.04704284667969.
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788268552161753
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.9548870017492845e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.15315842628479
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.706445788649205e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792037568986416
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.783418661169492e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.384912598633719e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.106596505186303e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.691409010744053e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.250727547727706e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666990015655756
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.395666856702121e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 73.60
[Task 1 Finish] Global Accuracy on Task 1: 83.73
tensor([[94.7205,  0.0000,  0.0000],
        [73.6025, 83.7333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 78.67	Global AF: 21.12
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.283983168207328e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.1339116312569786e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.861610558570817e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.077312069725394e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.139727532466054e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.093589521860565e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 68.94
[Task 2 Finish] Global Accuracy on Task 1: 68.53
[Task 2 Finish] Global Accuracy on Task 2: 42.14
tensor([[94.7205,  0.0000,  0.0000],
        [73.6025, 83.7333,  0.0000],
        [68.9441, 68.5333, 42.1384]], device='cuda:0')
[Task 2 Finish] Global AA: 59.87	Global AF: 20.49
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0010629924945533276
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.078490961096804e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.0515359683569443e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.459288021647524e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.02327685058116913
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.781734063210365e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.96
tensor([[95.9627,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.96	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.173394573316671e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.15088451891188e-08
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.745890678341084e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:0.06120007857680321
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796650271397084
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:2.8626093162564814e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 76.71
[Task 1 Finish] Global Accuracy on Task 1: 88.00
tensor([[95.9627,  0.0000,  0.0000],
        [76.7081, 88.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.35	Global AF: 19.25
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.988944895563009e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:2.743801574833782e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
[I 2025-09-15 04:52:54,799] Trial 189 finished with value: 66.8580322265625 and parameters: {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 04:56:16,725] Trial 190 finished with value: 64.02755737304688 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
current_loss:7.466607887529619e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.005411085612366e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.559541715882688e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.958412014310909e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 60.56
[Task 2 Finish] Global Accuracy on Task 1: 46.93
[Task 2 Finish] Global Accuracy on Task 2: 93.08
tensor([[95.9627,  0.0000,  0.0000],
        [76.7081, 88.0000,  0.0000],
        [60.5590, 46.9333, 93.0818]], device='cuda:0')
[Task 2 Finish] Global AA: 66.86	Global AF: 38.24
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788264186587185
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.2955694556923163e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.781667284348146e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.652733364198582e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.549837894276322e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.4129393210993157e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.4901898603980612e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.181364836128523e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.802641700469735e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.804067616464124e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966464878991246
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:9.45558520371037e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.43
[Task 1 Finish] Global Accuracy on Task 1: 76.27
tensor([[94.4099,  0.0000,  0.0000],
        [80.4348, 76.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 78.35	Global AF: 13.98
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.0792430282791088e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.072644054277987e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.766754296310239e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.733053866028513e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.745229375049178e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.523315859181423e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 71.43
[Task 2 Finish] Global Accuracy on Task 1: 76.00
[Task 2 Finish] Global Accuracy on Task 2: 44.65
tensor([[94.4099,  0.0000,  0.0000],
        [80.4348, 76.2667,  0.0000],
        [71.4286, 76.0000, 44.6541]], device='cuda:0')
[Task 2 Finish] Global AA: 64.03	Global AF: 11.62
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:8.281853536296069e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.2248129177550027e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:9.343299467445831e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.699976436344343e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.9783241711479604e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.149072362404695e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 96.27
tensor([[96.2733,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 96.27	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.197605289555042e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.157355181279911e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:2.0118445798189555e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.015332233375801e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966438685543835
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.33309563177653e-10
[I 2025-09-15 04:59:24,332] Trial 191 finished with value: 70.75733947753906 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 05:02:32,484] Trial 192 finished with value: 67.4027328491211 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.23
[Task 1 Finish] Global Accuracy on Task 1: 85.60
tensor([[96.2733,  0.0000,  0.0000],
        [83.2298, 85.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.41	Global AF: 13.04
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.3278584898301915e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.4724005054952443e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.121722018193054e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.833151656669088e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.078457434466884e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.619827936342858e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 63.98
[Task 2 Finish] Global Accuracy on Task 1: 62.13
[Task 2 Finish] Global Accuracy on Task 2: 86.16
tensor([[96.2733,  0.0000,  0.0000],
        [83.2298, 85.6000,  0.0000],
        [63.9752, 62.1333, 86.1635]], device='cuda:0')
[Task 2 Finish] Global AA: 70.76	Global AF: 27.88
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788243813905865
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.6557157034302605e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.490620180736983e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.1108011177540789e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.0551268747605036e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:9.339673479047406e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 92.86
tensor([[92.8571,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 92.86	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.840741389486539e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.719744040038165e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.654459317965376e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.765792370799772e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:7.019985148737362e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.953492391938767e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.81
[Task 1 Finish] Global Accuracy on Task 1: 84.27
tensor([[92.8571,  0.0000,  0.0000],
        [79.8137, 84.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.04	Global AF: 13.04
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.749678983451133e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.4240299484622483e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.647702305822122e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.03872288763523102
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.092569226900935e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.241177102379481e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 60.25
[Task 2 Finish] Global Accuracy on Task 1: 62.40
[Task 2 Finish] Global Accuracy on Task 2: 79.56
tensor([[92.8571,  0.0000,  0.0000],
        [79.8137, 84.2667,  0.0000],
        [60.2484, 62.4000, 79.5597]], device='cuda:0')
[Task 2 Finish] Global AA: 67.40	Global AF: 27.24
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788302021566778
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.857557467374818e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.647298905233413e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.912661554281385e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.681005276261033e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:8.780893234749954e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[I 2025-09-15 05:05:29,099] Trial 193 finished with value: 73.76402282714844 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 05:08:24,167] Trial 194 finished with value: 71.44224548339844 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.218958846839541e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.298842475909282e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.0712025710901685e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.4512592239057653e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666992343962193
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.6488892463104605e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.26
[Task 1 Finish] Global Accuracy on Task 1: 87.47
tensor([[95.6522,  0.0000,  0.0000],
        [78.2609, 87.4667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.86	Global AF: 17.39
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:0.028870712965726852
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:0.02294304035604
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:2.609035210099364e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:9.197489991841223e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.39213079636869e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.817993781713881e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 67.08
[Task 2 Finish] Global Accuracy on Task 1: 67.73
[Task 2 Finish] Global Accuracy on Task 2: 86.48
tensor([[95.6522,  0.0000,  0.0000],
        [78.2609, 87.4667,  0.0000],
        [67.0807, 67.7333, 86.4780]], device='cuda:0')
[Task 2 Finish] Global AA: 73.76	Global AF: 24.15
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:5.502669431223239e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:0.0008667525253258646
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.808148572152618e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.040117879660187e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.65422605905519e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.1585850057116431e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.3170028401177092e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:9.365158648577676e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.2642217273040046e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:0.06120007857680321
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966464878991246
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.746672499500448e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.16
[Task 1 Finish] Global Accuracy on Task 1: 80.27
tensor([[94.4099,  0.0000,  0.0000],
        [84.1615, 80.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.21	Global AF: 10.25
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.565311627682036e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.871750863306602e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.727238683306268e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.940098495888947e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.1756057739257812
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.66658300680001e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 74.22
[Task 2 Finish] Global Accuracy on Task 1: 76.27
[Task 2 Finish] Global Accuracy on Task 2: 63.84
tensor([[94.4099,  0.0000,  0.0000],
        [84.1615, 80.2667,  0.0000],
        [74.2236, 76.2667, 63.8365]], device='cuda:0')
[Task 2 Finish] Global AA: 71.44	Global AF: 12.09
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378837478114292
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.782996221308622e-10
[I 2025-09-15 05:11:33,003] Trial 195 finished with value: 70.55717468261719 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.884202652379656e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.90195187061471e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.261446833770833e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.4586556668946287e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.418545943162826e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.703584271543605e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.833863640589357e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.8539495494351854e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:3.627419753460259e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.487786253726256e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 85.71
[Task 1 Finish] Global Accuracy on Task 1: 82.93
tensor([[94.7205,  0.0000,  0.0000],
        [85.7143, 82.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.32	Global AF: 9.01
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.160805282069305e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.0746760148450107e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.871141350866083e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.00044972781324759126
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.233052991991059e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.2868129894982872e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 73.91
[Task 2 Finish] Global Accuracy on Task 1: 77.07
[Task 2 Finish] Global Accuracy on Task 2: 60.69
tensor([[94.7205,  0.0000,  0.0000],
        [85.7143, 82.9333,  0.0000],
        [73.9130, 77.0667, 60.6918]], device='cuda:0')
[Task 2 Finish] Global AA: 70.56	Global AF: 13.34
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378825108986348
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.649706842827726e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.532236890815057e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:0.000142718170536682
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:4.3293954532508394e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.1505103536535444e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.56712739743881e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.3527682579960185e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.329519768894954e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.2710393555189796e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:7.646800970206868e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.979622045934832e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.02
[Task 1 Finish] Global Accuracy on Task 1: 84.27
tensor([[94.0994,  0.0000,  0.0000],
        [77.0186, 84.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.64	Global AF: 17.08
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.662031175139418e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:9.899308039962307e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.137099191530268e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.027724430701653e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.4399620091617464e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:9.03111252448241e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 56.83
[Task 2 Finish] Global Accuracy on Task 1: 47.47
[Task 2 Finish] Global Accuracy on Task 2: 88.68
tensor([[94.0994,  0.0000,  0.0000],
        [77.0186, 84.2667,  0.0000],
        [56.8323, 47.4667, 88.6792]], device='cuda:0')
[I 2025-09-15 05:14:42,889] Trial 196 finished with value: 64.3260726928711 and parameters: {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 05:17:47,090] Trial 197 finished with value: 67.58785247802734 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[Task 2 Finish] Global AA: 64.33	Global AF: 37.03
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.2746294020260507e-09
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.265871710375848e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.072619239740675e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.0562262175994874e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.3664821096881496e-07
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.504973226739708e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.999747365592611e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.353623655501849e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:0.041359443217515945
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.4341722254229694e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:3.5593699099223386e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.3661640969361315e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.16
[Task 1 Finish] Global Accuracy on Task 1: 81.60
tensor([[95.0311,  0.0000,  0.0000],
        [84.1615, 81.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.88	Global AF: 10.87
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.0791209037464e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.2468596155557066e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.274619878179124e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.030684426694961e-09
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.747982562669506e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.3318572900675747e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 70.50
[Task 2 Finish] Global Accuracy on Task 1: 65.60
[Task 2 Finish] Global Accuracy on Task 2: 66.67
tensor([[95.0311,  0.0000,  0.0000],
        [84.1615, 81.6000,  0.0000],
        [70.4969, 65.6000, 66.6667]], device='cuda:0')
[Task 2 Finish] Global AA: 67.59	Global AF: 20.27
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:5.728177931985101e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.655441115415272e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.565214648648123e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.4852878649218582e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.820578629136321e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:9.008732093640504e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:0.00011570889910217375
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.520362500455178e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.3115216690451348e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.604068403248675e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666990015655756
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.1857970402055e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.19
[Task 1 Finish] Global Accuracy on Task 1: 81.33
tensor([[94.7205,  0.0000,  0.0000],
        [79.1926, 81.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.26	Global AF: 15.53
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.466184561595753e-10
[I 2025-09-15 05:20:56,601] Trial 198 finished with value: 62.87919235229492 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 05:23:59,268] Trial 199 finished with value: 50.98595428466797 and parameters: {'num_recon_nodes': 3, 'beta': 0.09999999999999999, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.172581334951133e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.037767508182412e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497273766901344
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:9.151623903136397e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.0866829658340293e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 73.91
[Task 2 Finish] Global Accuracy on Task 1: 63.47
[Task 2 Finish] Global Accuracy on Task 2: 51.26
tensor([[94.7205,  0.0000,  0.0000],
        [79.1926, 81.3333,  0.0000],
        [73.9130, 63.4667, 51.2579]], device='cuda:0')
[Task 2 Finish] Global AA: 62.88	Global AF: 19.34
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.4610940235471048e-09
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.058118368594933e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.839108251417315e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.316905332148792e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.011169453197681e-09
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.295387908051282e-09
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 92.86
tensor([[92.8571,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 92.86	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.995136219740573e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:9.469129924610797e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.5046957003181944e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.63501539768896e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966459058225155
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.337265239826252e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 74.84
[Task 1 Finish] Global Accuracy on Task 1: 88.00
tensor([[92.8571,  0.0000,  0.0000],
        [74.8447, 88.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.42	Global AF: 18.01
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.0133363037567733e-09
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:0.02285819873213768
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.902496990119801e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.2616534483811392e-09
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.277566244605737e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:0.033466536551713943
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 33.85
[Task 2 Finish] Global Accuracy on Task 1: 32.00
[Task 2 Finish] Global Accuracy on Task 2: 87.11
tensor([[92.8571,  0.0000,  0.0000],
        [74.8447, 88.0000,  0.0000],
        [33.8509, 32.0000, 87.1069]], device='cuda:0')
[Task 2 Finish] Global AA: 50.99	Global AF: 57.50
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:5.900435695593842e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.1656802190174176e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.032141535745495e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.880048032340767e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.623366884308865e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:0.060132186859846115
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.385633688488213e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.151364335098663e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.165719353326324e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:8.286911157284749e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
[I 2025-09-15 05:27:10,561] Trial 200 finished with value: 66.76756286621094 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 5}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 05:30:25,886] Trial 201 finished with value: 66.02696228027344 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
current_loss:6.191581691794568e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.344521019663318e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 72.67
[Task 1 Finish] Global Accuracy on Task 1: 81.60
tensor([[94.7205,  0.0000,  0.0000],
        [72.6708, 81.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 77.14	Global AF: 22.05
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.633157746347649e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.239226523265586e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.2838524687808217e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.796415652488008e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.457930218888407e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.2430541585526385e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 59.94
[Task 2 Finish] Global Accuracy on Task 1: 85.33
[Task 2 Finish] Global Accuracy on Task 2: 55.03
tensor([[94.7205,  0.0000,  0.0000],
        [72.6708, 81.6000,  0.0000],
        [59.9379, 85.3333, 55.0314]], device='cuda:0')
[Task 2 Finish] Global AA: 66.77	Global AF: 15.52
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:8.033116949412999e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.726060819417512e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.760913885348828e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.0369601843862597e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.299304883799039e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.2441427887921463e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.4083189059377332e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.1447772991531906e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.1940568533930218e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.232730691088875e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.026424281299114227
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.959904071315634e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.30
[Task 1 Finish] Global Accuracy on Task 1: 77.33
tensor([[93.7888,  0.0000,  0.0000],
        [82.2981, 77.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.82	Global AF: 11.49
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:2.678105792686125e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.895757133027701e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.262537155521386e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.7175356969989508e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.1259543297725827e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.858630164861211e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 66.77
[Task 2 Finish] Global Accuracy on Task 1: 70.93
[Task 2 Finish] Global Accuracy on Task 2: 60.38
tensor([[93.7888,  0.0000,  0.0000],
        [82.2981, 77.3333,  0.0000],
        [66.7702, 70.9333, 60.3774]], device='cuda:0')
[Task 2 Finish] Global AA: 66.03	Global AF: 16.71
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788299111183733
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.97900284837749e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.1709432302129414e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:9.812926027308322e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.3502684243226213e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.1063066018834888e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
[I 2025-09-15 05:33:24,281] Trial 202 finished with value: 73.07147216796875 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 05:36:28,418] Trial 203 finished with value: 77.03205871582031 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.260706315013408e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.84708923103949e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.893247113584408e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:0.06120007857680321
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.026424281299114227
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.033144374027131e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 85.09
[Task 1 Finish] Global Accuracy on Task 1: 82.67
tensor([[95.0311,  0.0000,  0.0000],
        [85.0932, 82.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.88	Global AF: 9.94
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.2378883473829205e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:9.189516370078366e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.078445524693166e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.00044972760952077806
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.139872418676191e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.2327483185111703e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 69.25
[Task 2 Finish] Global Accuracy on Task 1: 70.40
[Task 2 Finish] Global Accuracy on Task 2: 79.56
tensor([[95.0311,  0.0000,  0.0000],
        [85.0932, 82.6667,  0.0000],
        [69.2547, 70.4000, 79.5597]], device='cuda:0')
[Task 2 Finish] Global AA: 73.07	Global AF: 19.02
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:8.564590703308284e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.450176255803683e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.619557207405592e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.346748906312257e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979202883783728
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.50264003964773e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.75472511468422e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.953556288431969e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.343330222729037e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.385797446384345e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026667241472750902
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.333554791737583e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 56.52
[Task 1 Finish] Global Accuracy on Task 1: 79.47
tensor([[93.7888,  0.0000,  0.0000],
        [56.5217, 79.4667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 67.99	Global AF: 37.27
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.4902101774794119e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.631255627416067e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.638598477020196e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497278423514217
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.981530353833421e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.0369953784561403e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 69.25
[Task 2 Finish] Global Accuracy on Task 1: 72.53
[Task 2 Finish] Global Accuracy on Task 2: 89.31
tensor([[93.7888,  0.0000,  0.0000],
        [56.5217, 79.4667,  0.0000],
        [69.2547, 72.5333, 89.3082]], device='cuda:0')
[Task 2 Finish] Global AA: 77.03	Global AF: 15.73
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.[I 2025-09-15 05:39:41,229] Trial 204 finished with value: 67.60884857177734 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.

[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788264186587185
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.961369093336998e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:0.029476601630449295
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:0.00014271814143285155
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:8.428920339476065e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.01553235107599e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.0651766408086303e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.124205976729911e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:9.235616160729876e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.903240036213674e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.1037982750039532e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.892984681985183e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.99
[Task 1 Finish] Global Accuracy on Task 1: 85.87
tensor([[95.0311,  0.0000,  0.0000],
        [81.9876, 85.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.93	Global AF: 13.04
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.1834996316295587e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.9721581579499343e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.140142200765752e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.4670878107666567e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.5622428057612296e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.702927491884168e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 61.49
[Task 2 Finish] Global Accuracy on Task 1: 53.60
[Task 2 Finish] Global Accuracy on Task 2: 87.74
tensor([[95.0311,  0.0000,  0.0000],
        [81.9876, 85.8667,  0.0000],
        [61.4907, 53.6000, 87.7358]], device='cuda:0')
[Task 2 Finish] Global AA: 67.61	Global AF: 32.90
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788320939056575
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:7.984037875274907e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.407374796348677e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:9.037864345806668e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.0537013039879639e-08
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.343374242019252e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.2394150422933023e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.913621259345803e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.328218115138952e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.829661670591179e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.002666698768734932
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:2.570016421898913e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.81
[Task 1 Finish] Global Accuracy on Task 1: 80.00
tensor([[95.3416,  0.0000,  0.0000],
        [79.8137, 80.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.91	Global AF: 15.53
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:0.03189568594098091
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.0223289992339346e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.0709689801657873e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.852650031279438e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.286252546810033e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.4326756154511315e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[I 2025-09-15 05:42:50,750] Trial 205 finished with value: 71.5792465209961 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 05:45:55,416] Trial 206 finished with value: 69.47477722167969 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[Task 2 Finish] Global Accuracy on Task 0: 77.95
[Task 2 Finish] Global Accuracy on Task 1: 75.47
[Task 2 Finish] Global Accuracy on Task 2: 61.32
tensor([[95.3416,  0.0000,  0.0000],
        [79.8137, 80.0000,  0.0000],
        [77.9503, 75.4667, 61.3208]], device='cuda:0')
[Task 2 Finish] Global AA: 71.58	Global AF: 10.96
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:7.268206037025493e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.7098371596933077e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.70605562799642e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:8.296545672692446e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.807031687789845e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.540932795395804e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 92.55
tensor([[92.5466,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 92.55	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:3.5096398010026064e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.352681743340469e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.420988823447772e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:8.140527141264897e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796645032707602
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.88576401558305e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.85
[Task 1 Finish] Global Accuracy on Task 1: 80.80
tensor([[92.5466,  0.0000,  0.0000],
        [83.8509, 80.8000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.33	Global AF: 8.70
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.892116322099184e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.561232668289563e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:9.343574802755938e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.99626404085285e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.661118158111321e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.0130006833364291e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 75.47
[Task 2 Finish] Global Accuracy on Task 1: 72.27
[Task 2 Finish] Global Accuracy on Task 2: 60.69
tensor([[92.5466,  0.0000,  0.0000],
        [83.8509, 80.8000,  0.0000],
        [75.4658, 72.2667, 60.6918]], device='cuda:0')
[Task 2 Finish] Global AA: 69.47	Global AF: 12.81
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.0540390782409759e-09
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.0348290002681892e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.5993836517155273e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.8178832317825595e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:4.958167765245491e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.490372766483233e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.068484048604716e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.7335573521701804e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.886529514358529e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.6054364782025488e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666985359042883
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.1567629893712876e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.06
[Task 1 Finish] Global Accuracy on Task 1: 85.87
tensor([[94.7205,  0.0000,  0.0000],
        [81.0559, 85.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.46	Global AF: 13.66
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[I 2025-09-15 05:49:08,851] Trial 207 finished with value: 74.69949340820312 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 05:52:17,264] Trial 208 finished with value: 63.2156982421875 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.61871138294157e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.9880002088967785e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.4886893939802803e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.327216056118857e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.178708767899053e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.085355472163485e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 66.77
[Task 2 Finish] Global Accuracy on Task 1: 66.13
[Task 2 Finish] Global Accuracy on Task 2: 91.19
tensor([[94.7205,  0.0000,  0.0000],
        [81.0559, 85.8667,  0.0000],
        [66.7702, 66.1333, 91.1950]], device='cuda:0')
[Task 2 Finish] Global AA: 74.70	Global AF: 23.84
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0010369211668148637
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.550393117863649e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:2.8847232935724776e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.200527899314352e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.272226626968802e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.0212094503359026e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.93463120260418e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.211727160947532e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.4944366844591457e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.0847533982172308e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796643577516079
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:9.99878624341477e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.61
[Task 1 Finish] Global Accuracy on Task 1: 77.87
tensor([[94.7205,  0.0000,  0.0000],
        [82.6087, 77.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.24	Global AF: 12.11
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.30373123408134e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.528660390081598e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.428375444121002e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.0395969902462525e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.0957826868107645e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.7501282367771154e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 81.06
[Task 2 Finish] Global Accuracy on Task 1: 57.33
[Task 2 Finish] Global Accuracy on Task 2: 51.26
tensor([[94.7205,  0.0000,  0.0000],
        [82.6087, 77.8667,  0.0000],
        [81.0559, 57.3333, 51.2579]], device='cuda:0')
[Task 2 Finish] Global AA: 63.22	Global AF: 17.10
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788262731395662
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.3379769514543227e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.7582640898794466e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.1620390467400625e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.003927993132208e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:0.060132186859846115
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.095931230440613e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:9.977563220076036e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
[I 2025-09-15 05:55:20,915] Trial 209 finished with value: 73.00761413574219 and parameters: {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 05:58:20,627] Trial 210 finished with value: 71.96817016601562 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
current_loss:4.291997313110585e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.469667053668246e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666992343962193
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.378298055333744e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.64
[Task 1 Finish] Global Accuracy on Task 1: 84.27
tensor([[94.4099,  0.0000,  0.0000],
        [77.6398, 84.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.95	Global AF: 16.77
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:0.031900472939014435
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.47881684465068e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.796374019124585e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.673821967810966e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.800733227090404e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.421455979120026e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 64.29
[Task 2 Finish] Global Accuracy on Task 1: 64.80
[Task 2 Finish] Global Accuracy on Task 2: 89.94
tensor([[94.4099,  0.0000,  0.0000],
        [77.6398, 84.2667,  0.0000],
        [64.2857, 64.8000, 89.9371]], device='cuda:0')
[Task 2 Finish] Global AA: 73.01	Global AF: 24.80
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:7.815087466056525e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.96080787559805e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:0.04181229695677757
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.086864983740782e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.379022894822725e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.7449129641189387e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.187152903232459e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.451536276903425e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.304003902750765e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.352768311401746e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026667003985494375
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.494614373548814e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 88.20
[Task 1 Finish] Global Accuracy on Task 1: 84.00
tensor([[94.4099,  0.0000,  0.0000],
        [88.1988, 84.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 86.10	Global AF: 6.21
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.651438206299986e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.673155196144307e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.035750870798552e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.564159328257489e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.0978349340717841e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.653876258167486e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 79.19
[Task 2 Finish] Global Accuracy on Task 1: 74.13
[Task 2 Finish] Global Accuracy on Task 2: 62.58
tensor([[94.4099,  0.0000,  0.0000],
        [88.1988, 84.0000,  0.0000],
        [79.1926, 74.1333, 62.5786]], device='cuda:0')
[Task 2 Finish] Global AA: 71.97	Global AF: 12.54
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788274372927845
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:0.028364455327391624
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.629122918320405e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:9.299560010944674e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:9.65402868757792e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:0.060132186859846115
[I 2025-09-15 06:01:23,625] Trial 211 finished with value: 69.30415344238281 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 06:04:36,626] Trial 212 finished with value: 76.26383972167969 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.309397590354422e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.953272012668378e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.720502015473585e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.502341443059834e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666992343962193
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.093137773164557e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.02
[Task 1 Finish] Global Accuracy on Task 1: 85.33
tensor([[95.0311,  0.0000,  0.0000],
        [77.0186, 85.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.18	Global AF: 18.01
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.739093255132445e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.87300366724952e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.121863016517182e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.528533907397161e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.843936918241809e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.928807917359279e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 60.56
[Task 2 Finish] Global Accuracy on Task 1: 62.13
[Task 2 Finish] Global Accuracy on Task 2: 85.22
tensor([[95.0311,  0.0000,  0.0000],
        [77.0186, 85.3333,  0.0000],
        [60.5590, 62.1333, 85.2201]], device='cuda:0')
[Task 2 Finish] Global AA: 69.30	Global AF: 28.84
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0010369210503995419
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:8.615736457606715e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.4569343509407418e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.720771634187827e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.687402883034707e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.956075715436327e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.687474073454382e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.3908615632304304e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.98637878052233e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.814058761683839e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:4.956511312492751e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.60605137364567e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.02
[Task 1 Finish] Global Accuracy on Task 1: 84.00
tensor([[95.0311,  0.0000,  0.0000],
        [77.0186, 84.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.51	Global AF: 18.01
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.4125247638219207e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:2.833098200483164e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.112857583862592e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.194392304121777e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.586022950281432e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.197098224523188e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 69.88
[Task 2 Finish] Global Accuracy on Task 1: 73.07
[Task 2 Finish] Global Accuracy on Task 2: 85.85
tensor([[95.0311,  0.0000,  0.0000],
        [77.0186, 84.0000,  0.0000],
        [69.8758, 73.0667, 85.8491]], device='cuda:0')
[Task 2 Finish] Global AA: 76.26	Global AF: 18.04
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[I 2025-09-15 06:07:38,202] Trial 213 finished with value: 68.12403869628906 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:5.284523929560692e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.6260575108617559e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.15315842628479
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.79467093700481e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.1976126191324283e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:0.060132186859846115
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:3.6227598698701513e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.352100594992805e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.0552723139767295e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.237347305315666e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:4.651145579792626e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.645011207950802e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 86.02
[Task 1 Finish] Global Accuracy on Task 1: 78.13
tensor([[94.7205,  0.0000,  0.0000],
        [86.0248, 78.1333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.08	Global AF: 8.70
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.939476605514415e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:9.223308783390394e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.684869490238611e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.833114074566993e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.766965486906031e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.2793248682640979e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 65.22
[Task 2 Finish] Global Accuracy on Task 1: 51.73
[Task 2 Finish] Global Accuracy on Task 2: 87.42
tensor([[94.7205,  0.0000,  0.0000],
        [86.0248, 78.1333,  0.0000],
        [65.2174, 51.7333, 87.4214]], device='cuda:0')
[Task 2 Finish] Global AA: 68.12	Global AF: 27.95
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788262731395662
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.722395821083914e-11
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.084776654231462e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:0.03505839407444
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.471749749322072e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.100411287235374e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:0.029480764642357826
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.692348897274769e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.962690813847814e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.072978786519911e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966493982821703
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.821383623569545e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.47
[Task 1 Finish] Global Accuracy on Task 1: 82.40
tensor([[94.4099,  0.0000,  0.0000],
        [84.4721, 82.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.44	Global AF: 9.94
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.308618462012248e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.508477256086167e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.1252879739132027e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.795766561649373e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.022480292244836e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
[I 2025-09-15 06:10:40,135] Trial 214 finished with value: 75.29689025878906 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 06:13:41,254] Trial 215 finished with value: 63.671539306640625 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
current_loss:8.615499424990958e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 73.29
[Task 2 Finish] Global Accuracy on Task 1: 71.47
[Task 2 Finish] Global Accuracy on Task 2: 81.13
tensor([[94.4099,  0.0000,  0.0000],
        [84.4721, 82.4000,  0.0000],
        [73.2919, 71.4667, 81.1321]], device='cuda:0')
[Task 2 Finish] Global AA: 75.30	Global AF: 16.03
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788268552161753
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.0051965926294315e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:9.080273755124324e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.9275670776485185e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:9.474482309812515e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:9.062546268978622e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.48
tensor([[93.4783,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.48	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.466285533221708e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.75677347405923e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.042146534681933e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.4539339732166923e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.026424281299114227
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.618458641722725e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 76.09
[Task 1 Finish] Global Accuracy on Task 1: 81.87
tensor([[93.4783,  0.0000,  0.0000],
        [76.0870, 81.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 78.98	Global AF: 17.39
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.323716467664497e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.7793032592325915e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.1877698824491745e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.49242445863274e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.037996851977368e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.477458652260793e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 59.94
[Task 2 Finish] Global Accuracy on Task 1: 63.47
[Task 2 Finish] Global Accuracy on Task 2: 67.61
tensor([[93.4783,  0.0000,  0.0000],
        [76.0870, 81.8667,  0.0000],
        [59.9379, 63.4667, 67.6101]], device='cuda:0')
[Task 2 Finish] Global AA: 63.67	Global AF: 25.97
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:5.171727490704825e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.607000171295226e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.472252899238697e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.036421917876567e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.2239276259151666e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.2208410938316945e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.315785282597687e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.70491443080212e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.683851722615429e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.95706048325917e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:4.256683616699064e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.623197711443709e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 90.68
[Task 1 Finish] Global Accuracy on Task 1: 76.53
tensor([[94.0994,  0.0000,  0.0000],
        [90.6832, 76.5333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.61	Global AF: 3.42
--------------------------------------------------
[I 2025-09-15 06:16:52,857] Trial 216 finished with value: 68.52948760986328 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 06:20:05,387] Trial 217 finished with value: 65.57324981689453 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.2993460751786756e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:0.02285819873213768
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.7234423877485767e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.8457183004194633e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.650497930138499e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.351554589414718e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 71.12
[Task 2 Finish] Global Accuracy on Task 1: 77.87
[Task 2 Finish] Global Accuracy on Task 2: 56.60
tensor([[94.0994,  0.0000,  0.0000],
        [90.6832, 76.5333,  0.0000],
        [71.1180, 77.8667, 56.6038]], device='cuda:0')
[Task 2 Finish] Global AA: 68.53	Global AF: 10.82
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788245269097388
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:9.563505543042083e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.4127051184995594e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.453310191252172e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979202883783728
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:9.361642572258688e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.843597993328899e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.475083471509265e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.755132954059604e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.284631538453709e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666985359042883
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.923088213817152e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.57
[Task 1 Finish] Global Accuracy on Task 1: 77.87
tensor([[95.3416,  0.0000,  0.0000],
        [78.5714, 77.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 78.22	Global AF: 16.77
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.2814956873441474e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.548599050861583e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.5416842791846648e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497275804169476
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.637527943415989e-08
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.547456076257731e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 61.18
[Task 2 Finish] Global Accuracy on Task 1: 57.87
[Task 2 Finish] Global Accuracy on Task 2: 77.67
tensor([[95.3416,  0.0000,  0.0000],
        [78.5714, 77.8667,  0.0000],
        [61.1801, 57.8667, 77.6730]], device='cuda:0')
[Task 2 Finish] Global AA: 65.57	Global AF: 27.08
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:7.293337045410908e-10
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.897000665555652e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.879704028683875e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.60415872094444e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.0872592826061123e-09
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.0441704167973853e-09
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.48
tensor([[93.4783,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.48	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.050651646383187e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.2982559471907962e-09
[I 2025-09-15 06:23:07,302] Trial 218 finished with value: 73.60809326171875 and parameters: {'num_recon_nodes': 3, 'beta': 0.05, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 06:26:10,728] Trial 219 finished with value: 67.80125427246094 and parameters: {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:9.084251684221556e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.2502474611153502e-09
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.026424281299114227
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.193659474185154e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.78
[Task 1 Finish] Global Accuracy on Task 1: 80.27
tensor([[93.4783,  0.0000,  0.0000],
        [84.7826, 80.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.52	Global AF: 8.70
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.202714925545138e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.0955137907942003e-09
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.025707395747303963
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.183180079055717e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.744791309325592e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.889906895539809e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 60.87
[Task 2 Finish] Global Accuracy on Task 1: 72.53
[Task 2 Finish] Global Accuracy on Task 2: 87.42
tensor([[93.4783,  0.0000,  0.0000],
        [84.7826, 80.2667,  0.0000],
        [60.8696, 72.5333, 87.4214]], device='cuda:0')
[Task 2 Finish] Global AA: 73.61	Global AF: 20.17
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788227806799114
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:8.098867687600375e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:9.130752265384956e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.143898640369571e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.310181349140521e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.3728238545951399e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.48
tensor([[93.4783,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.48	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:0.029233457520604134
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.1518346276773173e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.2095736265182495
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.002701420840026e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:5.2337406630798e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.045491884876242e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 75.16
[Task 1 Finish] Global Accuracy on Task 1: 81.33
tensor([[93.4783,  0.0000,  0.0000],
        [75.1553, 81.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 78.24	Global AF: 18.32
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.454028895179874e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.306624666940763e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.8195416274255933e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.9071735857245642e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:2.461797987685088e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.904995298815606e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 61.80
[Task 2 Finish] Global Accuracy on Task 1: 53.87
[Task 2 Finish] Global Accuracy on Task 2: 87.74
tensor([[93.4783,  0.0000,  0.0000],
        [75.1553, 81.3333,  0.0000],
        [61.8012, 53.8667, 87.7358]], device='cuda:0')
[Task 2 Finish] Global AA: 67.80	Global AF: 29.57
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.000137882205308415
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.902104998651737e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.0727682075994949e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.7008665576543365e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792005554772913
[I 2025-09-15 06:29:25,277] Trial 220 finished with value: 75.62371063232422 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 06:32:40,011] Trial 221 finished with value: 72.67605590820312 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:9.41244526764251e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.059737186892562e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.220216646786071e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.0879075418301909e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.1916072573114889e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:3.191790831635899e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.161131911788573e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.43
[Task 1 Finish] Global Accuracy on Task 1: 86.93
tensor([[95.6522,  0.0000,  0.0000],
        [80.4348, 86.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.68	Global AF: 15.22
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.734828333383348e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:9.66456137341254e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.0407561479297556e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.423849313070718e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.2772777280289915e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.753096805032442e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 80.75
[Task 2 Finish] Global Accuracy on Task 1: 76.00
[Task 2 Finish] Global Accuracy on Task 2: 70.13
tensor([[95.6522,  0.0000,  0.0000],
        [80.4348, 86.9333,  0.0000],
        [80.7453, 76.0000, 70.1258]], device='cuda:0')
[Task 2 Finish] Global AA: 75.62	Global AF: 12.92
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788265641778708
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:9.166520320569305e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:2.0308321690976072e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:8.554839614483001e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.506259727004135e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.0942221007634885e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.512893947428154e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.707429446249023e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:2.8892763181964654e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.202667854194317e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:6.81685541348287e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.871182122227594e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.85
[Task 1 Finish] Global Accuracy on Task 1: 78.67
tensor([[95.3416,  0.0000,  0.0000],
        [83.8509, 78.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.26	Global AF: 11.49
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.196461370208908e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.035606933541544e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.615360398891767e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.8161262771432263e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.0509568770800115e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.053423235423793e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 72.36
[Task 2 Finish] Global Accuracy on Task 1: 76.80
[Task 2 Finish] Global Accuracy on Task 2: 68.87
tensor([[95.3416,  0.0000,  0.0000],
        [83.8509, 78.6667,  0.0000],
        [72.3603, 76.8000, 68.8679]], device='cuda:0')
[Task 2 Finish] Global AA: 72.68	Global AF: 12.42
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[I 2025-09-15 06:35:57,248] Trial 222 finished with value: 62.91002655029297 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788398064207286
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.738987146093223e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.205713803415392e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:9.284303881251788e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.0510504688809874e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.868952156542264e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.5879294807704696e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.465995989162309e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.6694325356023683e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.407449653662468e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966491072438657
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.422907123353582e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 72.05
[Task 1 Finish] Global Accuracy on Task 1: 78.40
tensor([[94.4099,  0.0000,  0.0000],
        [72.0497, 78.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 75.22	Global AF: 22.36
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:2.4402535547807247e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.07076278136276e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.109602351285105e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.204930292850406e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.350493464424289e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.929396418302701e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 60.56
[Task 2 Finish] Global Accuracy on Task 1: 62.13
[Task 2 Finish] Global Accuracy on Task 2: 66.04
tensor([[94.4099,  0.0000,  0.0000],
        [72.0497, 78.4000,  0.0000],
        [60.5590, 62.1333, 66.0377]], device='cuda:0')
[Task 2 Finish] Global AA: 62.91	Global AF: 25.06
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:7.3816985857178e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.3577263757724722e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.0500881275632423e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.1414651435746066e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.906300089478009e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:0.06017165631055832
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.5960741617249141e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.939342823639947e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.7338632186134646e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:0.06120007857680321
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:9.210648910240593e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.469997315683429e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 75.47
[Task 1 Finish] Global Accuracy on Task 1: 79.47
tensor([[93.7888,  0.0000,  0.0000],
        [75.4658, 79.4667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 77.47	Global AF: 18.32
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.379117317185546e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.556593298701614e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.4544336835473644e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.401140256213523e-10
[I 2025-09-15 06:39:02,265] Trial 223 finished with value: 73.02067565917969 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 06:42:15,449] Trial 224 finished with value: 64.37247467041016 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.632209143513478e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.618251974759403e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 66.77
[Task 2 Finish] Global Accuracy on Task 1: 74.93
[Task 2 Finish] Global Accuracy on Task 2: 77.36
tensor([[93.7888,  0.0000,  0.0000],
        [75.4658, 79.4667,  0.0000],
        [66.7702, 74.9333, 77.3585]], device='cuda:0')
[Task 2 Finish] Global AA: 73.02	Global AF: 15.78
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:6.091765425431106e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.689853062509684e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.541375384751859e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.079787701589566e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.796896461798042e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.2362243451136123e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.08665740136982e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.10668407402737e-11
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.608487645998196e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.42602693279315e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966560921631753
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.311309170252798e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.26
[Task 1 Finish] Global Accuracy on Task 1: 77.07
tensor([[94.7205,  0.0000,  0.0000],
        [78.2609, 77.0667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 77.66	Global AF: 16.46
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.804594110398909e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.406106921654555e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:2.562259293625857e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.691229266689078e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.033702509318118e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.55458298748357e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 69.57
[Task 2 Finish] Global Accuracy on Task 1: 73.87
[Task 2 Finish] Global Accuracy on Task 2: 49.69
tensor([[94.7205,  0.0000,  0.0000],
        [78.2609, 77.0667,  0.0000],
        [69.5652, 73.8667, 49.6855]], device='cuda:0')
[Task 2 Finish] Global AA: 64.37	Global AF: 14.18
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378843589918688
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.951079546344772e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.022502886336099e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.0879974405605424e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.310337838233977e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.514803058659368e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:3.754636601627226e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.4621893413012685e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.4358882405882696e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.725623394177589e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.002666698768734932
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.007640106555414e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 86.65
[Task 1 Finish] Global Accuracy on Task 1: 84.80
[I 2025-09-15 06:45:28,671] Trial 225 finished with value: 70.8891830444336 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 06:48:35,891] Trial 226 finished with value: 71.12608337402344 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
tensor([[94.7205,  0.0000,  0.0000],
        [86.6460, 84.8000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 85.72	Global AF: 8.07
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.105625060039756e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:9.411998957986611e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:2.7959079496042705e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.358122361938001e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.4031616413798815e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.9104045002069654e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 77.33
[Task 2 Finish] Global Accuracy on Task 1: 76.53
[Task 2 Finish] Global Accuracy on Task 2: 58.81
tensor([[94.7205,  0.0000,  0.0000],
        [86.6460, 84.8000,  0.0000],
        [77.3292, 76.5333, 58.8050]], device='cuda:0')
[Task 2 Finish] Global AA: 70.89	Global AF: 12.83
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:6.660865192742449e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.230348293887687e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.1474392547228263e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.564859211799501e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792052120901644
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.909771867898314e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.770170700778124e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.457728158297925e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:9.357681296506826e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.1069021255138978e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:6.293279786184769e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.61908677973355e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.85
[Task 1 Finish] Global Accuracy on Task 1: 78.67
tensor([[93.7888,  0.0000,  0.0000],
        [83.8509, 78.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.26	Global AF: 9.94
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.0881184842048697e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.3009832100507879e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.044447082269699e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.509796035558679e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.303575604884372e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.410369540217232e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 83.23
[Task 2 Finish] Global Accuracy on Task 1: 70.40
[Task 2 Finish] Global Accuracy on Task 2: 59.75
tensor([[93.7888,  0.0000,  0.0000],
        [83.8509, 78.6667,  0.0000],
        [83.2298, 70.4000, 59.7484]], device='cuda:0')
[Task 2 Finish] Global AA: 71.13	Global AF: 9.41
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0010369210503995419
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.9196386702446944e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.166199855745958e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.837723082713353e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.4865287889520573e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.273194325638997e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[I 2025-09-15 06:51:41,348] Trial 227 finished with value: 68.17033386230469 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 06:55:05,782] Trial 228 finished with value: 63.08146667480469 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 10}. Best is trial 115 with value: 79.04704284667969.
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.296629884161575e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.323990887566964e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.286330427902499e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.03740637880901e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.026108724996447563
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:2.9429675363346064e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 86.65
[Task 1 Finish] Global Accuracy on Task 1: 79.47
tensor([[95.0311,  0.0000,  0.0000],
        [86.6460, 79.4667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.06	Global AF: 8.39
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.4127622682824637e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.1121280563131108e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.708013671781089e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497274348977953
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.142726799967079e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:9.99619387265227e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 63.98
[Task 2 Finish] Global Accuracy on Task 1: 52.80
[Task 2 Finish] Global Accuracy on Task 2: 87.74
tensor([[95.0311,  0.0000,  0.0000],
        [86.6460, 79.4667,  0.0000],
        [63.9752, 52.8000, 87.7358]], device='cuda:0')
[Task 2 Finish] Global AA: 68.17	Global AF: 28.86
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.000137882205308415
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.4614983929491814e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.3799604792197329e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:8.129429351910744e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.199521276224914e-08
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.726730673532131e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.950366476272563e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.330712207092688e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.535477797304679e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.068255425402015e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.5382868590041454e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:2.127716752786668e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.78
[Task 1 Finish] Global Accuracy on Task 1: 79.73
tensor([[94.0994,  0.0000,  0.0000],
        [84.7826, 79.7333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.26	Global AF: 9.32
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.134984217721069e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.591465735919286e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.977533161314e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497271147556603
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.723738787961508e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.335542675397818e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 72.67
[Task 2 Finish] Global Accuracy on Task 1: 79.47
[Task 2 Finish] Global Accuracy on Task 2: 37.11
tensor([[94.0994,  0.0000,  0.0000],
        [84.7826, 79.7333,  0.0000],
        [72.6708, 79.4667, 37.1069]], device='cuda:0')
[Task 2 Finish] Global AA: 63.08	Global AF: 10.85
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788302021566778
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.252249828975209e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.215952114667743e-10
[I 2025-09-15 06:58:17,959] Trial 229 finished with value: 76.04549407958984 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 07:01:35,619] Trial 230 finished with value: 72.45677185058594 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.670987875319497e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792084135115147
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.0138877515331046e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.96
tensor([[95.9627,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.96	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.024868967469672e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.404229286298801e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:9.383295251907953e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.078790497163425e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666985359042883
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:2.8446348054878e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 86.34
[Task 1 Finish] Global Accuracy on Task 1: 78.93
tensor([[95.9627,  0.0000,  0.0000],
        [86.3354, 78.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.63	Global AF: 9.63
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:0.03189585357904434
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.207240111853139e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.60697624283091e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.00044972694013267756
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.6402922343192756e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.490065181299684e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 77.95
[Task 2 Finish] Global Accuracy on Task 1: 74.40
[Task 2 Finish] Global Accuracy on Task 2: 75.79
tensor([[95.9627,  0.0000,  0.0000],
        [86.3354, 78.9333,  0.0000],
        [77.9503, 74.4000, 75.7862]], device='cuda:0')
[Task 2 Finish] Global AA: 76.05	Global AF: 11.27
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788275828119367
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.0109564841396264e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.726117192570655e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.5738284553943345e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.0168000602893699e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.010066416235361e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 92.86
tensor([[92.8571,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 92.86	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.7188626078024072e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.3948144861331002e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.108044932531584e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.0744513057048266e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:5.204927600033216e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.501634703364289e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.85
[Task 1 Finish] Global Accuracy on Task 1: 82.93
tensor([[92.8571,  0.0000,  0.0000],
        [83.8509, 82.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.39	Global AF: 9.01
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.724851703803324e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.024196697040907e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:9.719169913324777e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497274640016258
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:2.48422782345159e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.3111295382728372e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 66.46
[Task 2 Finish] Global Accuracy on Task 1: 73.87
[Task 2 Finish] Global Accuracy on Task 2: 77.04
tensor([[92.8571,  0.0000,  0.0000],
        [83.8509, 82.9333,  0.0000],
        [66.4596, 73.8667, 77.0440]], device='cuda:0')
[Task 2 Finish] Global AA: 72.46	Global AF: 17.73
--------------------------------------------------
--------------------------------------------------
[I 2025-09-15 07:04:52,352] Trial 231 finished with value: 72.1126708984375 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0010369210503995419
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:0.0008667524089105427
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.321457943070925e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.011770832728189e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979202883783728
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.0850783866730467e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.546174961627685e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.8901772641809487e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.666928120679927e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.301123511853746e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.0787996052030735e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.573587536997991e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 76.71
[Task 1 Finish] Global Accuracy on Task 1: 88.00
tensor([[95.0311,  0.0000,  0.0000],
        [76.7081, 88.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.35	Global AF: 18.32
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.412471192402847e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.929714579939628e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:2.2688309564422582e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.94655388766563e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.8986000538976384e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.1580396641619473e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 77.33
[Task 2 Finish] Global Accuracy on Task 1: 73.60
[Task 2 Finish] Global Accuracy on Task 2: 65.41
tensor([[95.0311,  0.0000,  0.0000],
        [76.7081, 88.0000,  0.0000],
        [77.3292, 73.6000, 65.4088]], device='cuda:0')
[Task 2 Finish] Global AA: 72.11	Global AF: 16.05
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378831802867353
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:9.518579258127602e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.2100023205618982e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:8.693857855845977e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.806977841973151e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.0477722023338742e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.276239610831681e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.129430213912656e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.4283619842458961e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.253496166395365e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796645032707602
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.822625714912988e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.78
[Task 1 Finish] Global Accuracy on Task 1: 82.13
tensor([[94.4099,  0.0000,  0.0000],
        [84.7826, 82.1333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.46	Global AF: 9.63
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.441531504222439e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.298139952955808e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
[I 2025-09-15 07:08:09,037] Trial 232 finished with value: 61.198692321777344 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 07:11:21,903] Trial 233 finished with value: 64.8447494506836 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
current_loss:5.399138358619382e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.354390459315738e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.875101988766062e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.102108983720768e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 62.11
[Task 2 Finish] Global Accuracy on Task 1: 57.33
[Task 2 Finish] Global Accuracy on Task 2: 64.15
tensor([[94.4099,  0.0000,  0.0000],
        [84.7826, 82.1333,  0.0000],
        [62.1118, 57.3333, 64.1509]], device='cuda:0')
[Task 2 Finish] Global AA: 61.20	Global AF: 28.55
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0010369212832301855
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:7.246656053006006e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.870524179992117e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.754038108676582e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.555818918141938e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.476077758968188e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.890703811521462e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.0895355728735012e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.218162459792893e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.214222776826148e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:4.897643957058051e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.510468747971231e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.50
[Task 1 Finish] Global Accuracy on Task 1: 82.93
tensor([[95.0311,  0.0000,  0.0000],
        [79.5031, 82.9333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.22	Global AF: 15.53
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.43926714569443e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.4784595769867792e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.285070324769549e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:2.5388569024897834e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.649287397410887e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.619671088005987e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 65.53
[Task 2 Finish] Global Accuracy on Task 1: 68.00
[Task 2 Finish] Global Accuracy on Task 2: 61.01
tensor([[95.0311,  0.0000,  0.0000],
        [79.5031, 82.9333,  0.0000],
        [65.5280, 68.0000, 61.0063]], device='cuda:0')
[Task 2 Finish] Global AA: 64.84	Global AF: 22.22
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788242358714342
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.791244788750816e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.2869033323178485e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.2715910536218473e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.8446820727067177e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.374676649237074e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.164114467274942e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.071339099187554e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.146612025441755e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.795008834435066e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026667052879929543
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.258401019643145e-10
[I 2025-09-15 07:16:11,173] Trial 234 finished with value: 14.190356254577637 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 07:19:20,259] Trial 235 finished with value: 66.6474838256836 and parameters: {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 74.84
[Task 1 Finish] Global Accuracy on Task 1: 83.20
tensor([[94.7205,  0.0000,  0.0000],
        [74.8447, 83.2000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.02	Global AF: 19.88
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.437686967368904e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.083949844968515e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:nan
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.0922736048968318e-09
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.019991254963998e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.0798944377610198e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 0.00
[Task 2 Finish] Global Accuracy on Task 1: 9.87
[Task 2 Finish] Global Accuracy on Task 2: 32.70
tensor([[94.7205,  0.0000,  0.0000],
        [74.8447, 83.2000,  0.0000],
        [ 0.0000,  9.8667, 32.7044]], device='cuda:0')
[Task 2 Finish] Global AA: 14.19	Global AF: 84.03
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378823653794825
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:7.517153566283241e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:0.04181229695677757
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:8.930193251543983e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.000397922151023522
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.728825109268087e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.752464533019918e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.302865534519754e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.3017193989384168e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.166858938591815e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966485251672566
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.3964948348573785e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 87.89
[Task 1 Finish] Global Accuracy on Task 1: 78.67
tensor([[94.7205,  0.0000,  0.0000],
        [87.8882, 78.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.28	Global AF: 6.83
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.252370453654123e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:9.588921878744827e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.278507324099849e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.505310651798823e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.818221377433929e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.8804306162477644e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 75.78
[Task 2 Finish] Global Accuracy on Task 1: 66.93
[Task 2 Finish] Global Accuracy on Task 2: 57.23
tensor([[94.7205,  0.0000,  0.0000],
        [87.8882, 78.6667,  0.0000],
        [75.7764, 66.9333, 57.2327]], device='cuda:0')
[Task 2 Finish] Global AA: 66.65	Global AF: 15.34
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788255455438048
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.4229771805318592e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:0.029528338462114334
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.3775243712952374e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.333030294098819e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:8.217676539246099e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[I 2025-09-15 07:22:31,329] Trial 236 finished with value: 74.99432373046875 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 07:25:42,985] Trial 237 finished with value: 69.9919204711914 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.0579718212611056e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.069162477613133e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.755469127486037e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.8297556803048565e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:7.749034747206451e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.007371934289239e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.06
[Task 1 Finish] Global Accuracy on Task 1: 84.00
tensor([[93.7888,  0.0000,  0.0000],
        [81.0559, 84.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.53	Global AF: 12.73
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.226973533630371
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.432112095578475e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.853415447314546e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.00044972801697440445
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.357269822730103e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.358711335252565e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 69.25
[Task 2 Finish] Global Accuracy on Task 1: 64.53
[Task 2 Finish] Global Accuracy on Task 2: 91.19
tensor([[93.7888,  0.0000,  0.0000],
        [81.0559, 84.0000,  0.0000],
        [69.2547, 64.5333, 91.1950]], device='cuda:0')
[Task 2 Finish] Global AA: 74.99	Global AF: 22.00
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:7.482732766739275e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.980973966617341e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.4728590276044145e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.563884270503138e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.451619321585667e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.338265468031068e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.3742211812939331e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:9.080177165721182e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.917378171320763e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.571455632287666e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966581294313073
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.3807858190162392e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.68
[Task 1 Finish] Global Accuracy on Task 1: 79.47
tensor([[95.0311,  0.0000,  0.0000],
        [81.6770, 79.4667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.57	Global AF: 13.35
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.6711362293975185e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.602964676081456e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.079775489136296e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.985726996866504e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.491738340803522e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.82792869519011e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 65.53
[Task 2 Finish] Global Accuracy on Task 1: 60.80
[Task 2 Finish] Global Accuracy on Task 2: 83.65
tensor([[95.0311,  0.0000,  0.0000],
        [81.6770, 79.4667,  0.0000],
        [65.5280, 60.8000, 83.6478]], device='cuda:0')
[Task 2 Finish] Global AA: 69.99	Global AF: 24.08
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788224896416068
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:9.021421942811969e-10
[I 2025-09-15 07:28:54,242] Trial 238 finished with value: 56.27533721923828 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.395484059533828e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.03724395528593e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.778321875484551e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.766374210405047e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.28709187541665e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.3466262549499675e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:9.205716189342183e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.355488995663961e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:6.925142681524221e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.078536952611955e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.43
[Task 1 Finish] Global Accuracy on Task 1: 80.00
tensor([[95.6522,  0.0000,  0.0000],
        [80.4348, 80.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.22	Global AF: 15.22
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.525429558339567e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.575843675664771e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.3154576317120359e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:2.3466178999953513e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.075420804802945e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.3937720128894853e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 62.73
[Task 2 Finish] Global Accuracy on Task 1: 43.20
[Task 2 Finish] Global Accuracy on Task 2: 62.89
tensor([[95.6522,  0.0000,  0.0000],
        [80.4348, 80.0000,  0.0000],
        [62.7329, 43.2000, 62.8931]], device='cuda:0')
[Task 2 Finish] Global AA: 56.28	Global AF: 34.86
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788399519398808
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.4691084166714745e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.926696355906813e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.869031761638553e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.101530474784568e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.416213671478488e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.232891788660595e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.8698607379418206e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.028575971761541e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.086501775330987e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796650271397084
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.1038017428718376e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 75.78
[Task 1 Finish] Global Accuracy on Task 1: 89.60
tensor([[93.7888,  0.0000,  0.0000],
        [75.7764, 89.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.69	Global AF: 18.01
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.7313293000405e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.391337624757966e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.025707395747303963
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.680255320607898e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:9.5207342010184e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.8619960018284587e-09
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 72.36
[Task 2 Finish] Global Accuracy on Task 1: 67.73
[Task 2 Finish] Global Accuracy on Task 2: 91.51
tensor([[93.7888,  0.0000,  0.0000],
        [75.7764, 89.6000,  0.0000],
        [72.3603, 67.7333, 91.5094]], device='cuda:0')
[I 2025-09-15 07:31:49,364] Trial 239 finished with value: 77.20100402832031 and parameters: {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 07:35:03,807] Trial 240 finished with value: 73.29188537597656 and parameters: {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 5}. Best is trial 115 with value: 79.04704284667969.
[Task 2 Finish] Global AA: 77.20	Global AF: 21.65
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788262731395662
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.3427955414258008e-09
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.289697261965046e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.373048838132945e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:9.47642520010561e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.9737084189230814e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 92.55
tensor([[92.5466,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 92.55	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.93242288626783e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.5608867793589525e-09
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.992680353004374e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.032415984982606e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:7.35538296936511e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.044066441252994e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.06
[Task 1 Finish] Global Accuracy on Task 1: 83.73
tensor([[92.5466,  0.0000,  0.0000],
        [81.0559, 83.7333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.39	Global AF: 11.49
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.916496430089182e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.857071742696121e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.523430519043359e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.06591166185666e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.2420419954503075e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.224653404882872e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 76.09
[Task 2 Finish] Global Accuracy on Task 1: 80.27
[Task 2 Finish] Global Accuracy on Task 2: 63.52
tensor([[92.5466,  0.0000,  0.0000],
        [81.0559, 83.7333,  0.0000],
        [76.0870, 80.2667, 63.5220]], device='cuda:0')
[Task 2 Finish] Global AA: 73.29	Global AF: 9.96
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.0702803088236124e-09
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.387611468066211e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.7076278158743037e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.946360933009373e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.3423061540638344e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.032414376211932e-09
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.48
tensor([[93.4783,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.48	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.985184015067091e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.8129621682259085e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.693757049700764e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.679990284195412e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:2.4753871841198816e-08
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.395142276322986e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.88
[Task 1 Finish] Global Accuracy on Task 1: 87.20
tensor([[93.4783,  0.0000,  0.0000],
        [78.8820, 87.2000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.04	Global AF: 14.60
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.641697357703038e-10
[I 2025-09-15 07:38:17,762] Trial 241 finished with value: 71.14356994628906 and parameters: {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 07:41:38,805] Trial 242 finished with value: 74.68656921386719 and parameters: {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.4253125336114465e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:9.028168213021104e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:8.981584920242369e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.84564618932859e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.1297952573485759e-09
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 66.46
[Task 2 Finish] Global Accuracy on Task 1: 64.27
[Task 2 Finish] Global Accuracy on Task 2: 82.70
tensor([[93.4783,  0.0000,  0.0000],
        [78.8820, 87.2000,  0.0000],
        [66.4596, 64.2667, 82.7044]], device='cuda:0')
[Task 2 Finish] Global AA: 71.14	Global AF: 24.98
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788237993139774
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.2364471668746546e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.0011291502217716e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.9919486893282823e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.529176171416907e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.425393633297972e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.775492861737064e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.0528768967787983e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.0289751273262482e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.516134771177406e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:2.7255606105391905e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.685839659681392e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.43
[Task 1 Finish] Global Accuracy on Task 1: 88.53
tensor([[95.6522,  0.0000,  0.0000],
        [80.4348, 88.5333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.48	Global AF: 15.22
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.748195335859464e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.351648261850642e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.346398572278702e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:8.67198868270691e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.206508640360653e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.755151993331765e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 69.25
[Task 2 Finish] Global Accuracy on Task 1: 62.67
[Task 2 Finish] Global Accuracy on Task 2: 92.14
tensor([[95.6522,  0.0000,  0.0000],
        [80.4348, 88.5333,  0.0000],
        [69.2547, 62.6667, 92.1384]], device='cuda:0')
[Task 2 Finish] Global AA: 74.69	Global AF: 26.13
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:3.6256725399752554e-10
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.199198376855009e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.052619599434706e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.487858500963227e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.000397920492105186
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.1990595455712025e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.0220562697898e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.513371119178714e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.24896634437988e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.035820318406877e-09
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
[I 2025-09-15 07:44:49,441] Trial 243 finished with value: 70.62544250488281 and parameters: {'num_recon_nodes': 3, 'beta': 0.06999999999999999, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 07:47:57,908] Trial 244 finished with value: 63.061431884765625 and parameters: {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.30000000000000004, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
current_loss:2.628976758511925e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.884495030665903e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.30
[Task 1 Finish] Global Accuracy on Task 1: 87.47
tensor([[94.7205,  0.0000,  0.0000],
        [82.2981, 87.4667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.88	Global AF: 12.42
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:2.9157590231143615e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.855666200346946e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.442072596537287e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.1604591731995129e-09
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.228920547078019e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.514795369838566e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 68.63
[Task 2 Finish] Global Accuracy on Task 1: 51.73
[Task 2 Finish] Global Accuracy on Task 2: 91.51
tensor([[94.7205,  0.0000,  0.0000],
        [82.2981, 87.4667,  0.0000],
        [68.6335, 51.7333, 91.5094]], device='cuda:0')
[Task 2 Finish] Global AA: 70.63	Global AF: 30.91
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378823653794825
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.87195189641443e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.679699488503331e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:8.101972981400252e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979214234277606
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.8358446974307014e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.2512652025620241e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.698817694468119e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.316990819321688e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.2169115715110479e-09
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:4.2134021271955646e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.737361862325542e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.99
[Task 1 Finish] Global Accuracy on Task 1: 88.00
tensor([[93.7888,  0.0000,  0.0000],
        [81.9876, 88.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.99	Global AF: 11.80
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.757635172607081e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.970001715205342e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.748515162830927e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.802442580917557e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.0895092867643257e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:9.888690977177816e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 60.25
[Task 2 Finish] Global Accuracy on Task 1: 57.87
[Task 2 Finish] Global Accuracy on Task 2: 71.07
tensor([[93.7888,  0.0000,  0.0000],
        [81.9876, 88.0000,  0.0000],
        [60.2484, 57.8667, 71.0692]], device='cuda:0')
[Task 2 Finish] Global AA: 63.06	Global AF: 31.84
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00103692093398422
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.22236753841554e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.491198606932812e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.404141052902986e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:8.977780741048491e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.930737484976078e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
[I 2025-09-15 07:51:12,177] Trial 245 finished with value: 60.53520965576172 and parameters: {'num_recon_nodes': 3, 'beta': 0.05, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 07:54:13,803] Trial 246 finished with value: 70.31723022460938 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.5360388516683088e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.46374262605309e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:2.502431872830613e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.5155661715080555e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00266670691780746
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.042048891619629e-09
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 72.98
[Task 1 Finish] Global Accuracy on Task 1: 88.80
tensor([[95.0311,  0.0000,  0.0000],
        [72.9814, 88.8000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.89	Global AF: 22.05
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.1250150810937498e-09
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.4707556283966028e-09
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.2326419052133275e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.762283593670816e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.409739878281528e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.3027442719889564e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 51.55
[Task 2 Finish] Global Accuracy on Task 1: 37.60
[Task 2 Finish] Global Accuracy on Task 2: 92.45
tensor([[95.0311,  0.0000,  0.0000],
        [72.9814, 88.8000,  0.0000],
        [51.5528, 37.6000, 92.4528]], device='cuda:0')
[Task 2 Finish] Global AA: 60.54	Global AF: 47.34
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:6.444283440210086e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.2743247002642306e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.707571554796175e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.675785981676171e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792043389752507
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.746885827801918e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.4478974685872004e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.731656815832764e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:0.041359443217515945
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:0.06120007857680321
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966459058225155
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.612752095376152e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.88
[Task 1 Finish] Global Accuracy on Task 1: 80.27
tensor([[94.0994,  0.0000,  0.0000],
        [78.8820, 80.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.57	Global AF: 15.22
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.540154694536284e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.886004544348623e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.0004105981206521392
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.172954369887407e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.288856657654662e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.2266784249769245e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 71.74
[Task 2 Finish] Global Accuracy on Task 1: 67.20
[Task 2 Finish] Global Accuracy on Task 2: 72.01
tensor([[94.0994,  0.0000,  0.0000],
        [78.8820, 80.2667,  0.0000],
        [71.7391, 67.2000, 72.0126]], device='cuda:0')
[Task 2 Finish] Global AA: 70.32	Global AF: 17.71
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[I 2025-09-15 07:57:32,205] Trial 247 finished with value: 65.8595962524414 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00103692093398422
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.12017270196219e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.881554049873671e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:8.732360945451489e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792078314349055
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.4364824885149119e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.96
tensor([[95.9627,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.96	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.2133557753842865e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.3275434918025297e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:9.92982251979413e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:2.2730102522405815e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:2.74480327355775e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.391371988266002e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 85.40
[Task 1 Finish] Global Accuracy on Task 1: 78.67
tensor([[95.9627,  0.0000,  0.0000],
        [85.4037, 78.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.04	Global AF: 10.56
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.5175312118032025e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.820824295315163e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:2.119041470072247e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.697333798655336e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.196656355759387e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.203688121398372e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 76.09
[Task 2 Finish] Global Accuracy on Task 1: 60.80
[Task 2 Finish] Global Accuracy on Task 2: 60.69
tensor([[95.9627,  0.0000,  0.0000],
        [85.4037, 78.6667,  0.0000],
        [76.0870, 60.8000, 60.6918]], device='cuda:0')
[Task 2 Finish] Global AA: 65.86	Global AF: 18.87
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0010629919124767184
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.822747951520711e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.01169844408156e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.5849864743475734e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:9.139274337321979e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.074503789919248e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.1837350250872873e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:8.061464829012266e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:9.519380839151381e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:2.661769138434522e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:7.374498234291593e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.3142933408261115e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.16
[Task 1 Finish] Global Accuracy on Task 1: 88.00
tensor([[94.7205,  0.0000,  0.0000],
        [84.1615, 88.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 86.08	Global AF: 10.56
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.283025931810073e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.214724845854391e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.2528092158988784e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:2.6183225032561097e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.212693804905854e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.3903645729461687e-10
[I 2025-09-15 08:00:42,607] Trial 248 finished with value: 62.92818832397461 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 08:03:48,405] Trial 249 finished with value: 73.34994506835938 and parameters: {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 59.63
[Task 2 Finish] Global Accuracy on Task 1: 37.33
[Task 2 Finish] Global Accuracy on Task 2: 91.82
tensor([[94.7205,  0.0000,  0.0000],
        [84.1615, 88.0000,  0.0000],
        [59.6273, 37.3333, 91.8239]], device='cuda:0')
[Task 2 Finish] Global AA: 62.93	Global AF: 42.88
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.000137883034767583
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.960278328549947e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:2.507669072393526e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.163432293895596e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.391249668917908e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.586128360071438e-11
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.4850876911841624e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.388901547220826e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.788491908020887e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.957002668921518e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:3.485966237892768e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.68231564632049e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.26
[Task 1 Finish] Global Accuracy on Task 1: 84.27
tensor([[94.4099,  0.0000,  0.0000],
        [78.2609, 84.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.26	Global AF: 16.15
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.0113597737060331e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.4499375578533886e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.314830325315768e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.731621288695976e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.771473299276408e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:0.033466536551713943
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 65.84
[Task 2 Finish] Global Accuracy on Task 1: 67.73
[Task 2 Finish] Global Accuracy on Task 2: 86.48
tensor([[94.4099,  0.0000,  0.0000],
        [78.2609, 84.2667,  0.0000],
        [65.8385, 67.7333, 86.4780]], device='cuda:0')
[Task 2 Finish] Global AA: 73.35	Global AF: 22.55
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788229261990637
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:8.831603781622732e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:9.995154703901221e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.842343830941843e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:4.55467080717753e-10
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:8.873796697450587e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.459987546998832e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.0560905483458782e-09
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.122501867127482e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.161135018307618e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:6.093898718972923e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.1963152690697143e-09
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.99
[Task 1 Finish] Global Accuracy on Task 1: 81.87
tensor([[93.7888,  0.0000,  0.0000],
        [81.9876, 81.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.93	Global AF: 11.80
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[I 2025-09-15 08:06:58,187] Trial 250 finished with value: 66.33612823486328 and parameters: {'num_recon_nodes': 3, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 08:10:09,664] Trial 251 finished with value: 69.633056640625 and parameters: {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.0327249055919197e-09
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:2.9039842752709433e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.651042966903219e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:8.918605298724458e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:9.91108750625358e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.202726193256126e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 68.63
[Task 2 Finish] Global Accuracy on Task 1: 74.40
[Task 2 Finish] Global Accuracy on Task 2: 55.97
tensor([[93.7888,  0.0000,  0.0000],
        [81.9876, 81.8667,  0.0000],
        [68.6335, 74.4000, 55.9748]], device='cuda:0')
[Task 2 Finish] Global AA: 66.34	Global AF: 16.31
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.17362380027771
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.255920143554249e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.658893826281485e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.9061583695089155e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.0389705096258695e-08
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.4099941214595901e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.95257254809178e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.9869356987788365e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.19467374565852e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.735965119020193e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:6.265229446356102e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.2329437470981475e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 85.09
[Task 1 Finish] Global Accuracy on Task 1: 85.07
tensor([[95.6522,  0.0000,  0.0000],
        [85.0932, 85.0667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 85.08	Global AF: 10.56
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.049640705578895e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.0021998775886516e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.191588518613457e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.0749616474736712e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.742536781534909e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.48802225885936e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 59.32
[Task 2 Finish] Global Accuracy on Task 1: 63.73
[Task 2 Finish] Global Accuracy on Task 2: 85.85
tensor([[95.6522,  0.0000,  0.0000],
        [85.0932, 85.0667,  0.0000],
        [59.3168, 63.7333, 85.8491]], device='cuda:0')
[Task 2 Finish] Global AA: 69.63	Global AF: 28.83
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.01740207150578499
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.3594563252894432e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.2179573722656016e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.166269746390782e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.546947008852385e-08
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.931049150755598e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.785961709747767e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.0057407129338003e-09
[I 2025-09-15 08:13:19,581] Trial 252 finished with value: 65.11558532714844 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 08:16:26,872] Trial 253 finished with value: 75.86788940429688 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.412533364892226e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.991362518274144e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:9.521039512350171e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.113711871145398e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.37
[Task 1 Finish] Global Accuracy on Task 1: 84.80
tensor([[95.0311,  0.0000,  0.0000],
        [81.3665, 84.8000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.08	Global AF: 13.66
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:2.8483687630753707e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.3567429391645476e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:2.3703267126862215e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.484938171371965e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.084272364757169e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.2877968136315587e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 62.73
[Task 2 Finish] Global Accuracy on Task 1: 58.40
[Task 2 Finish] Global Accuracy on Task 2: 74.21
tensor([[95.0311,  0.0000,  0.0000],
        [81.3665, 84.8000,  0.0000],
        [62.7329, 58.4000, 74.2138]], device='cuda:0')
[Task 2 Finish] Global AA: 65.12	Global AF: 29.35
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:7.7749923166337e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.7072193658762558e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.8141984843042e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.7742384217942515e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.805641523082272e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.927889762917914e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.585339189044362e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.975362899450886e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.1018674861418276e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.183531712864124e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:6.658635864909002e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:9.432007397336406e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.88
[Task 1 Finish] Global Accuracy on Task 1: 83.73
tensor([[95.0311,  0.0000,  0.0000],
        [78.8820, 83.7333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.31	Global AF: 16.15
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.312865478783294e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.420303898581949e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.025707395747303963
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.136734843562806e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.072927161149266e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.37497277189425e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 64.91
[Task 2 Finish] Global Accuracy on Task 1: 76.53
[Task 2 Finish] Global Accuracy on Task 2: 86.16
tensor([[95.0311,  0.0000,  0.0000],
        [78.8820, 83.7333,  0.0000],
        [64.9068, 76.5333, 86.1635]], device='cuda:0')
[Task 2 Finish] Global AA: 75.87	Global AF: 18.66
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.721164544221665e-09
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.850828793147912e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.409899750397074e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.6142374376370014e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979204047936946
[I 2025-09-15 08:19:25,579] Trial 254 finished with value: 73.6102294921875 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 115 with value: 79.04704284667969.
[I 2025-09-15 08:22:34,464] Trial 255 finished with value: 79.05184936523438 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:0.060132186859846115
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.5055516833228921e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.0762070930309164e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.681159431780713e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.881689107451905e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.026424281299114227
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.803856201718304e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.43
[Task 1 Finish] Global Accuracy on Task 1: 80.53
tensor([[95.0311,  0.0000,  0.0000],
        [80.4348, 80.5333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.48	Global AF: 14.60
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.644315346335475e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.145607521825582e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.5228418232845513e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.7715447431807547e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.566112570853932e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.0411505818884734e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 72.36
[Task 2 Finish] Global Accuracy on Task 1: 75.20
[Task 2 Finish] Global Accuracy on Task 2: 73.27
tensor([[95.0311,  0.0000,  0.0000],
        [80.4348, 80.5333,  0.0000],
        [72.3603, 75.2000, 73.2704]], device='cuda:0')
[Task 2 Finish] Global AA: 73.61	Global AF: 14.00
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788265641778708
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:7.113926114854507e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.678327807956407e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.069734714841957e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.860165213673497e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.615915706272176e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.72894834402382e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.984617054029414e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.53034296241006e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.929588933080595e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796644159592688
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.1901076790721277e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.12
[Task 1 Finish] Global Accuracy on Task 1: 79.20
tensor([[95.6522,  0.0000,  0.0000],
        [80.1242, 79.2000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.66	Global AF: 15.53
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.710248385248917e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.937583120145916e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.293418676137861e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.431321503657216e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.3142541499533422e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.6816512899152656e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 74.53
[Task 2 Finish] Global Accuracy on Task 1: 75.20
[Task 2 Finish] Global Accuracy on Task 2: 87.42
tensor([[95.6522,  0.0000,  0.0000],
        [80.1242, 79.2000,  0.0000],
        [74.5342, 75.2000, 87.4214]], device='cuda:0')
[Task 2 Finish] Global AA: 79.05	Global AF: 12.56
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[I 2025-09-15 08:25:41,964] Trial 256 finished with value: 66.73152160644531 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:2.5144331061710545e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.061018826246766e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:9.731614125652044e-11
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.7010327868494102e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.4328120901427894e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.089174164891631e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.48
tensor([[93.4783,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.48	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.1423650914110794e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.053502396430872e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.678464365388436e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.149147776935422e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.026424281299114227
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.6882363829704445e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 86.34
[Task 1 Finish] Global Accuracy on Task 1: 78.67
tensor([[93.4783,  0.0000,  0.0000],
        [86.3354, 78.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.50	Global AF: 7.14
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.493837134691205e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.264629925922804e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.363726685025938e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.377148809022515e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.686475846809145e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.222857453659799e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 62.73
[Task 2 Finish] Global Accuracy on Task 1: 62.93
[Task 2 Finish] Global Accuracy on Task 2: 74.53
tensor([[93.4783,  0.0000,  0.0000],
        [86.3354, 78.6667,  0.0000],
        [62.7329, 62.9333, 74.5283]], device='cuda:0')
[Task 2 Finish] Global AA: 66.73	Global AF: 23.24
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788304931949824
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.9246462201749637e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:0.04181229695677757
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.670223262617014e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.261960867031235e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.689395178252397e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.2651066860769333e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.020354853004562e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.84599915751005e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.413101716340464e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:6.880336300696399e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.215022385624991e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 86.96
[Task 1 Finish] Global Accuracy on Task 1: 84.53
tensor([[94.7205,  0.0000,  0.0000],
        [86.9565, 84.5333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 85.74	Global AF: 7.76
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.6282069015847185e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.816093245376464e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.388332168289935e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.770698918716732e-10
[I 2025-09-15 08:28:50,600] Trial 257 finished with value: 75.18624877929688 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[I 2025-09-15 08:32:08,269] Trial 258 finished with value: 74.06248474121094 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.1756057739257812
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.0993683741133964e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 67.08
[Task 2 Finish] Global Accuracy on Task 1: 72.00
[Task 2 Finish] Global Accuracy on Task 2: 86.48
tensor([[94.7205,  0.0000,  0.0000],
        [86.9565, 84.5333,  0.0000],
        [67.0807, 72.0000, 86.4780]], device='cuda:0')
[Task 2 Finish] Global AA: 75.19	Global AF: 20.09
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788275828119367
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.25061549794259e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.450826622346085e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.378569894494035e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.9446667326737952e-08
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.0883805795790522e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.460522672391278e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.4022577543570947e-09
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.189658868256288e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:2.464734860652129e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796644741669297
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.5851539232089067e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.68
[Task 1 Finish] Global Accuracy on Task 1: 80.00
tensor([[94.7205,  0.0000,  0.0000],
        [81.6770, 80.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.84	Global AF: 13.04
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.102763684343813e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.871951979154801e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.154896120020737e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.147549803601436e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.4545314952485455e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.163547674349786e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 70.50
[Task 2 Finish] Global Accuracy on Task 1: 76.53
[Task 2 Finish] Global Accuracy on Task 2: 75.16
tensor([[94.7205,  0.0000,  0.0000],
        [81.6770, 80.0000,  0.0000],
        [70.4969, 76.5333, 75.1572]], device='cuda:0')
[Task 2 Finish] Global AA: 74.06	Global AF: 13.85
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788249634671956
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.2850261399985925e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.893312197777448e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:8.514032256989879e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039800582453608513
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.8396538459253264e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.231144489277085e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.4832339800818772e-09
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:0.0002071199705824256
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.5532546349692495e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966453237459064
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.306352579559359e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.43
[Task 1 Finish] Global Accuracy on Task 1: 84.27
[I 2025-09-15 08:35:30,410] Trial 259 finished with value: 62.682106018066406 and parameters: {'num_recon_nodes': 3, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 10}. Best is trial 255 with value: 79.05184936523438.
[I 2025-09-15 08:38:39,703] Trial 260 finished with value: 74.51611328125 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
tensor([[94.0994,  0.0000,  0.0000],
        [80.4348, 84.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.35	Global AF: 13.66
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.836266552845416e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.43498984601132e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.0403753414323091e-09
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:2.7569765914670086e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.1448832992755342e-09
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.3079245726218574e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 71.12
[Task 2 Finish] Global Accuracy on Task 1: 75.73
[Task 2 Finish] Global Accuracy on Task 2: 41.19
tensor([[94.0994,  0.0000,  0.0000],
        [80.4348, 84.2667,  0.0000],
        [71.1180, 75.7333, 41.1950]], device='cuda:0')
[Task 2 Finish] Global AA: 62.68	Global AF: 15.76
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:7.074877905743904e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.51939779938715e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:9.947008772215327e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.074886232416588e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.1715477477025615e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.3084841250262684e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.9055184097283018e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.731604747425621e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.275738734766833e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.120646879268719e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:5.106871037163785e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.670636182841804e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.95
[Task 1 Finish] Global Accuracy on Task 1: 85.60
tensor([[95.0311,  0.0000,  0.0000],
        [77.9503, 85.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.78	Global AF: 17.08
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.388276491657962e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.08321596137273e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.025707395747303963
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.055073026838386e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.342567109880349e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.75590924817493e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 64.91
[Task 2 Finish] Global Accuracy on Task 1: 69.33
[Task 2 Finish] Global Accuracy on Task 2: 89.31
tensor([[95.0311,  0.0000,  0.0000],
        [77.9503, 85.6000,  0.0000],
        [64.9068, 69.3333, 89.3082]], device='cuda:0')
[Task 2 Finish] Global AA: 74.52	Global AF: 23.20
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:8.179056876223001e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.8190436934517606e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.227217795919728e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.943255497799839e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.090113330830093e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.774004997403324e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[I 2025-09-15 08:41:51,298] Trial 261 finished with value: 70.45561218261719 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[I 2025-09-15 08:45:03,810] Trial 262 finished with value: 67.77159881591797 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.5, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.514365796268407e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.322830592431217e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.498433930384294e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.90836610139911e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:3.481975541230753e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.936813735589851e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.50
[Task 1 Finish] Global Accuracy on Task 1: 90.13
tensor([[95.0311,  0.0000,  0.0000],
        [79.5031, 90.1333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.82	Global AF: 15.53
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:2.516374886241124e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:2.910840457559516e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.721153799129411e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497273184824735
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:9.329497174803691e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.061275622937785e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 59.94
[Task 2 Finish] Global Accuracy on Task 1: 67.47
[Task 2 Finish] Global Accuracy on Task 2: 83.96
tensor([[95.0311,  0.0000,  0.0000],
        [79.5031, 90.1333,  0.0000],
        [59.9379, 67.4667, 83.9623]], device='cuda:0')
[Task 2 Finish] Global AA: 70.46	Global AF: 28.88
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788233627565205
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.2291984097245745e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.5122503249642705e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.927023233847194e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.3504372065042958e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:8.407272100718899e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.905982287084498e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:9.720638738386356e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.0089930002621372e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.4342154947862866e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:9.220615243554775e-11
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.6269474656382954e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.75
[Task 1 Finish] Global Accuracy on Task 1: 84.80
tensor([[94.4099,  0.0000,  0.0000],
        [80.7453, 84.8000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.77	Global AF: 13.66
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.14765929671546e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.8561573085546e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.18043727307338e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.9552233710438145e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.982793232523932e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.8932898571708563e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 58.07
[Task 2 Finish] Global Accuracy on Task 1: 58.13
[Task 2 Finish] Global Accuracy on Task 2: 87.11
tensor([[94.4099,  0.0000,  0.0000],
        [80.7453, 84.8000,  0.0000],
        [58.0745, 58.1333, 87.1069]], device='cuda:0')
[Task 2 Finish] Global AA: 67.77	Global AF: 31.50
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:1.2408345462233683e-09
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:8.51083536979047e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.979488264060365e-09
[I 2025-09-15 08:48:01,979] Trial 263 finished with value: 77.08037567138672 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[I 2025-09-15 08:51:10,568] Trial 264 finished with value: 73.72178649902344 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.7934319152554963e-06
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.995560880047492e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.104810852860851e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.174938976284295e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.2015861356194932e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.3479223293089149e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.088732933979713e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:8.949198604391029e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.816062159131775e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.23
[Task 1 Finish] Global Accuracy on Task 1: 80.80
tensor([[94.4099,  0.0000,  0.0000],
        [83.2298, 80.8000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.01	Global AF: 11.18
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.226406529779126e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.09637054779688e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.025707395747303963
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.119818458076963e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.0727508881203107e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.76306241512259e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 77.33
[Task 2 Finish] Global Accuracy on Task 1: 74.67
[Task 2 Finish] Global Accuracy on Task 2: 79.25
tensor([[94.4099,  0.0000,  0.0000],
        [83.2298, 80.8000,  0.0000],
        [77.3292, 74.6667, 79.2453]], device='cuda:0')
[Task 2 Finish] Global AA: 77.08	Global AF: 11.61
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788336946163327
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:7.03212099661954e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.2176453179080227e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.0609153555662942e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.7473225089048583e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.2613821098739209e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.96
tensor([[95.9627,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.96	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.4690803018524434e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.86245377295802e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.1947219880070747e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.910848642822543e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796653472818434
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.696092958944575e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.26
[Task 1 Finish] Global Accuracy on Task 1: 86.40
tensor([[95.9627,  0.0000,  0.0000],
        [78.2609, 86.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.33	Global AF: 17.70
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.51204212881251e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.488997784601878e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.5616284931851965e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:8.413725272049533e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.1797643124397155e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.052404216167929e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 75.16
[Task 2 Finish] Global Accuracy on Task 1: 78.40
[Task 2 Finish] Global Accuracy on Task 2: 67.61
tensor([[95.9627,  0.0000,  0.0000],
        [78.2609, 86.4000,  0.0000],
        [75.1553, 78.4000, 67.6101]], device='cuda:0')
[Task 2 Finish] Global AA: 73.72	Global AF: 14.40
--------------------------------------------------
--------------------------------------------------
[I 2025-09-15 08:54:29,685] Trial 265 finished with value: 76.27738952636719 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378825108986348
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.957034393018091e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.74820682772048e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.445258883212233e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.4015079641847024e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.0958294272001012e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.1488483497856805e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.643105037757891e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.110999181541672e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.016161375159811e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.834032370418015e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.07360234222898e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.30
[Task 1 Finish] Global Accuracy on Task 1: 80.80
tensor([[94.0994,  0.0000,  0.0000],
        [82.2981, 80.8000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.55	Global AF: 11.80
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.948906284774068e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.4186814490411166e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.65791993653886e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.4278080374150477e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.2843862640110615e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:9.464707906303715e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 74.84
[Task 2 Finish] Global Accuracy on Task 1: 76.00
[Task 2 Finish] Global Accuracy on Task 2: 77.99
tensor([[94.0994,  0.0000,  0.0000],
        [82.2981, 80.8000,  0.0000],
        [74.8447, 76.0000, 77.9874]], device='cuda:0')
[Task 2 Finish] Global AA: 76.28	Global AF: 12.03
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788310752715915
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.4072971676881707e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.15315842628479
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.6517698026882215e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:4.785691842812412e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.4640850188338845e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.4289653904597799e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.112420486952374e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.86629650306736e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.775533857248604e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:2.568577572858999e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.392980034242157e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 87.89
[Task 1 Finish] Global Accuracy on Task 1: 81.60
tensor([[95.0311,  0.0000,  0.0000],
        [87.8882, 81.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.74	Global AF: 7.14
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.3257286379797506e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.778702209610856e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
[I 2025-09-15 08:57:36,731] Trial 266 finished with value: 72.36454772949219 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[I 2025-09-15 09:00:46,483] Trial 267 finished with value: 71.56086730957031 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
current_loss:1.276494132618211e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:8.603029399978368e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.833176388466029e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.932872692073545e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 69.25
[Task 2 Finish] Global Accuracy on Task 1: 62.93
[Task 2 Finish] Global Accuracy on Task 2: 84.91
tensor([[95.0311,  0.0000,  0.0000],
        [87.8882, 81.6000,  0.0000],
        [69.2547, 62.9333, 84.9057]], device='cuda:0')
[Task 2 Finish] Global AA: 72.36	Global AF: 22.22
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0010629919124767184
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:8.364719472631066e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.852439809497014e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.0363348774441477e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.491336912439749e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.9962329012024327e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.998347622579672e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.383858996983349e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.454201145229433e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.612168035324828e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:7.282717207068856e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.79855235943927e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 87.58
[Task 1 Finish] Global Accuracy on Task 1: 82.40
tensor([[95.6522,  0.0000,  0.0000],
        [87.5776, 82.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.99	Global AF: 8.07
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.7861695456034e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:2.8554272835101813e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.237485557416875e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.1788893194975003e-09
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.894380621957907e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.581673763657477e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 62.73
[Task 2 Finish] Global Accuracy on Task 1: 73.33
[Task 2 Finish] Global Accuracy on Task 2: 78.62
tensor([[95.6522,  0.0000,  0.0000],
        [87.5776, 82.4000,  0.0000],
        [62.7329, 73.3333, 78.6163]], device='cuda:0')
[Task 2 Finish] Global AA: 71.56	Global AF: 20.99
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788227806799114
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.747740144419367e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.873271006848427e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.249895907941891e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:4.556448551795711e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.14128914389056e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.168347862900987e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.9376840677007863e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.05958172528176e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.676535518363892e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:7.229913889794659e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.0199850953316343e-10
[I 2025-09-15 09:04:00,983] Trial 268 finished with value: 74.20338439941406 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[I 2025-09-15 09:07:13,810] Trial 269 finished with value: 61.31441879272461 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 5}. Best is trial 255 with value: 79.05184936523438.
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.50
[Task 1 Finish] Global Accuracy on Task 1: 82.67
tensor([[95.0311,  0.0000,  0.0000],
        [79.5031, 82.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.08	Global AF: 15.53
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.719400508752415e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.354998359827448e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.3019134648704096e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.03280267355666e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.6255978774768494e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.982990852222315e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 73.29
[Task 2 Finish] Global Accuracy on Task 1: 75.73
[Task 2 Finish] Global Accuracy on Task 2: 73.58
tensor([[95.0311,  0.0000,  0.0000],
        [79.5031, 82.6667,  0.0000],
        [73.2919, 75.7333, 73.5849]], device='cuda:0')
[Task 2 Finish] Global AA: 74.20	Global AF: 14.34
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378831366309896
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.1113243365309415e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.696582985211137e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.14409062621246e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.1625346241217471e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:0.06009816750884056
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.48
tensor([[93.4783,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.48	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.0531483463083191e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.423661519898815e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.909159273009834e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:8.37303781864307e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:2.2651913678117808e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.414851593308015e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 64.91
[Task 1 Finish] Global Accuracy on Task 1: 78.13
tensor([[93.4783,  0.0000,  0.0000],
        [64.9068, 78.1333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 71.52	Global AF: 28.57
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.0934974026841644e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.166256424767198e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.2126228909892234e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.964898185441882e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.767320758273911e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.529962711024126e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 73.91
[Task 2 Finish] Global Accuracy on Task 1: 73.87
[Task 2 Finish] Global Accuracy on Task 2: 36.16
tensor([[93.4783,  0.0000,  0.0000],
        [64.9068, 78.1333,  0.0000],
        [73.9130, 73.8667, 36.1635]], device='cuda:0')
[Task 2 Finish] Global AA: 61.31	Global AF: 11.92
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788294745609164
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.439097978092832e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.478839049111173e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.71102443114313e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.0126196769988383e-08
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:0.060132186859846115
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[I 2025-09-15 09:10:16,354] Trial 270 finished with value: 72.62150573730469 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[I 2025-09-15 09:13:24,511] Trial 271 finished with value: 73.23057556152344 and parameters: {'num_recon_nodes': 3, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.0682509038749686e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.006300456995461e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.2445093844348776e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.2625748224692757e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796647652052343
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.640527572265853e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 65.22
[Task 1 Finish] Global Accuracy on Task 1: 87.20
tensor([[95.0311,  0.0000,  0.0000],
        [65.2174, 87.2000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 76.21	Global AF: 29.81
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.5083316817765535e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.286119237306707e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.2908812907497236e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.00044972769683226943
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.5367120909104415e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:0.033466536551713943
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 66.77
[Task 2 Finish] Global Accuracy on Task 1: 69.33
[Task 2 Finish] Global Accuracy on Task 2: 81.76
tensor([[95.0311,  0.0000,  0.0000],
        [65.2174, 87.2000,  0.0000],
        [66.7702, 69.3333, 81.7610]], device='cuda:0')
[Task 2 Finish] Global AA: 72.62	Global AF: 23.06
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378834422212094
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.943613408579182e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.003706255417683e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.7118537970771683e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792046300135553
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.3601314225760746e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.263735003424586e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.79672856990021e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.218555753141231e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.770125878155284e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:3.5098746131723146e-09
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:7.391613432439215e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.57
[Task 1 Finish] Global Accuracy on Task 1: 87.47
tensor([[94.0994,  0.0000,  0.0000],
        [78.5714, 87.4667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.02	Global AF: 15.53
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.102640780549564e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.1461194215911519e-09
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.60598290011427e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.334342494973555e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.02441826927469e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.271320602240337e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 64.91
[Task 2 Finish] Global Accuracy on Task 1: 64.53
[Task 2 Finish] Global Accuracy on Task 2: 90.25
tensor([[94.0994,  0.0000,  0.0000],
        [78.5714, 87.4667,  0.0000],
        [64.9068, 64.5333, 90.2516]], device='cuda:0')
[Task 2 Finish] Global AA: 73.23	Global AF: 26.06
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:2.718684721791931e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.019883592665252e-10
[I 2025-09-15 09:16:34,410] Trial 272 finished with value: 73.78697204589844 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.5, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.286147547993835e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:9.40002298221998e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979217726737261
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.1384889697652056e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.96
tensor([[95.9627,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.96	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.111405270736725e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.907953736285833e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.44482006756175e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.1882954609763203e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.226491093635559
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.110034145301313e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.19
[Task 1 Finish] Global Accuracy on Task 1: 79.47
tensor([[95.9627,  0.0000,  0.0000],
        [79.1926, 79.4667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.33	Global AF: 16.77
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.74594216756563e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:0.0016131984302774072
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.935462287278483e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.0126385547623045e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.675924257848465e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.250967521381767e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 70.81
[Task 2 Finish] Global Accuracy on Task 1: 65.33
[Task 2 Finish] Global Accuracy on Task 2: 85.22
tensor([[95.9627,  0.0000,  0.0000],
        [79.1926, 79.4667,  0.0000],
        [70.8074, 65.3333, 85.2201]], device='cuda:0')
[Task 2 Finish] Global AA: 73.79	Global AF: 19.64
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788264186587185
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.4941584636218863e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.195902845287151e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.981822732119667e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792037568986416
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.3266310753000674e-11
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.629031436995888e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.1203673806222696e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.527921619399081e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.073323593509429e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:3.521303248987806e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.178332845330203e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.30
[Task 1 Finish] Global Accuracy on Task 1: 83.73
tensor([[95.0311,  0.0000,  0.0000],
        [82.2981, 83.7333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.02	Global AF: 12.73
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.780638828196572e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.2401660809402415e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.7392779438907269e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:2.920684527563111e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.448702517478864e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.3110965918782256e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 65.84
[Task 2 Finish] Global Accuracy on Task 1: 78.67
[Task 2 Finish] Global Accuracy on Task 2: 66.35
tensor([[95.0311,  0.0000,  0.0000],
        [82.2981, 83.7333,  0.0000],
        [65.8385, 78.6667, 66.3522]], device='cuda:0')
[I 2025-09-15 09:19:49,651] Trial 273 finished with value: 70.2857894897461 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[I 2025-09-15 09:22:55,231] Trial 274 finished with value: 70.4864730834961 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[Task 2 Finish] Global AA: 70.29	Global AF: 17.13
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788239448331296
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.789783180138897e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.369571454139077e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.148202977141466e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:4.659850838528712e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.473097696220066e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.48
tensor([[93.4783,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.48	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:4.055721591900152e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.18614418234786e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.231537425487431e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:2.3163561346795092e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.026424281299114227
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.443218098477587e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.19
[Task 1 Finish] Global Accuracy on Task 1: 81.87
tensor([[93.4783,  0.0000,  0.0000],
        [79.1926, 81.8667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.53	Global AF: 14.29
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.736441794328528e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:9.23071563629918e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.039689386978409e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497272602748126
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.81382355988336e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.211406696124186e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 63.98
[Task 2 Finish] Global Accuracy on Task 1: 66.67
[Task 2 Finish] Global Accuracy on Task 2: 80.82
tensor([[93.4783,  0.0000,  0.0000],
        [79.1926, 81.8667,  0.0000],
        [63.9752, 66.6667, 80.8176]], device='cuda:0')
[Task 2 Finish] Global AA: 70.49	Global AF: 22.35
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378827728331089
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.051168372460779e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.407681082810086e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:9.025293290498837e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.5086863142398386e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.5161187022781917e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.281788588249128e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.669579722893502e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.774418638220368e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:8.550394836603914e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:7.935149759497051e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.102617217644934e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.92
[Task 1 Finish] Global Accuracy on Task 1: 80.53
tensor([[95.3416,  0.0000,  0.0000],
        [82.9193, 80.5333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.73	Global AF: 12.42
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.023796378900158e-10
[I 2025-09-15 09:26:03,055] Trial 275 finished with value: 72.26052856445312 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[I 2025-09-15 09:29:20,698] Trial 276 finished with value: 72.99134826660156 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.413037795776177e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:4.640403061806353e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.840477463297077e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.1756057739257812
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.578182194985402e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 63.66
[Task 2 Finish] Global Accuracy on Task 1: 65.07
[Task 2 Finish] Global Accuracy on Task 2: 88.05
tensor([[95.3416,  0.0000,  0.0000],
        [82.9193, 80.5333,  0.0000],
        [63.6646, 65.0667, 88.0503]], device='cuda:0')
[Task 2 Finish] Global AA: 72.26	Global AF: 23.57
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0010369215160608292
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.780065953115866e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.930985785302823e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.863816654461118e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.14100104101567e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:5.516909706848594e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.053249598648165e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.565456429046378e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.771327942800554e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.456411351050349e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.1788602316542551e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:9.663859712460976e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.50
[Task 1 Finish] Global Accuracy on Task 1: 78.40
tensor([[93.7888,  0.0000,  0.0000],
        [79.5031, 78.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 78.95	Global AF: 14.29
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.719287821115415e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.043312436443955e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.832697823673129e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:8.73824679281654e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.866867074961647e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.591058892586489e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 69.57
[Task 2 Finish] Global Accuracy on Task 1: 84.00
[Task 2 Finish] Global Accuracy on Task 2: 65.41
tensor([[93.7888,  0.0000,  0.0000],
        [79.5031, 78.4000,  0.0000],
        [69.5652, 84.0000, 65.4088]], device='cuda:0')
[Task 2 Finish] Global AA: 72.99	Global AF: 9.31
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788233627565205
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:6.75186462295585e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.704467064328924e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.4228071205409947e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.0168266229015899e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.2069034100180573e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.48
tensor([[93.4783,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.48	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:7.048456818203874e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.986192818165705e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.1419490908437524e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.322132846594883e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
[I 2025-09-15 09:32:28,489] Trial 277 finished with value: 74.93453979492188 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[I 2025-09-15 09:35:32,616] Trial 278 finished with value: 72.55226135253906 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.5, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
current_loss:1.1708463532045243e-08
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.913617290824845e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 74.84
[Task 1 Finish] Global Accuracy on Task 1: 84.00
tensor([[93.4783,  0.0000,  0.0000],
        [74.8447, 84.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 79.42	Global AF: 18.63
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.232767080227575e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.680805991228112e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:6.626659221353748e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.03872288763523102
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.651696888264723e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.446961687776252e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 73.91
[Task 2 Finish] Global Accuracy on Task 1: 75.73
[Task 2 Finish] Global Accuracy on Task 2: 75.16
tensor([[93.4783,  0.0000,  0.0000],
        [74.8447, 84.0000,  0.0000],
        [73.9130, 75.7333, 75.1572]], device='cuda:0')
[Task 2 Finish] Global AA: 74.93	Global AF: 13.92
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:9.890568364312458e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.86165480201106e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:9.711301762749258e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.667029150975168e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.311214108985382e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.142165459433464e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.129483752838951e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.172282602217138e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.297322746069312e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:7.311843353008385e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:2.59476384822932e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:9.075343809783476e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.61
[Task 1 Finish] Global Accuracy on Task 1: 82.40
tensor([[95.3416,  0.0000,  0.0000],
        [82.6087, 82.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.50	Global AF: 12.73
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.307062012072095e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:9.934946199052774e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.629433834173028e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.00044972734758630395
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.720312113930646e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.3108244751621783e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 64.29
[Task 2 Finish] Global Accuracy on Task 1: 70.67
[Task 2 Finish] Global Accuracy on Task 2: 82.70
tensor([[95.3416,  0.0000,  0.0000],
        [82.6087, 82.4000,  0.0000],
        [64.2857, 70.6667, 82.7044]], device='cuda:0')
[Task 2 Finish] Global AA: 72.55	Global AF: 21.39
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0010369227966293693
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:0.028364455327391624
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.572520305780927e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:8.409581364610119e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792031748220325
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.0299729957807813e-09
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')[I 2025-09-15 09:38:41,308] Trial 279 finished with value: 73.75883483886719 and parameters: {'num_recon_nodes': 3, 'beta': 0.04, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[I 2025-09-15 09:41:47,360] Trial 280 finished with value: 60.52207565307617 and parameters: {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.

[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.110038061469254e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.9389134315337415e-11
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.686777963617942e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.282194572738149e-09
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0026666990015655756
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.244239487112168e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.54
[Task 1 Finish] Global Accuracy on Task 1: 82.67
tensor([[94.4099,  0.0000,  0.0000],
        [83.5404, 82.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.10	Global AF: 10.87
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:5.44766676213726e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.563927817422211e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.853155182755643e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.9103975613130615e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.318345099754481e-09
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:6.753173020790371e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 71.12
[Task 2 Finish] Global Accuracy on Task 1: 72.80
[Task 2 Finish] Global Accuracy on Task 2: 77.36
tensor([[94.4099,  0.0000,  0.0000],
        [83.5404, 82.6667,  0.0000],
        [71.1180, 72.8000, 77.3585]], device='cuda:0')
[Task 2 Finish] Global AA: 73.76	Global AF: 16.58
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788258365821093
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.873645931269266e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.021472930330731e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.427632232546387e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.6851502111831e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.642228380533851e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:3.0563812591921646e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.534692704145527e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.6399762103880278e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:8.787807148635807e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.026424281299114227
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.758462595650826e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.19
[Task 1 Finish] Global Accuracy on Task 1: 83.73
tensor([[94.0994,  0.0000,  0.0000],
        [79.1926, 83.7333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.46	Global AF: 14.91
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.4356854594055335e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.444241972327404e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.485338542918441e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.554476961184719e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:8.085186409267919e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.927874774907082e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 52.48
[Task 2 Finish] Global Accuracy on Task 1: 36.00
[Task 2 Finish] Global Accuracy on Task 2: 93.08
tensor([[94.0994,  0.0000,  0.0000],
        [79.1926, 83.7333,  0.0000],
        [52.4845, 36.0000, 93.0818]], device='cuda:0')
[Task 2 Finish] Global AA: 60.52	Global AF: 44.67
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
[I 2025-09-15 09:45:05,524] Trial 281 finished with value: 75.53418731689453 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
current_loss:6.857677758986824e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.764394517271398e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.2892150680343661e-09
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.1677361300144184e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:3.562466710516077e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.48128170524609e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.1191340076877054e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.91558904691658e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.894923048645808e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.792487128315372e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:2.0831965041878675e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:9.951361956694882e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.43
[Task 1 Finish] Global Accuracy on Task 1: 80.80
tensor([[94.4099,  0.0000,  0.0000],
        [80.4348, 80.8000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 80.62	Global AF: 13.98
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.268910390794247e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.489326770913294e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:8.246801019851091e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.128743623712296e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.918355805434317e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.43348302514579e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 70.50
[Task 2 Finish] Global Accuracy on Task 1: 71.20
[Task 2 Finish] Global Accuracy on Task 2: 84.91
tensor([[94.4099,  0.0000,  0.0000],
        [80.4348, 80.8000,  0.0000],
        [70.4969, 71.2000, 84.9057]], device='cuda:0')
[Task 2 Finish] Global AA: 75.53	Global AF: 16.76
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:6.548447895049492e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.1788983950443708e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.898880993728596e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.734179714915854e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979206667281687
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.1928018572859855e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.3712587731973258e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.5031722795130236e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.796261166006843e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.584540942900503e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:7.217293429562233e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.588018936464323e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 78.57
[Task 1 Finish] Global Accuracy on Task 1: 86.40
tensor([[94.4099,  0.0000,  0.0000],
        [78.5714, 86.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.49	Global AF: 15.84
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.327872034551092e-09
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.657032702861443e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.43853917666803e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.297642407560033e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.793598933934163e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.470385504111277e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 70.81
[Task 2 Finish] Global Accuracy on Task 1: 80.27
[Task 2 Finish] Global Accuracy on Task 2: 64.47
[I 2025-09-15 09:48:18,610] Trial 282 finished with value: 71.84651184082031 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[I 2025-09-15 09:51:27,198] Trial 283 finished with value: 63.6787109375 and parameters: {'num_recon_nodes': 1, 'beta': 0.06999999999999999, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
tensor([[94.4099,  0.0000,  0.0000],
        [78.5714, 86.4000,  0.0000],
        [70.8075, 80.2667, 64.4654]], device='cuda:0')
[Task 2 Finish] Global AA: 71.85	Global AF: 14.87
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788262731395662
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:8.606951817924369e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:7.311424243816589e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:4.132932329703465e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.1568509200875496e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:4.4556947020879534e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.397096351586697e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.6621661259061966e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.743786557488306e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.4174011964129818e-09
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:5.912520473216887e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.5859046298416501e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.33
[Task 1 Finish] Global Accuracy on Task 1: 88.00
tensor([[95.3416,  0.0000,  0.0000],
        [77.3292, 88.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.66	Global AF: 18.01
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:3.3780447883380305e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.788985957266846e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.025707395747303963
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:3.703622131201456e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.132972020176595e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.820559838085273e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 59.63
[Task 2 Finish] Global Accuracy on Task 1: 49.33
[Task 2 Finish] Global Accuracy on Task 2: 82.08
tensor([[95.3416,  0.0000,  0.0000],
        [77.3292, 88.0000,  0.0000],
        [59.6273, 49.3333, 82.0755]], device='cuda:0')
[Task 2 Finish] Global AA: 63.68	Global AF: 37.19
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:4.940802211805817e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.652086576546367e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.541612169146504e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.851268358725292e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:5.906825584212072e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.04032849002067e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 92.55
tensor([[92.5466,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 92.55	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.5163554856201245e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.6377152118637355e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.061143809077407e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.501473721025718e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796644159592688
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.880611636006506e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 76.09
[Task 1 Finish] Global Accuracy on Task 1: 79.73
tensor([[92.5466,  0.0000,  0.0000],
        [76.0870, 79.7333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 77.91	Global AF: 16.46
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[I 2025-09-15 09:54:51,920] Trial 284 finished with value: 62.452735900878906 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 10}. Best is trial 255 with value: 79.05184936523438.
[I 2025-09-15 09:59:45,742] Trial 285 finished with value: 14.190356254577637 and parameters: {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.944951835841096e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.7877470614990898e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.317842832752717e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.4763828754845747e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.015902775935444e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.489148137081344e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 74.22
[Task 2 Finish] Global Accuracy on Task 1: 77.60
[Task 2 Finish] Global Accuracy on Task 2: 35.53
tensor([[92.5466,  0.0000,  0.0000],
        [76.0870, 79.7333,  0.0000],
        [74.2236, 77.6000, 35.5346]], device='cuda:0')
[Task 2 Finish] Global AA: 62.45	Global AF: 10.23
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:5.757249676996423e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.436313456006701e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.542317964099766e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.871225479594841e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979206085205078
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.0887892809563482e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.100593836182554e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.16852172172122e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.134784044509729e-09
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:9.22628196065034e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:7.340041352499327e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.5519010782868463e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.81
[Task 1 Finish] Global Accuracy on Task 1: 89.33
tensor([[94.0994,  0.0000,  0.0000],
        [79.8137, 89.3333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 84.57	Global AF: 14.29
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.707297188299435e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:3.153050043280814e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:nan
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.00044972720206715167
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.640143824730103e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.5084782301630923e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 0.00
[Task 2 Finish] Global Accuracy on Task 1: 9.87
[Task 2 Finish] Global Accuracy on Task 2: 32.70
tensor([[94.0994,  0.0000,  0.0000],
        [79.8137, 89.3333,  0.0000],
        [ 0.0000,  9.8667, 32.7044]], device='cuda:0')
[Task 2 Finish] Global AA: 14.19	Global AF: 86.78
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378829765599221
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:3.853311558721373e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.350092284281629e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:9.921975463456079e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:7.940292867658627e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.3461900483235922e-09
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.0845390557845391e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:5.409367398456766e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.094567155974119e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:2.4711258039822326e-10
[I 2025-09-15 10:02:46,896] Trial 286 finished with value: 68.33158874511719 and parameters: {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[I 2025-09-15 10:05:43,939] Trial 287 finished with value: 60.117366790771484 and parameters: {'num_recon_nodes': 3, 'beta': 0.01, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:7.923580125357432e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.27204582609653e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 88.20
[Task 1 Finish] Global Accuracy on Task 1: 82.67
tensor([[94.0994,  0.0000,  0.0000],
        [88.1988, 82.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 85.43	Global AF: 5.90
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.848518974145179e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.597584484145045e-05
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.025707395747303963
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.646750455059248e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.1756057739257812
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.7777638522685777e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 59.32
[Task 2 Finish] Global Accuracy on Task 1: 59.20
[Task 2 Finish] Global Accuracy on Task 2: 86.48
tensor([[94.0994,  0.0000,  0.0000],
        [88.1988, 82.6667,  0.0000],
        [59.3168, 59.2000, 86.4780]], device='cuda:0')
[Task 2 Finish] Global AA: 68.33	Global AF: 29.12
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:2.9837307624625e-10
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:9.21664189412752e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.2775784874463625e-09
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.8259847240086344e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.02327685058116913
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.2645402780453452e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.5000529707265287e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.234463028638061e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:3.0317315324879246e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.531229197939467e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796645614784211
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:3.4607261500951836e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 79.50
[Task 1 Finish] Global Accuracy on Task 1: 77.60
tensor([[94.7205,  0.0000,  0.0000],
        [79.5031, 77.6000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 78.55	Global AF: 15.22
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:0.028870712965726852
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:0.022586679086089134
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:2.1283375062353116e-10
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.857818674570581e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:4.940682307719158e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.72044356328405e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 70.81
[Task 2 Finish] Global Accuracy on Task 1: 73.07
[Task 2 Finish] Global Accuracy on Task 2: 36.48
tensor([[94.7205,  0.0000,  0.0000],
        [79.5031, 77.6000,  0.0000],
        [70.8075, 73.0667, 36.4780]], device='cuda:0')
[Task 2 Finish] Global AA: 60.12	Global AF: 14.22
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788293290417641
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:8.727574218880818e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.952120711391842e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.3978421753435555e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.0967186048205235e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.5308070356343535e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
[I 2025-09-15 10:08:50,653] Trial 288 finished with value: 75.74386596679688 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[I 2025-09-15 10:12:01,147] Trial 289 finished with value: 70.55866241455078 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.5, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.660665352598016e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.483495714107221e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:2.9890540043098213e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:8.679819085699592e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:8.213457691752524e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:0.04987136647105217
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.64
[Task 1 Finish] Global Accuracy on Task 1: 80.27
tensor([[94.7205,  0.0000,  0.0000],
        [77.6398, 80.2667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 78.95	Global AF: 17.08
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.025187653830756e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.1111747339783733e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:3.8282524372768023e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497281915973872
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.7792153306217529e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:1.0869839472960052e-09
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 76.09
[Task 2 Finish] Global Accuracy on Task 1: 81.33
[Task 2 Finish] Global Accuracy on Task 2: 69.81
tensor([[94.7205,  0.0000,  0.0000],
        [77.6398, 80.2667,  0.0000],
        [76.0870, 81.3333, 69.8113]], device='cuda:0')
[Task 2 Finish] Global AA: 75.74	Global AF: 8.78
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:9.705470871423927e-10
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.3538477006136418e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:8.604633672248951e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:1.151274076072184e-09
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.00039792043389752507
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.326689727664814e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:6.195995383428965e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.758302516918775e-07
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:8.481851887509606e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.36322050606708e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966560921631753
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.507503035382058e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 76.09
[Task 1 Finish] Global Accuracy on Task 1: 80.00
tensor([[95.6522,  0.0000,  0.0000],
        [76.0870, 80.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 78.04	Global AF: 19.57
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.779054067569291e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.995174050063781e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:5.462754693041916e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.1614209594057456e-09
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:7.198515672435235e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.748192949932672e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 72.36
[Task 2 Finish] Global Accuracy on Task 1: 70.13
[Task 2 Finish] Global Accuracy on Task 2: 69.18
tensor([[95.6522,  0.0000,  0.0000],
        [76.0870, 80.0000,  0.0000],
        [72.3603, 70.1333, 69.1824]], device='cuda:0')
[Task 2 Finish] Global AA: 70.56	Global AF: 16.58
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[I 2025-09-15 10:15:09,901] Trial 290 finished with value: 67.29375457763672 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788243813905865
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.2119905079543969e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:5.705558248081388e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:8.606003687461339e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:4.622967009204615e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:9.14418818442897e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.72
tensor([[94.7205,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.72	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.855438687367268e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.5830879929754644e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.229975341691784e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:6.339020419687813e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966453237459064
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.157223537111122e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 86.65
[Task 1 Finish] Global Accuracy on Task 1: 80.53
tensor([[94.7205,  0.0000,  0.0000],
        [86.6460, 80.5333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.59	Global AF: 8.07
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:2.7409255420884904e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:5.15839204684454e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.2904981527839254e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:8.047199018257345e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:9.994401972690525e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:2.0860070615302817e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 77.64
[Task 2 Finish] Global Accuracy on Task 1: 68.27
[Task 2 Finish] Global Accuracy on Task 2: 55.97
tensor([[94.7205,  0.0000,  0.0000],
        [86.6460, 80.5333,  0.0000],
        [77.6398, 68.2667, 55.9748]], device='cuda:0')
[Task 2 Finish] Global AA: 67.29	Global AF: 14.67
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788339856546372
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.3671027360450125e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:3.367436884893493e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.80655340581626e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:6.939599450639378e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.7037983791066154e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.7199108803822583e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.625234250101641e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.24941534685297e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:3.2561939256048333e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:1.5830852184706146e-09
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.370381054945142e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.85
[Task 1 Finish] Global Accuracy on Task 1: 79.47
tensor([[93.7888,  0.0000,  0.0000],
        [83.8509, 79.4667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.66	Global AF: 9.94
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.254765039237498e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:4.285673760318076e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.042625926878543e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:6.821347930952015e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.2254165460134914e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.031116244782254e-10
[I 2025-09-15 10:18:25,960] Trial 291 finished with value: 64.25654602050781 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[I 2025-09-15 10:21:32,011] Trial 292 finished with value: 73.97898864746094 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 79.81
[Task 2 Finish] Global Accuracy on Task 1: 73.33
[Task 2 Finish] Global Accuracy on Task 2: 39.62
tensor([[93.7888,  0.0000,  0.0000],
        [83.8509, 79.4667,  0.0000],
        [79.8137, 73.3333, 39.6226]], device='cuda:0')
[Task 2 Finish] Global AA: 64.26	Global AF: 10.05
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788275828119367
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:2.2963708712353537e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:0.04181229695677757
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:6.270768349025957e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:9.578933202192275e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:8.385108718478307e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.03
tensor([[95.0311,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.03	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.645357958883324e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:2.0480181439630485e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:4.026452782301959e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.704645089643634e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796644159592688
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.087651966384499e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 82.30
[Task 1 Finish] Global Accuracy on Task 1: 82.67
tensor([[95.0311,  0.0000,  0.0000],
        [82.2981, 82.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.48	Global AF: 12.73
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.559057020792068e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.2213989819542803e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.2518540648542853e-09
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.077352427385051e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.1974115032842292e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.73694339098563e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 68.01
[Task 2 Finish] Global Accuracy on Task 1: 69.33
[Task 2 Finish] Global Accuracy on Task 2: 84.59
tensor([[95.0311,  0.0000,  0.0000],
        [82.2981, 82.6667,  0.0000],
        [68.0124, 69.3333, 84.5912]], device='cuda:0')
[Task 2 Finish] Global AA: 73.98	Global AF: 20.18
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788243813905865
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.498003832089978e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:2.575198110310595e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.0466174588396058e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.1207962053182428e-09
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:2.2415712341850025e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.34
tensor([[95.3416,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.34	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:5.405312863970835e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.716169677010384e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.563018934395814e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.998156888369465e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966464878991246
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:1.254093828784164e-09
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.78
[Task 1 Finish] Global Accuracy on Task 1: 78.67
tensor([[95.3416,  0.0000,  0.0000],
        [84.7826, 78.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.72	Global AF: 10.56
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[I 2025-09-15 10:24:31,455] Trial 293 finished with value: 76.7392578125 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[I 2025-09-15 10:27:35,347] Trial 294 finished with value: 69.66398620605469 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:6.933029150779646e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:9.977777493119788e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:9.894771668683688e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:7.785965205897583e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.425229709921098e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:9.095056374697208e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 76.09
[Task 2 Finish] Global Accuracy on Task 1: 75.20
[Task 2 Finish] Global Accuracy on Task 2: 78.93
tensor([[95.3416,  0.0000,  0.0000],
        [84.7826, 78.6667,  0.0000],
        [76.0870, 75.2000, 78.9308]], device='cuda:0')
[Task 2 Finish] Global AA: 76.74	Global AF: 11.36
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788329670205712
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.0448082399250325e-09
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:6.197224400317225e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.2064062516212744e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:4.690498545123489e-10
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.145938840658062e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.41
tensor([[94.4099,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.41	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.171546772572924e-10
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:7.072710195288323e-10
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:5.412230108525762e-10
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:5.369794053855514e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:2.6902394201222535e-10
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.869460390466429e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 84.16
[Task 1 Finish] Global Accuracy on Task 1: 82.67
tensor([[94.4099,  0.0000,  0.0000],
        [84.1615, 82.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.41	Global AF: 10.25
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:9.667382172562355e-11
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.130828232921772e-10
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.025707395747303963
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:2.8509308802604494e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:5.678180148294132e-10
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:4.804640019173689e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 71.74
[Task 2 Finish] Global Accuracy on Task 1: 78.13
[Task 2 Finish] Global Accuracy on Task 2: 59.12
tensor([[94.4099,  0.0000,  0.0000],
        [84.1615, 82.6667,  0.0000],
        [71.7391, 78.1333, 59.1195]], device='cuda:0')
[Task 2 Finish] Global AA: 69.66	Global AF: 13.60
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.0001378826709697023
[server] reconstruct 1 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.421136872740817e-10
[server] reconstruct 1 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.6443751622327056e-10
[server] reconstruct 1 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.2721509396195216e-10
[server] reconstruct 1 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.6961822169037077e-08
[server] reconstruct 1 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:6.029832189113904e-10
[server] reconstruct 1 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 95.65
tensor([[95.6522,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 95.65	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.2968242035782396e-09
[server] reconstruct 1 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:4.977295797736758e-10
[I 2025-09-15 10:30:49,799] Trial 295 finished with value: 62.8817253112793 and parameters: {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 5}. Best is trial 255 with value: 79.05184936523438.
[I 2025-09-15 10:34:05,709] Trial 296 finished with value: 76.22026824951172 and parameters: {'num_recon_nodes': 3, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[server] reconstruct 1 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:0.00020711998513434082
[server] reconstruct 1 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.9902089698486947e-10
[server] reconstruct 1 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796645032707602
[server] reconstruct 1 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.724549168029114e-10
[server] reconstruct 1 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 81.06
[Task 1 Finish] Global Accuracy on Task 1: 75.73
tensor([[95.6522,  0.0000,  0.0000],
        [81.0559, 75.7333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 78.39	Global AF: 14.60
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.526221867948379e-10
[server] reconstruct 1 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.1814985656499744e-09
[server] reconstruct 1 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:7.771366883346786e-10
[server] reconstruct 1 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:4.4150497147121825e-10
[server] reconstruct 1 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.2181617936590783e-09
[server] reconstruct 1 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.617650482101169e-10
[server] reconstruct 1 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 76.71
[Task 2 Finish] Global Accuracy on Task 1: 72.00
[Task 2 Finish] Global Accuracy on Task 2: 39.94
tensor([[95.6522,  0.0000,  0.0000],
        [81.0559, 75.7333,  0.0000],
        [76.7081, 72.0000, 39.9371]], device='cuda:0')
[Task 2 Finish] Global AA: 62.88	Global AF: 11.34
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788286014460027
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:7.359843290366541e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:9.488838603743943e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:5.776518152700305e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:2.1461554755575207e-09
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:3.6896312671785836e-09
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.79
tensor([[93.7888,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.79	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:9.450332738580869e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:3.588198349557814e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:7.92973187113688e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:1.0341019152093622e-09
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796649689320475
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:6.827822196520117e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 77.64
[Task 1 Finish] Global Accuracy on Task 1: 86.67
tensor([[93.7888,  0.0000,  0.0000],
        [77.6398, 86.6667,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.15	Global AF: 16.15
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:1.2310438224361064e-09
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:1.885539724355567e-09
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.3169816348579388e-09
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:1.0220914115066648e-09
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:1.1331352522958582e-09
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:5.974661321239694e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 75.47
[Task 2 Finish] Global Accuracy on Task 1: 78.67
[Task 2 Finish] Global Accuracy on Task 2: 74.53
tensor([[93.7888,  0.0000,  0.0000],
        [77.6398, 86.6667,  0.0000],
        [75.4658, 78.6667, 74.5283]], device='cuda:0')
[Task 2 Finish] Global AA: 76.22	Global AF: 13.16
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788332580588758
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:4.721277258035173e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.15315842628479
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:2.6772520311801884e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:0.0003979204047936946
[I 2025-09-15 10:37:11,941] Trial 297 finished with value: 77.02105712890625 and parameters: {'num_recon_nodes': 3, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[I 2025-09-15 10:40:23,109] Trial 298 finished with value: 71.05803680419922 and parameters: {'num_recon_nodes': 3, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:1.4279428750541001e-09
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 93.17
tensor([[93.1677,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 93.17	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:2.118387909533226e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:0.0014423885149881244
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:9.259312205855963e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.196454850280418e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.0003796643577516079
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:8.616813373940602e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 85.40
[Task 1 Finish] Global Accuracy on Task 1: 79.73
tensor([[93.1677,  0.0000,  0.0000],
        [85.4037, 79.7333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 82.57	Global AF: 7.76
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:7.74376784917763e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:6.226897886207894e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.3223778738691294e-09
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.389794166532624e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:6.163880517107145e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:7.086441433656887e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 81.68
[Task 2 Finish] Global Accuracy on Task 1: 73.60
[Task 2 Finish] Global Accuracy on Task 2: 75.79
tensor([[93.1677,  0.0000,  0.0000],
        [85.4037, 79.7333,  0.0000],
        [81.6770, 73.6000, 75.7862]], device='cuda:0')
[Task 2 Finish] Global AA: 77.02	Global AF: 8.81
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:0.00013788254000246525
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:1.3771370710458086e-09
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:1.3658106867708852e-09
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:3.866744979763581e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.57926631771943e-08
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:8.618523672510037e-10
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:1.3848668878324588e-09
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:1.7653106754167425e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:1.0395201366364404e-09
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:8.706909082611958e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:0.00037966464878991246
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:5.701211724939981e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 80.43
[Task 1 Finish] Global Accuracy on Task 1: 86.40
tensor([[94.0994,  0.0000,  0.0000],
        [80.4348, 86.4000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 83.42	Global AF: 13.66
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:8.561796271955302e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:7.282625613669325e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:0.025707395747303963
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:0.0004497274348977953
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:3.9599437617887645e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:8.005084373152727e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 66.46
[Task 2 Finish] Global Accuracy on Task 1: 79.73
[Task 2 Finish] Global Accuracy on Task 2: 66.98
tensor([[94.0994,  0.0000,  0.0000],
        [80.4348, 86.4000,  0.0000],
        [66.4596, 79.7333, 66.9811]], device='cuda:0')
[Task 2 Finish] Global AA: 71.06	Global AF: 17.15
--------------------------------------------------
--------------------------------------------------
client 0 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 1 tasks: [4, 5]=>[2, 3]=>[0, 1]
client 2 tasks: [2, 3]=>[0, 1]=>[4, 5]
--------------------------------------------------
[client 0] local gradient encode model is initialized.
[I 2025-09-15 10:43:30,978] Trial 299 finished with value: 71.40687561035156 and parameters: {'num_recon_nodes': 3, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}. Best is trial 255 with value: 79.05184936523438.
[client 0 task 0 round 0]	class: 4	total_nodes: 14
[client 0 task 0 round 0]	class: 5	total_nodes: 12
[client 1] local gradient encode model is initialized.
[client 1 task 0 round 0]	class: 4	total_nodes: 23
[client 1 task 0 round 0]	class: 5	total_nodes: 26
[client 2] local gradient encode model is initialized.
[client 2 task 0 round 0]	class: 2	total_nodes: 10
[client 2 task 0 round 0]	class: 3	total_nodes: 73
current_loss:3.9804823326328176e-10
[server] reconstruct 3 nodes with class 4 based on client 0's uploaded prototype gradient.
current_loss:5.156261528860284e-10
[server] reconstruct 3 nodes with class 5 based on client 0's uploaded prototype gradient.
current_loss:4.825767563332306e-10
[server] reconstruct 3 nodes with class 4 based on client 1's uploaded prototype gradient.
current_loss:7.851830297056495e-10
[server] reconstruct 3 nodes with class 5 based on client 1's uploaded prototype gradient.
current_loss:1.0462464228311319e-09
[server] reconstruct 3 nodes with class 2 based on client 2's uploaded prototype gradient.
current_loss:7.588137063141431e-11
[server] reconstruct 3 nodes with class 3 based on client 2's uploaded prototype gradient.
[Task 0 Finish] Global Accuracy on Task 0: 94.10
tensor([[94.0994,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 0 Finish] Global AA: 94.10	Global AF: -1.00
--------------------------------------------------
[client 0 task 1 round 0]	class: 2	total_nodes: 68
[client 0 task 1 round 0]	class: 3	total_nodes: 22
[client 1 task 1 round 0]	class: 2	total_nodes: 5
[client 1 task 1 round 0]	class: 3	total_nodes: 68
[client 2 task 1 round 0]	class: 0	total_nodes: 18
[client 2 task 1 round 0]	class: 1	total_nodes: 4
current_loss:8.918246696687504e-10
[server] reconstruct 3 nodes with class 2 based on client 0's uploaded prototype gradient.
current_loss:6.610259006833985e-10
[server] reconstruct 3 nodes with class 3 based on client 0's uploaded prototype gradient.
current_loss:6.930692686424322e-10
[server] reconstruct 3 nodes with class 2 based on client 1's uploaded prototype gradient.
current_loss:4.578862844439868e-10
[server] reconstruct 3 nodes with class 3 based on client 1's uploaded prototype gradient.
current_loss:9.977494386248509e-10
[server] reconstruct 3 nodes with class 0 based on client 2's uploaded prototype gradient.
current_loss:4.2709538683460835e-10
[server] reconstruct 3 nodes with class 1 based on client 2's uploaded prototype gradient.
[Task 1 Finish] Global Accuracy on Task 0: 83.85
[Task 1 Finish] Global Accuracy on Task 1: 79.73
tensor([[94.0994,  0.0000,  0.0000],
        [83.8509, 79.7333,  0.0000],
        [ 0.0000,  0.0000,  0.0000]], device='cuda:0')
[Task 1 Finish] Global AA: 81.79	Global AF: 10.25
--------------------------------------------------
[client 0 task 2 round 0]	class: 0	total_nodes: 16
[client 0 task 2 round 0]	class: 1	total_nodes: 35
[client 1 task 2 round 0]	class: 0	total_nodes: 36
[client 1 task 2 round 0]	class: 1	total_nodes: 4
[client 2 task 2 round 0]	class: 4	total_nodes: 47
[client 2 task 2 round 0]	class: 5	total_nodes: 20
current_loss:4.430850686354404e-10
[server] reconstruct 3 nodes with class 0 based on client 0's uploaded prototype gradient.
current_loss:8.819760477507543e-10
[server] reconstruct 3 nodes with class 1 based on client 0's uploaded prototype gradient.
current_loss:1.0374330283724476e-09
[server] reconstruct 3 nodes with class 0 based on client 1's uploaded prototype gradient.
current_loss:5.664695934548547e-10
[server] reconstruct 3 nodes with class 1 based on client 1's uploaded prototype gradient.
current_loss:9.033070957897849e-10
[server] reconstruct 3 nodes with class 4 based on client 2's uploaded prototype gradient.
current_loss:3.245236024351783e-10
[server] reconstruct 3 nodes with class 5 based on client 2's uploaded prototype gradient.
[Task 2 Finish] Global Accuracy on Task 0: 78.26
[Task 2 Finish] Global Accuracy on Task 1: 73.07
[Task 2 Finish] Global Accuracy on Task 2: 62.89
tensor([[94.0994,  0.0000,  0.0000],
        [83.8509, 79.7333,  0.0000],
        [78.2609, 73.0667, 62.8931]], device='cuda:0')
[Task 2 Finish] Global AA: 71.41	Global AF: 11.25
--------------------------------------------------
Best trial:
  Best Global AA: 79.05184936523438
  Params: 
    num_recon_nodes: 1
    beta: 0.04
    decay: 0.9
    num_epoch_g: 3
Trial 255: Value 79.05184936523438, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 115: Value 79.04704284667969, Params {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 1.0, 'num_epoch_g': 3}
Trial 104: Value 78.39065551757812, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 129: Value 78.372314453125, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 1.0, 'num_epoch_g': 3}
Trial 239: Value 77.20100402832031, Params {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 134: Value 77.0921859741211, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}
Trial 263: Value 77.08037567138672, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 15: Value 77.06944274902344, Params {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 203: Value 77.03205871582031, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 297: Value 77.02105712890625, Params {'num_recon_nodes': 3, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}
Trial 139: Value 76.97535705566406, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 293: Value 76.7392578125, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}
Trial 265: Value 76.27738952636719, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 212: Value 76.26383972167969, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 296: Value 76.22026824951172, Params {'num_recon_nodes': 3, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}
Trial 146: Value 76.19780731201172, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 174: Value 76.1939926147461, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.5, 'num_epoch_g': 3}
Trial 80: Value 76.10722351074219, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 64: Value 76.10273742675781, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 229: Value 76.04549407958984, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}
Trial 152: Value 76.00648498535156, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 253: Value 75.86788940429688, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 97: Value 75.8421859741211, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}
Trial 288: Value 75.74386596679688, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}
Trial 220: Value 75.62371063232422, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}
Trial 72: Value 75.6021728515625, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 281: Value 75.53418731689453, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 158: Value 75.38710021972656, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 214: Value 75.29689025878906, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 257: Value 75.18624877929688, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 99: Value 75.12462615966797, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}
Trial 14: Value 75.11549377441406, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 147: Value 75.09870910644531, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 236: Value 74.99432373046875, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 63: Value 74.97743225097656, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 277: Value 74.93453979492188, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.8, 'num_epoch_g': 3}
Trial 114: Value 74.90625, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 1.0, 'num_epoch_g': 3}
Trial 122: Value 74.89994049072266, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 111: Value 74.8440170288086, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 207: Value 74.69949340820312, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 242: Value 74.68656921386719, Params {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 141: Value 74.67727661132812, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 109: Value 74.54149627685547, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.8, 'num_epoch_g': 3}
Trial 119: Value 74.51626586914062, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 1.0, 'num_epoch_g': 3}
Trial 260: Value 74.51611328125, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 93: Value 74.49539184570312, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.8, 'num_epoch_g': 3}
Trial 268: Value 74.20338439941406, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 258: Value 74.06248474121094, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 292: Value 73.97898864746094, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}
Trial 272: Value 73.78697204589844, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.5, 'num_epoch_g': 3}
Trial 193: Value 73.76402282714844, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 130: Value 73.76263427734375, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 1.0, 'num_epoch_g': 3}
Trial 279: Value 73.75883483886719, Params {'num_recon_nodes': 3, 'beta': 0.04, 'decay': 1.0, 'num_epoch_g': 3}
Trial 264: Value 73.72178649902344, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 29: Value 73.72149658203125, Params {'num_recon_nodes': 3, 'beta': 0.06999999999999999, 'decay': 0.2, 'num_epoch_g': 10}
Trial 254: Value 73.6102294921875, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 218: Value 73.60809326171875, Params {'num_recon_nodes': 3, 'beta': 0.05, 'decay': 1.0, 'num_epoch_g': 3}
Trial 126: Value 73.59335327148438, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 121: Value 73.52487182617188, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 249: Value 73.34994506835938, Params {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 113: Value 73.30635833740234, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 240: Value 73.29188537597656, Params {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 5}
Trial 271: Value 73.23057556152344, Params {'num_recon_nodes': 3, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 145: Value 73.17090606689453, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 202: Value 73.07147216796875, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 171: Value 73.03076171875, Params {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 1.0, 'num_epoch_g': 3}
Trial 96: Value 73.02113342285156, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.8, 'num_epoch_g': 3}
Trial 223: Value 73.02067565917969, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}
Trial 209: Value 73.00761413574219, Params {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 276: Value 72.99134826660156, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 179: Value 72.96693420410156, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 124: Value 72.89729309082031, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 1.0, 'num_epoch_g': 3}
Trial 176: Value 72.7225341796875, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.5, 'num_epoch_g': 3}
Trial 221: Value 72.67605590820312, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}
Trial 184: Value 72.6268081665039, Params {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 270: Value 72.62150573730469, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 278: Value 72.55226135253906, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.5, 'num_epoch_g': 3}
Trial 79: Value 72.4996566772461, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 183: Value 72.4866714477539, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.5, 'num_epoch_g': 3}
Trial 230: Value 72.45677185058594, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}
Trial 58: Value 72.4027328491211, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 132: Value 72.39196014404297, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 1.0, 'num_epoch_g': 3}
Trial 155: Value 72.37731170654297, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 266: Value 72.36454772949219, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 133: Value 72.34336853027344, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}
Trial 275: Value 72.26052856445312, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 51: Value 72.14285278320312, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.5, 'num_epoch_g': 5}
Trial 89: Value 72.1397705078125, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 231: Value 72.1126708984375, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}
Trial 167: Value 72.098876953125, Params {'num_recon_nodes': 3, 'beta': 0.04, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 86: Value 72.03819274902344, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 150: Value 72.02218627929688, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 210: Value 71.96817016601562, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}
Trial 102: Value 71.85820770263672, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 282: Value 71.84651184082031, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 103: Value 71.78932189941406, Params {'num_recon_nodes': 1, 'beta': 0.08, 'decay': 0.8, 'num_epoch_g': 3}
Trial 169: Value 71.7124252319336, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 156: Value 71.68914031982422, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 110: Value 71.6312026977539, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.8, 'num_epoch_g': 3}
Trial 55: Value 71.5794448852539, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.8, 'num_epoch_g': 3}
Trial 205: Value 71.5792465209961, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 27: Value 71.57896423339844, Params {'num_recon_nodes': 3, 'beta': 0.06999999999999999, 'decay': 0.0, 'num_epoch_g': 3}
Trial 267: Value 71.56086730957031, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 75: Value 71.51205444335938, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.5, 'num_epoch_g': 3}
Trial 135: Value 71.47457885742188, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}
Trial 172: Value 71.46540069580078, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 194: Value 71.44224548339844, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}
Trial 299: Value 71.40687561035156, Params {'num_recon_nodes': 3, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}
Trial 59: Value 71.35932922363281, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 173: Value 71.33968353271484, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 94: Value 71.24176788330078, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.8, 'num_epoch_g': 3}
Trial 91: Value 71.2286148071289, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.5, 'num_epoch_g': 5}
Trial 137: Value 71.16470336914062, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}
Trial 241: Value 71.14356994628906, Params {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 226: Value 71.12608337402344, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 180: Value 71.10163879394531, Params {'num_recon_nodes': 3, 'beta': 0.03, 'decay': 0.5, 'num_epoch_g': 3}
Trial 154: Value 71.064697265625, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 298: Value 71.05803680419922, Params {'num_recon_nodes': 3, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}
Trial 11: Value 71.0164794921875, Params {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 95: Value 70.99639892578125, Params {'num_recon_nodes': 3, 'beta': 0.05, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 225: Value 70.8891830444336, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}
Trial 9: Value 70.84659576416016, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.5, 'num_epoch_g': 5}
Trial 82: Value 70.80961608886719, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 120: Value 70.80162811279297, Params {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 1.0, 'num_epoch_g': 3}
Trial 159: Value 70.77384185791016, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 191: Value 70.75733947753906, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 26: Value 70.65110778808594, Params {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 243: Value 70.62544250488281, Params {'num_recon_nodes': 3, 'beta': 0.06999999999999999, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 289: Value 70.55866241455078, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.5, 'num_epoch_g': 3}
Trial 195: Value 70.55717468261719, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 40: Value 70.52922058105469, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}
Trial 274: Value 70.4864730834961, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 261: Value 70.45561218261719, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 157: Value 70.33085632324219, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 246: Value 70.31723022460938, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 273: Value 70.2857894897461, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.8, 'num_epoch_g': 3}
Trial 6: Value 70.1480484008789, Params {'num_recon_nodes': 3, 'beta': 0.04, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 175: Value 70.10697937011719, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.5, 'num_epoch_g': 3}
Trial 125: Value 70.05683898925781, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 237: Value 69.9919204711914, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 153: Value 69.93899536132812, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 164: Value 69.80707550048828, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 105: Value 69.7887191772461, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}
Trial 294: Value 69.66398620605469, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}
Trial 251: Value 69.633056640625, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 78: Value 69.57221221923828, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.8, 'num_epoch_g': 3}
Trial 142: Value 69.50163269042969, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 206: Value 69.47477722167969, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}
Trial 73: Value 69.44389343261719, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 136: Value 69.38050079345703, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.8, 'num_epoch_g': 3}
Trial 116: Value 69.3609619140625, Params {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 1.0, 'num_epoch_g': 3}
Trial 127: Value 69.35797119140625, Params {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 1.0, 'num_epoch_g': 3}
Trial 211: Value 69.30415344238281, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 117: Value 69.19942474365234, Params {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 1.0, 'num_epoch_g': 3}
Trial 67: Value 69.19558715820312, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 52: Value 69.17216491699219, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.6000000000000001, 'num_epoch_g': 5}
Trial 144: Value 69.13092041015625, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.8, 'num_epoch_g': 3}
Trial 112: Value 69.01222229003906, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 21: Value 68.96762084960938, Params {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 151: Value 68.89501190185547, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 166: Value 68.88053894042969, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 182: Value 68.85775756835938, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 1.0, 'num_epoch_g': 3}
Trial 44: Value 68.70986938476562, Params {'num_recon_nodes': 3, 'beta': 0.06999999999999999, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 140: Value 68.64810180664062, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 87: Value 68.5886001586914, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 33: Value 68.55636596679688, Params {'num_recon_nodes': 3, 'beta': 0.08, 'decay': 0.2, 'num_epoch_g': 10}
Trial 186: Value 68.5329360961914, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.4, 'num_epoch_g': 3}
Trial 216: Value 68.52948760986328, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 54: Value 68.3652572631836, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.5, 'num_epoch_g': 5}
Trial 286: Value 68.33158874511719, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 1.0, 'num_epoch_g': 3}
Trial 57: Value 68.28544616699219, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 56: Value 68.2701644897461, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.8, 'num_epoch_g': 5}
Trial 108: Value 68.18366241455078, Params {'num_recon_nodes': 3, 'beta': 0.02, 'decay': 0.9, 'num_epoch_g': 3}
Trial 227: Value 68.17033386230469, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 65: Value 68.14096069335938, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 213: Value 68.12403869628906, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 36: Value 68.09817504882812, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.30000000000000004, 'num_epoch_g': 10}
Trial 107: Value 67.81950378417969, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}
Trial 46: Value 67.81859588623047, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 219: Value 67.80125427246094, Params {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 262: Value 67.77159881591797, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.5, 'num_epoch_g': 3}
Trial 85: Value 67.68489074707031, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 128: Value 67.63125610351562, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}
Trial 178: Value 67.61976623535156, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}
Trial 204: Value 67.60884857177734, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 197: Value 67.58785247802734, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 42: Value 67.463134765625, Params {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.5, 'num_epoch_g': 3}
Trial 192: Value 67.4027328491211, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 53: Value 67.33943939208984, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.4, 'num_epoch_g': 5}
Trial 19: Value 67.3271484375, Params {'num_recon_nodes': 3, 'beta': 0.06999999999999999, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 290: Value 67.29375457763672, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}
Trial 47: Value 67.27333068847656, Params {'num_recon_nodes': 3, 'beta': 0.08, 'decay': 0.5, 'num_epoch_g': 10}
Trial 24: Value 67.06588745117188, Params {'num_recon_nodes': 3, 'beta': 0.05, 'decay': 0.5, 'num_epoch_g': 3}
Trial 189: Value 66.8580322265625, Params {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 200: Value 66.76756286621094, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 5}
Trial 256: Value 66.73152160644531, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 3}
Trial 106: Value 66.66484069824219, Params {'num_recon_nodes': 1, 'beta': 0.06999999999999999, 'decay': 0.9, 'num_epoch_g': 3}
Trial 1: Value 66.66304016113281, Params {'num_recon_nodes': 3, 'beta': 0.02, 'decay': 1.0, 'num_epoch_g': 5}
Trial 50: Value 66.65773010253906, Params {'num_recon_nodes': 3, 'beta': 0.09, 'decay': 0.30000000000000004, 'num_epoch_g': 5}
Trial 235: Value 66.6474838256836, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 1.0, 'num_epoch_g': 3}
Trial 138: Value 66.64561462402344, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.9, 'num_epoch_g': 3}
Trial 250: Value 66.33612823486328, Params {'num_recon_nodes': 3, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 41: Value 66.29718017578125, Params {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 3: Value 66.14297485351562, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.4, 'num_epoch_g': 3}
Trial 61: Value 66.05287170410156, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}
Trial 201: Value 66.02696228027344, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 185: Value 65.94290161132812, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.5, 'num_epoch_g': 3}
Trial 247: Value 65.8595962524414, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 70: Value 65.77915954589844, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.9, 'num_epoch_g': 3}
Trial 177: Value 65.7695541381836, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.4, 'num_epoch_g': 3}
Trial 12: Value 65.66792297363281, Params {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.5, 'num_epoch_g': 3}
Trial 81: Value 65.60932922363281, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 217: Value 65.57324981689453, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.8, 'num_epoch_g': 3}
Trial 2: Value 65.53401184082031, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 5}
Trial 7: Value 65.47029876708984, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.8, 'num_epoch_g': 10}
Trial 170: Value 65.41209411621094, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.4, 'num_epoch_g': 3}
Trial 28: Value 65.33971405029297, Params {'num_recon_nodes': 1, 'beta': 0.09, 'decay': 0.0, 'num_epoch_g': 3}
Trial 149: Value 65.29713439941406, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 98: Value 65.20814514160156, Params {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 1.0, 'num_epoch_g': 3}
Trial 252: Value 65.11558532714844, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 25: Value 65.11274719238281, Params {'num_recon_nodes': 3, 'beta': 0.08, 'decay': 0.9, 'num_epoch_g': 3}
Trial 49: Value 64.86410522460938, Params {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.1, 'num_epoch_g': 3}
Trial 233: Value 64.8447494506836, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}
Trial 168: Value 64.56210327148438, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.8, 'num_epoch_g': 5}
Trial 0: Value 64.53634643554688, Params {'num_recon_nodes': 3, 'beta': 0.02, 'decay': 1.0, 'num_epoch_g': 10}
Trial 148: Value 64.51253509521484, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 224: Value 64.37247467041016, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 3}
Trial 196: Value 64.3260726928711, Params {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 291: Value 64.25654602050781, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}
Trial 190: Value 64.02755737304688, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 1.0, 'num_epoch_g': 3}
Trial 161: Value 63.88715744018555, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 60: Value 63.830440521240234, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.8, 'num_epoch_g': 10}
Trial 283: Value 63.6787109375, Params {'num_recon_nodes': 1, 'beta': 0.06999999999999999, 'decay': 0.9, 'num_epoch_g': 3}
Trial 215: Value 63.671539306640625, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.9, 'num_epoch_g': 3}
Trial 18: Value 63.627803802490234, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.30000000000000004, 'num_epoch_g': 3}
Trial 13: Value 63.37042236328125, Params {'num_recon_nodes': 3, 'beta': 0.06999999999999999, 'decay': 0.30000000000000004, 'num_epoch_g': 3}
Trial 17: Value 63.322654724121094, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 208: Value 63.2156982421875, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}
Trial 187: Value 63.19315719604492, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 10: Value 63.175010681152344, Params {'num_recon_nodes': 1, 'beta': 0.06999999999999999, 'decay': 0.4, 'num_epoch_g': 5}
Trial 76: Value 63.10880661010742, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 228: Value 63.08146667480469, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 10}
Trial 244: Value 63.061431884765625, Params {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.30000000000000004, 'num_epoch_g': 3}
Trial 71: Value 63.01839828491211, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.8, 'num_epoch_g': 3}
Trial 101: Value 62.97697448730469, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}
Trial 248: Value 62.92818832397461, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 222: Value 62.91002655029297, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}
Trial 295: Value 62.8817253112793, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.9, 'num_epoch_g': 5}
Trial 198: Value 62.87919235229492, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}
Trial 143: Value 62.86690902709961, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 30: Value 62.834747314453125, Params {'num_recon_nodes': 3, 'beta': 0.05, 'decay': 0.2, 'num_epoch_g': 10}
Trial 4: Value 62.752532958984375, Params {'num_recon_nodes': 1, 'beta': 0.09999999999999999, 'decay': 0.1, 'num_epoch_g': 10}
Trial 259: Value 62.682106018066406, Params {'num_recon_nodes': 3, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 10}
Trial 90: Value 62.670188903808594, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.7000000000000001, 'num_epoch_g': 10}
Trial 92: Value 62.63821029663086, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.5, 'num_epoch_g': 3}
Trial 39: Value 62.593719482421875, Params {'num_recon_nodes': 3, 'beta': 0.05, 'decay': 1.0, 'num_epoch_g': 10}
Trial 20: Value 62.46495819091797, Params {'num_recon_nodes': 1, 'beta': 0.01, 'decay': 0.8, 'num_epoch_g': 3}
Trial 284: Value 62.452735900878906, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 10}
Trial 118: Value 61.71954345703125, Params {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 1.0, 'num_epoch_g': 3}
Trial 69: Value 61.436363220214844, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.6000000000000001, 'num_epoch_g': 5}
Trial 45: Value 61.41374969482422, Params {'num_recon_nodes': 3, 'beta': 0.04, 'decay': 0.4, 'num_epoch_g': 5}
Trial 269: Value 61.31441879272461, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 0.9, 'num_epoch_g': 5}
Trial 232: Value 61.198692321777344, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}
Trial 84: Value 61.1307487487793, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 123: Value 61.102134704589844, Params {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.9, 'num_epoch_g': 3}
Trial 245: Value 60.53520965576172, Params {'num_recon_nodes': 3, 'beta': 0.05, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 280: Value 60.52207565307617, Params {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.8, 'num_epoch_g': 3}
Trial 74: Value 60.34858322143555, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 16: Value 60.23699188232422, Params {'num_recon_nodes': 3, 'beta': 0.08, 'decay': 0.8, 'num_epoch_g': 3}
Trial 38: Value 60.146881103515625, Params {'num_recon_nodes': 1, 'beta': 0.09999999999999999, 'decay': 0.7000000000000001, 'num_epoch_g': 5}
Trial 287: Value 60.117366790771484, Params {'num_recon_nodes': 3, 'beta': 0.01, 'decay': 1.0, 'num_epoch_g': 3}
Trial 163: Value 60.0811767578125, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 48: Value 60.048370361328125, Params {'num_recon_nodes': 1, 'beta': 0.06999999999999999, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 162: Value 60.02326965332031, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 23: Value 59.898773193359375, Params {'num_recon_nodes': 3, 'beta': 0.08, 'decay': 0.4, 'num_epoch_g': 3}
Trial 188: Value 59.87193298339844, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 1.0, 'num_epoch_g': 10}
Trial 83: Value 59.72966003417969, Params {'num_recon_nodes': 1, 'beta': 0.01, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 131: Value 59.723934173583984, Params {'num_recon_nodes': 1, 'beta': 0.04, 'decay': 1.0, 'num_epoch_g': 3}
Trial 43: Value 59.36391830444336, Params {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.8, 'num_epoch_g': 3}
Trial 35: Value 59.32159423828125, Params {'num_recon_nodes': 3, 'beta': 0.09, 'decay': 0.2, 'num_epoch_g': 5}
Trial 160: Value 58.906490325927734, Params {'num_recon_nodes': 1, 'beta': 0.01, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 181: Value 58.81272506713867, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 62: Value 58.337154388427734, Params {'num_recon_nodes': 1, 'beta': 0.05, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 22: Value 58.06298065185547, Params {'num_recon_nodes': 3, 'beta': 0.060000000000000005, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 100: Value 57.727718353271484, Params {'num_recon_nodes': 3, 'beta': 0.02, 'decay': 0.9, 'num_epoch_g': 10}
Trial 77: Value 57.4580078125, Params {'num_recon_nodes': 1, 'beta': 0.02, 'decay': 0.6000000000000001, 'num_epoch_g': 10}
Trial 37: Value 57.40876007080078, Params {'num_recon_nodes': 3, 'beta': 0.06999999999999999, 'decay': 0.1, 'num_epoch_g': 3}
Trial 5: Value 56.99148178100586, Params {'num_recon_nodes': 1, 'beta': 0.09, 'decay': 0.1, 'num_epoch_g': 5}
Trial 8: Value 56.38405990600586, Params {'num_recon_nodes': 3, 'beta': 0.02, 'decay': 0.9, 'num_epoch_g': 10}
Trial 68: Value 56.27564239501953, Params {'num_recon_nodes': 1, 'beta': 0.01, 'decay': 0.6000000000000001, 'num_epoch_g': 10}
Trial 238: Value 56.27533721923828, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 0.7000000000000001, 'num_epoch_g': 3}
Trial 32: Value 55.79862594604492, Params {'num_recon_nodes': 3, 'beta': 0.06999999999999999, 'decay': 0.1, 'num_epoch_g': 10}
Trial 88: Value 55.010372161865234, Params {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.5, 'num_epoch_g': 3}
Trial 165: Value 54.924678802490234, Params {'num_recon_nodes': 1, 'beta': 0.01, 'decay': 0.8, 'num_epoch_g': 3}
Trial 66: Value 51.044090270996094, Params {'num_recon_nodes': 1, 'beta': 0.01, 'decay': 0.6000000000000001, 'num_epoch_g': 3}
Trial 199: Value 50.98595428466797, Params {'num_recon_nodes': 3, 'beta': 0.09999999999999999, 'decay': 0.9, 'num_epoch_g': 3}
Trial 31: Value 48.65874481201172, Params {'num_recon_nodes': 3, 'beta': 0.06999999999999999, 'decay': 0.0, 'num_epoch_g': 10}
Trial 34: Value 39.55419158935547, Params {'num_recon_nodes': 3, 'beta': 0.03, 'decay': 0.0, 'num_epoch_g': 10}
Trial 234: Value 14.190356254577637, Params {'num_recon_nodes': 1, 'beta': 0.03, 'decay': 1.0, 'num_epoch_g': 3}
Trial 285: Value 14.190356254577637, Params {'num_recon_nodes': 1, 'beta': 0.060000000000000005, 'decay': 0.8, 'num_epoch_g': 3}
